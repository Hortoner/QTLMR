[{"path":[]},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"载入qtlmr包","dir":"Articles","previous_headings":"","what":"1. 载入QTLMR包","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"","code":"library(QTLMR)"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"下载数据","dir":"Articles","previous_headings":"","what":"2.下载数据","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"获取FinnGen数据的信息 从指定网址下载Migraine数据（偏头痛数据） 链接：https://storage.googleapis.com/finngen-public-data-r10/summary_stats/finngen_R10_G6_MIGRAINE.gz","code":"data_info_finngen <- data_info_finngen()"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"进行utmost分析","dir":"Articles","previous_headings":"","what":"3.进行UTMOST分析","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"3.1 数据转换：将GWAS文件转换为适合UTMOST分析的格式  3.2 单组织分析：进行单个组织的TWAS-UTMOST分析  3.3 跨组织联合分析：进行跨组织的TWAS-UTMOST分析  3.4 对UTMOST分析结果进行整理保存","code":"dat <- format_data_FinnGen( GWASfile = \"./1.data/finngen_R10_G6_MIGRAINE.gz\",  # 输入的GWAS文件路径 GWAS_name = \"Migraine\",  # GWAS的名称 save_path = \"./1.data\",  # 转换后数据的保存路径 type = \"outcome\",  # 数据类型，表示这是结果数据 Twosample_dat = TRUE,  # 是否保存Twosample格式数据 SMR_dat = TRUE,  # 是否保存SMR格式数据 METAL_dat = TRUE  # 是否保存METAL格式数据 ) data_utmost <- TWAS_UTMOST_single_tissue_test(   test_help = FALSE,  # 是否显示帮助文档信息   GTEX_tissue = \"all\",  # 使用所有组织数据   model_db_path = \"./2.UTMOST/database_normalized_pruned\",  # 归一化后的模型数据库路径   covariance = \"./2.UTMOST/covariance_GTEx8_normalized_pruned\",  # 归一化后的协方差矩阵路径   gwas_folder = \"./1.data\",  # GWAS数据的文件夹路径   gwas_file_pattern = \"Migraine_METAL_FinnGen.txt\",  # GWAS的文件名   snp_column = \"SNP\",  # SNP列的名称   effect_allele_column = \"effect_allele\",  # 效应等位基因列的名称   non_effect_allele_column = \"other_allele\",  # 非效应等位基因列的名称   beta_column = \"beta\",  # beta系数列的名称   pvalue_column = \"pval\",  # p值列的名称   opt_arguments = NULL,  # 额外的参数   save_path = \"./2.UTMOST\",  # 保存结果的路径   cores = 14  # 运行使用电脑线程数 ) #在运行此步之前，需要删除\"./2.UTMOST\"文件夹下的“all.csv\"文件 data_GBJ <- TWAS_UTMOST_cross_tissue_test(   weight_db = \"./2.UTMOST/database_normalized_pruned\",  # 权重数据的文件路径   cov_dir = \"./3.UTMOST_GBJ/covariance_joint_GTEx8_normalized_pruned\",  # 协方差矩阵的文件路径   input_folder = \"./2.UTMOST\",  # 输入文件夹路径   gene_info = \"./2.UTMOST/gene_info.txt\",  # 基因信息文件路径   cores = 2,    # 运行使用电脑线程数   output_dir = \"./3.UTMOST_GBJ\",  # 输出目录路径   output_name = \"Migraine\"  # 输出文件名 ) # 对UTMOST分析结果进行处理 dat_utmost_GBJ <- data_GBJ %>%   dplyr::left_join(data_info_GTEx_V8_GENE(), by = \"ID\") %>%  # 将结果与GTEx基因信息数据合并   dplyr::mutate(FDR = p.adjust(p_value, method = \"fdr\")) %>%  # 计算FDR值   dplyr::select(GENE, everything()) %>%  # 对数据框的列进行重新排序   dplyr::arrange(FDR)  # 按FDR值排序  # 将UTMOST分析结果保存为CSV文件 write.csv(dat_utmost_GBJ, file = \"./3.UTMOST_GBJ/GBJ_res.csv\", row.names = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"进行fusion分析","dir":"Articles","previous_headings":"","what":"4.进行FUSION分析","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"4.1 数据转换：将GWAS数据转换为FUSION分析.sumstats.gz格式  4.2 单组织分析：进行单组织的FUSION分析  4.3 条件联合分析：进行条件联合分析","code":"TWAS_fusion_format_data(   GWASfile = \"./1.data/Migraine_TwosampleMR_FinnGen.txt\",  # 输入的GWAS文件路径   N = NULL,  # 样本量，如果为空则自动从数据中获取   save_name = \"Migraine\",  # 保存的名称   save_path = \"./1.data\"  # 保存路径 ) #此步骤耗时较长，约10余小时... TWAS_fusion_Multi <- TWAS_fusion_Multi_test(   Sumstatsfile = \"./1.data/Migraine.sumstats.gz\",  # 输入的结局sumstats.gz格式文件路径   weights_type = \"nofilter.pos\",  # 权重数据类型   weights_dir = \"./4.FUSION/WEIGHTS/\",  # 权重文件目录路径   resource = \"GTEx_v8\",  # 资源数据库   ref_ld_chr = \"./4.FUSION/LDREF/1000G.EUR.\",  # LD参考文件路径   start_chr = 1,  # 起始染色体   end_chr = 22,  # 结束染色体   coloc_pval = NULL,  # 共定位p值（如果为空，则不使用共定位分析）   GWASN = NULL,  # GWAS样本量（如果为空，则自动从数据中获取）   perm = 10000,  # 置换检验迭代次数   PANELN = NA,  # 面板样本量（如果为空，则自动从数据中获取）   opt_arguments = NULL,  # 额外参数   remove_MHC = TRUE,  # 是否去除MHC区域   FDR_method = \"fdr\",  # FDR矫正方法   save_name = \"Migraine\",  # 保存的名称   save_path = \"./4.FUSION\",  # 保存路径   cores = 10  # 运行使用的电脑线程数 ) conditonal_test <- TWAS_fusion_conditonal_test(   test_help = FALSE,  # 是否显示帮助文档信息   Sumstatsfile = \"./1.data/Migraine.sumstats.gz\",  # 输入的结局sumstats.gz格式文件路径   inputfile = \"./4.FUSION/GTExv8.EUR.Cells_Cultured_fibroblasts.nofilter.pos.sig.dat\",  # 显著性文件路径   ref_ld_chr = \"./4.FUSION/LDREF/1000G.EUR.\",  # LD参考文件路径   start_chr = 1,  # 起始染色体   end_chr = 22,  # 结束染色体   locus_win_kb = 1000,  # 基因组区域窗口大小（以kb为单位）   build = 38,  # 基因组版本（38代表GRCh38）   plot_legend = \"joint\",  # 图例类型   opt_arguments = NULL,  # 额外参数   save_name = \"Migraine\",  # 保存的名称   save_path = \"./5.conditonal\",  # 保存路径   cores = 8  # 运行使用的电脑线程数 )"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"进行magma分析","dir":"Articles","previous_headings":"","what":"5.进行MAGMA分析","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"5.1 使用MAGMA软件进行基因层面和基因集合层面的关联分析 5.2 使用MAGMA进行组织特异性分析 5.3 对MAGMA基因层面分析结果进行基因注释及曼哈顿图绘制  5.4 图形可视化","code":"gene_based_dat <- MAGMA_gene_based(   GWAS_file = \"./1.data/Migraine_METAL_FinnGen.txt\",  # 输入的GWAS文件路径   bfile_1000G = \"./6.MAGMA/g1000_eur/g1000_eur\",  # 1000G参考数据路径   gene_loc = \"./6.MAGMA/ENSGv110.coding.genes.txt\",  # 基因位置文件路径   set_annot = \"./6.MAGMA/MSigDB_20231Hs_MAGMA.txt\",  # 基因集合注释文件路径   SNP_P_col = c(3, 10),  # SNP p值列的位置   samplesize_col = \"N\",  # 样本量列的名称   save_name = \"Migraine\",  # 保存的名称   save_path = \"./6.MAGMA\"  # 保存路径 ) Tissue_specific_dat <- MAGMA_Tissue_specific(   genes_raw = \"./6.MAGMA/Migraine.genes.raw\",  # 原始基因数据路径   gene_covar = \"./6.MAGMA/gtex_v8_ts_avg_log2TPM.txt\",  # 组织特异性表达数据路径   save_name = \"Migraine\",  # 保存的名称   save_path = \"./6.MAGMA/\"  # 保存路径 ) MAGMA_genes <- MAGMA_genes_Manhattanplot(   genes_out = \"./6.MAGMA/Migraine.genes.out.txt\",  # 基因分析结果文件路径   gene_loc = \"./6.MAGMA/ENSGv110.coding.genes.txt\",  # 基因位置文件路径   Manhtn_plot = TRUE,  # 是否绘制曼哈顿图   threshold_sig = \"bonferroni\",  # 显著性阈值调整方法   Manhtn_gene_sig = 10,  # 曼哈顿图的基因标记标签的数目   signal_cex = 1,  # 显著性基因图形圆点的大小   width = 9,  # 图形宽度   height = 7,  # 图形高度   save_name = \"MAGMA_gsa\"  # 保存的名称 )  # 筛选FDR值小于0.05的基因 MAGMA_genes <- subset(MAGMA_genes, MAGMA_genes$P.fdr < 0.05) # 对MAGMA通路富集分析结果图形可视化 plot_dat <- MAGMA_gsa_barplot(   gsa_out = \"./6.MAGMA/Migraine.gsa.out.txt\",  # GSA结果文件路径   showNum = 50,  # 显示的前50个通路   X_text_size = 5,  # X轴文本大小   X_text_angle = 80,  # X轴文本角度   Y_text_size = 10,  # Y轴文本大小   save_plot = TRUE,  # 是否保存图形   pdf_name = \"gsa_plot\",  # PDF文件名   width = 9,  # 图形宽度   height = 7,  # 图形高度   save_path = \"./6.MAGMA/\"  # 保存路径 )  # 对MAGMA组织特异性分析结果图形可视化 Tissue_specific_dat <- MAGMA_gsa_barplot(   gsa_out = \"./6.MAGMA/Migraine.Tissue_specific.gsa.out.txt\",  # 组织特异性GSA结果文件路径   showNum = 54,  # 显示的54个组织柱状图   X_text_size = 7,  # X轴文本大小   X_text_angle = 70,  # X轴文本角度   Y_text_size = 10,  # Y轴文本大小   save_plot = TRUE,  # 是否保存图形   pdf_name = \"Tissue_specific_gsa_plot\",  # PDF文件名   width = 9,  # 图形宽度   height = 7,  # 图形高度   save_path = \"./6.MAGMA/\"  # 保存路径 )"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"绘制韦恩图","dir":"Articles","previous_headings":"","what":"6.绘制韦恩图","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"对UTMOST、FUSION和MAGMA分析结果进行交集分析","code":"venn_plot <- venn_plot(   files = c(\"./7.venn/UTMOST.txt\", \"./7.venn/FUSION.txt\", \"./7.venn/MAGMA.txt\"),  # 输入的结果文件路径   save_plot = TRUE,  # 是否保存图形   save_name = \"venn_plot\",  # 保存的名称   width = 9,  # 图形宽度   height = 7,  # 图形高度   save_path = \"./7.venn\"  # 保存路径 )"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"孟德尔随机化mr分析","dir":"Articles","previous_headings":"","what":"7.孟德尔随机化（MR）分析","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"7.1 获取GTEx V8组织、样本量信息 7.2 获取不同组织的cis-eQTL数据 7.3 格式化数据并进行去除连锁不平衡 7.4 本地GWAS数据获取代理SNP 7.5 对暴露和结果数据进行harmonisation（协调化） 7.6 MR分析与OR（比值比）转换  7.7 绘制森林图","code":"GTEx_V8_samplesize <- data_info_GTEx_V8_samplesize() ciseQTL1 <- get_ciseQTL_GTEx_V8_Online(   Gene_name = \"REV1\",  # 基因名称   tissues = \"Whole Blood\",  # 组织类型   cis_wind_kb = 1000,  # cis区域窗口大小（以kb为单位）   build = 38,  # 基因组版本（38代表GRCh38）   save_path = \"./8.MR\"  # 保存路径 ) ciseQTL1$gene <- \"REV1(Whole Blood)\"  # 添加组织信息  ciseQTL2 <- get_ciseQTL_GTEx_V8_Online(   Gene_name = \"REV1\",  # 基因名称   tissues = \"Cells - Cultured fibroblasts\",  # 组织类型   cis_wind_kb = 1000,  # cis区域窗口大小（以kb为单位）   build = 38,  # 基因组版本（38代表GRCh38）   save_path = \"./8.MR\"  # 保存路径 ) ciseQTL2$gene <- \"REV1(Cells - Cultured fibroblasts)\"  # 添加组织信息  ciseQTL3 <- get_ciseQTL_GTEx_V8_Online(   Gene_name = \"SREBF2\",  # 基因名称   tissues = \"Testis\",  # 组织类型   cis_wind_kb = 1000,  # cis区域窗口大小（以kb为单位）   build = 38,  # 基因组版本（38代表GRCh38）   save_path = \"./8.MR\"  # 保存路径 ) ciseQTL3$gene <- \"SREBF2(Testis)\"  # 添加组织信息  # 合并所有的cis-eQTL数据 ciseQTL <- rbind(ciseQTL1, ciseQTL2, ciseQTL3)  # 按基因分割数据成list ciseQTL <- split(ciseQTL, ciseQTL$gene)    # 保存合并后的cis-eQTL数据 save(ciseQTL, file = \"./8.MR/ciseQTL.Rdata\") exp <- c() for (i in names(ciseQTL)) {   dat <- format_dat(     ciseQTL[[i]],  # 输入的cis-eQTL数据     type = \"exposure\",  # 数据类型为暴露数据     phenotype_col = \"gene\",  # 基因列的名称     snp_col = \"SNP\",  # SNP列的名称     beta_col = \"beta\",  # beta系数列的名称     se_col = \"se\",  # 标准误列的名称     eaf_col = \"eaf\",  # 等位基因频率列的名称     effect_allele_col = \"effect_allele\",  # 效应等位基因列的名称     other_allele_col = \"other_allele\",  # 非效应等位基因列的名称     pval_col = \"pval\",  # p值列的名称     samplesize_col = \"N\",  # 样本量列的名称     chr_col = \"CHR\",  # 染色体列的名称     pos_col = \"BP\"  # 位点列的名称   ) %>%     clump_data_local_Online(       snp_col = \"SNP\",  # SNP列的名称       pval_col = \"pval.exposure\",  # p值列的名称       clump_method = \"PVAL\",  # clump方法       beta_col = \"beta.exposure\",  # beta系数列的名称       se_col = \"se.exposure\",  # 标准误列的名称       clump_pval = 5e-08,  # clump p值阈值       clump_kb = 10000,  # clump窗口大小（以kb为单位）       clump_r2 = 0.001,  # clump R^2阈值       pop = \"EUR\",  # 参考人群为欧洲人群       bfile_1000G = \"./1.data/1000G/EUR\"  # 1000G参考数据路径     )   exp <- rbind(exp, dat)  # 合并所有格式化和clump后的数据 } out <- modified_proxy_1000G(   snps = exp$SNP,  # SNP列表   GWASfile = \"./1.data/Migraine_TwosampleMR_FinnGen.txt\",  # GWAS文件路径   proxies = TRUE,  # 是否寻找代理SNP   rsq = 0.8,  # 代理SNP的R^2阈值   kb = 5000,  # 代理SNP的窗口大小（以kb为单位）   nsnp = 5000,  # 代理SNP的最大数量   maf_threshold = 0.3,  # 最小等位基因频率阈值   bfile_1000G = \"./1.data/1000G/EUR\"  # 1000G参考数据路径 ) dat <- TwoSampleMR::harmonise_data(exp, out) # 进行孟德尔随机化（MR）分析 res <- xQTL_mr(dat, FDR_method = NULL, PVE = TRUE)  # 生成OR（比值比）结果 or <- TwoSampleMR::generate_odds_ratios(res) xQTL_forest(   res,  # MR分析结果   pvalsig = NULL,  # 显著性p值阈值   ci_col = \"#000000\",  # 置信区间颜色   ci_fill = \"#000000\",  # 置信区间填充色   ci_lwd = 1,  # 置信区间线宽   xlim = c(0.6, 1.2),  # x轴范围   ticks_at = c(0.6, 0.7, 0.8, 0.9, 1, 1.1, 1.2),  # x轴刻度   save_plot = TRUE,  # 是否保存图形   plot_pdf = \"forest_plot\",  # PDF文件名   width = 8,  # 图形宽度   height = 5,  # 图形高度   save_path = \"./8.MR\"  # 保存路径 )"},{"path":"https://hortoner.github.io/QTLMR/articles/1.跨组织转录组关联研究寻找疾病易感基因.html","id":"共定位分析","dir":"Articles","previous_headings":"","what":"8.共定位分析","title":"1.跨组织转录组关联研究寻找疾病易感基因","text":"8.1 读取结局数据GWAS结果数据 8.2 加载之前保存的cis-eQTL数据 8.3 循环进行共定位分析 8.4 打印和保存共定位分析总结","code":"outcome_dat <- vroom::vroom(\"./1.data/Migraine_TwosampleMR_FinnGen.txt\", show_col_types = FALSE) # 加载之前保存的cis-eQTL数据 load(\"./8.MR/ciseQTL.Rdata\") coloc_summary <- c()  # 遍历每个基因进行共定位分析 for (j in names(ciseQTL)) {   dat_coloc <- coloc_GWAS(     exposure_dat = ciseQTL[[j]],  # 暴露数据     outcome_dat = outcome_dat,  # 结局数据     type_exposure = \"quant\",  # 暴露类型为定量     col_pvalues_exposure = \"pval\",  # 暴露数据中的p值列     col_N_exposure = \"N\",  # 暴露数据中的样本量列     col_MAF_exposure = \"MAF\",  # 暴露数据中的等位基因频率列     col_beta_exposure = \"beta\",  # 暴露数据中的beta系数列     col_se_exposure = \"se\",  # 暴露数据中的标准误列     col_snp_exposure = \"SNP\",  # 暴露数据中的SNP列     col_chr_exposure = \"CHR\",  # 暴露数据中的染色体列     col_pos_exposure = \"BP\",  # 暴露数据中的位点列     sd_exposure = NA,  # 暴露数据的标准差     type_outcome = \"cc\",  # 结局类型为病例对照     col_pvalues_outcome = \"pval.outcome\",  # 结局数据中的p值列     col_N_outcome = \"samplesize.outcome\",  # 结局数据中的样本量列     col_MAF_outcome = NA,  # 结局数据中的等位基因频率列     col_beta_outcome = \"beta.outcome\",  # 结局数据中的beta系数列     col_se_outcome = \"se.outcome\",  # 结局数据中的标准误列     col_snp_outcome = \"SNP\",  # 结局数据中的SNP列     prevalence_outcome = NA,  # 结局数据中的患病率     save_stacked_dat = TRUE,  # 是否保存绘制连锁区域图数据     build = 38,  # 基因组版本（38代表GRCh38）     save_locus = FALSE,  # 是否保存locus数据     title1 = paste0(\"eQTL \", j),  # 图形标题1     title2 = \"GWAS Migraine\",  # 图形标题2    请自行按照实际GWAS名字修改     width = 8,  # 图形宽度     height = 5,  # 图形高度     plot_pdf = \"locuscompare\",  # PDF文件名     save_path = \"./9.coloc\"  # 保存路径   )    # 提取和处理共定位分析结果   summary <- dat_coloc[[\"summary\"]] %>%     dplyr::mutate(gene = j) %>%     dplyr::select(gene, everything())    # 绘制和保存共定位连锁区域结果图   dat_assoc <- coloc_stack_assoc_plot(     assoc = assoc,     bfile_1000G = \"./1.data/1000G/EUR\",  # 1000G参考数据路径     SNP = SigSNP,  # 显著SNP     build = 38,  # 基因组版本（38代表GRCh38）     title1 = paste0(\"eQTL \", j),  # 图形标题1     title2 = \"GWAS Migraine\",  # 图形标题2     save_plot = TRUE,  # 是否保存图形     width = 9,  # 图形宽度     height = 10,  # 图形高度     plot_pdf = paste0(j, \"_plot\"),  # PDF文件名     save_path = \"./9.coloc\"  # 保存路径   )    # 合并所有共定位分析结果   coloc_summary <- rbind(coloc_summary, summary) } print(coloc_summary) write.csv(coloc_summary, file = \"./9.coloc/coloc_res.csv\", row.names = FALSE) # 还可以联合SMR、FOCUS、TWAS其他算法、生信分析及湿实验等方法，丰富文章内容！  ## 感谢各位小伙伴使用..."},{"path":"https://hortoner.github.io/QTLMR/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"YB H. Author, maintainer.","code":""},{"path":"https://hortoner.github.io/QTLMR/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"H Y (2025). QTLMR: 快速进行Post GWAS与xQTL MR相关分析. R package version 2.25, https://hortoner.github.io/QTLMR.","code":"@Manual{,   title = {QTLMR: 快速进行Post GWAS与xQTL MR相关分析},   author = {YB H},   year = {2025},   note = {R package version 2.25},   url = {https://hortoner.github.io/QTLMR}, }"},{"path":"https://hortoner.github.io/QTLMR/index.html","id":"qtlmr","dir":"","previous_headings":"","what":"快速进行Post GWAS与xQTL MR相关分析","title":"快速进行Post GWAS与xQTL MR相关分析","text":"                                   联系作者：Dr.H E-mail: 2214047750@qq.com          在现代生物医学研究中，理解基因与疾病之间的因果关系是发现新的治疗靶点的关键；通过 MR、coloc、PWcoco、SMR、FOCUS、MTAG、Hess、METAL、LDSC、HDL、SUPERGNOVA、GNOVA、CPASSOC、PLACO、MiXeR、cond/conjFDR、FM_summary、 GCTA_fastBAT、MAGMA、MR-JTI 和 TWAS 分析等多种算法及多种可视化绘图功能。这些方法共同为快速识别疾病发病的诱因、治疗的潜在靶点提供了一体化的解决方案。","code":""},{"path":"https://hortoner.github.io/QTLMR/index.html","id":"r语言集合软件包安装与更新","dir":"","previous_headings":"","what":"R语言集合软件包安装与更新:","title":"快速进行Post GWAS与xQTL MR相关分析","text":"论文复现教学视频:    https://b23.tv/1kbNqFk 论文复现示例代码:    https://hortoner.github.io/QTLMR/articles/index.html 1. 内置多种组学数据: 人类史上最大规模的pQTL数据（decode、ukb-ppp、fenland队列），总数据量10T+，已清洗内置，用于探索疾病的治疗靶点； 剪接、甲基化、基因、蛋白等sQTL、mQTL、eQTL、pQTL数据提供下载地址； 196种、412种及473种3大队列肠道微生物（菌群）暴露数据，用于探索肠道微生物（菌群）及其代谢通路与疾病/临床性状的因果关系； 1400种血浆代谢物暴露数据，用于探索血浆代谢物与疾病的因果关系； 731种免疫细胞暴露数据，用于探索人体免疫细胞与疾病的因果关系； 41种炎症因子及91种炎症蛋白露数据，用于探索炎症因子或蛋白与疾病的因果关系； IEU数据库中7020个临床表型暴露数据，快速寻找疾病/临床性状的发病因素； 更多数据将不断更新… 2. 内置多种兼容Linux、python分析软件: plink: 基础性工具，用于GWAS中的遗传数据质量控制和单、多标记分析； SMR: 通过整合GWAS与eQTL数据，鉴别潜在因果基因的工具； GCTA:计算全基因组 SNP 对复杂性状解释的表型方差比例的软件； METAL: 用于多队列GWAS meta分析的工具，整合不同样本的遗传效应； MTAG: 联合多个表型进行GWAS分析，提升统计效能的工具； Hess: 估计基因组区域遗传方差成分，解析复杂性状遗传架构； CPASSOC: 多表型联合分析，检测表型间共享遗传效应的工具； LDSC: 基于LD分数的回归方法，用于估算遗传相关性和遗传度； PLACO: 多效性检测工具，分析共享遗传变异对多性状的影响； FUSION: 整合表型和功能数据，估计基因遗传效应的工具； UTMOST: 跨组织GWAS分析，探索基因表达对表型影响； FUCUS: 基于功能注释精细定位GWAS信号，提高复杂性状变异鉴定； MR-JTI: 从基因型数据推导多个组织的基因表达水平，从而做TWAS和MR分析； MAGMA: 基因和基因集分析工具，适用于大规模多标记关联研究； 已适当优化软件底层代码，减少报错，提高兼容性。         QTLMR包为研究人员提供了一套完整且强大的工具，用于揭示基因与疾病之间的因果关系。通过MR、coloc、PWcoco、SMR、FOCUS、MTAG、Hess、METAL、LDSC、HDL、SUPERGNOVA、GNOVA、CPASSOC、PLACO、MiXeR、cond/conjFDR、FM_summary、 GCTA_fastBAT、MAGMA、MR-JTI 和 TWAS 分析等多种算法，QTLMR包帮助研究人员快速识别疾病的潜在治疗靶点。如果你致力于理解基因与疾病的关系并寻找新的治疗靶点或探索疾病发病机制，QTLMR包将是您的理想选择，祝君科研顺利！         更多函数及功能将不断更新，敬请期待…","code":"#安装remotes包。 install.packages(\"remotes\")  #安装QTLMRget包。 remotes::install_github(\"Hortoner/QTLMRget\")  #获取token，付费授权；一次授权永久免费更新。 QTLMRget::getToken()  #在线安装；老用户无需重复授权，可直接更新QTLMR包。 QTLMRget::install_QTLMR()  #配置Rtools、OPENGWAS_JWT与GITHUB_TOKEN的token## QTLMRget::install_token(OPENGWAS_JWT = \" \", GITHUB_TOKEN = \" \")  #安装QTLMR相关依赖包；可重复多次运行该函数，直到所有依赖包安装成功。 QTLMRget::install_QTLMR_dependence()  #加载QTLMR程序包（首次加载需1-2分钟更新内置软件）。 library(QTLMR)  ##查看QTLMR包使用帮助文档。 help(package = QTLMR)"},{"path":"https://hortoner.github.io/QTLMR/reference/available_outcomes_ieu.html","id":null,"dir":"Reference","previous_headings":"","what":"IEU Open GWAS数据库表型汇总表 — available_outcomes_ieu","title":"IEU Open GWAS数据库表型汇总表 — available_outcomes_ieu","text":"IEU Open GWAS数据库表型汇总表","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/available_outcomes_ieu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IEU Open GWAS数据库表型汇总表 — available_outcomes_ieu","text":"","code":"available_outcomes_ieu()"},{"path":"https://hortoner.github.io/QTLMR/reference/available_outcomes_ieu.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IEU Open GWAS数据库表型汇总表 — available_outcomes_ieu","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_download.html","id":null,"dir":"Reference","previous_headings":"","what":"使用百度网盘下载文件 — Baidu_download","title":"使用百度网盘下载文件 — Baidu_download","text":"重要提示:需要把系统的区域编码设置为UTF-8!更多信息请参考软件官网：https://github.com/houtianze/bypy。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_download.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用百度网盘下载文件 — Baidu_download","text":"","code":"Baidu_download(   help = FALSE,   list = FALSE,   download_file = \"LDSC.zip\",   save_path = \"./baidu\",   processes = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_download.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用百度网盘下载文件 — Baidu_download","text":"help 是否调阅百度网盘下载工具的帮助文档，默认值为 FALSE。 list 是否列出百度网盘中的文件，默认值为 FALSE。 download_file 下载的文件名，例如为 \"LDSC.zip\"。 save_path 文件保存的路径，默认为当前目录下的 \"./baidu\"。 processes 使用的进程数，默认为 1。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_download.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用百度网盘下载文件 — Baidu_download","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_py_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置百度网盘python环境 — Baidu_py_install","title":"配置百度网盘python环境 — Baidu_py_install","text":"重要提示:需要把系统的区域编码设置为UTF-8!更多信息请参考软件官网：https://github.com/houtianze/bypy。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_py_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置百度网盘python环境 — Baidu_py_install","text":"","code":"Baidu_py_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/Baidu_py_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置百度网盘python环境 — Baidu_py_install","text":"force TRUE或FALSE，是否重新安装百度网盘软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/calculation_Fvalue_R2.html","id":null,"dir":"Reference","previous_headings":"","what":"计算F值与R2 — calculation_Fvalue_R2","title":"计算F值与R2 — calculation_Fvalue_R2","text":"这个函数提供4种计算方法,输入数据必须包含\"beta\"或\"beta.exposure\"，\"se\"或\"se.exposure\"，\"eaf\"或\"eaf.exposure\"，\"samplesize\"或\"samplesize.exposure\"列名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/calculation_Fvalue_R2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"计算F值与R2 — calculation_Fvalue_R2","text":"","code":"calculation_Fvalue_R2(exp_GWAS, samplesize = NULL)"},{"path":"https://hortoner.github.io/QTLMR/reference/calculation_Fvalue_R2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"计算F值与R2 — calculation_Fvalue_R2","text":"exp_GWAS harmonise_data后的dat数据或自定义数据。 samplesize 样本量大小，如果GWAS缺失样本量，需要赋值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/calculation_Fvalue_R2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"计算F值与R2 — calculation_Fvalue_R2","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/clump_data_local_Online.html","id":null,"dir":"Reference","previous_headings":"","what":"本地或在线方式去除连锁不平衡 — clump_data_local_Online","title":"本地或在线方式去除连锁不平衡 — clump_data_local_Online","text":"本地或在线方式去除连锁不平衡","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/clump_data_local_Online.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"本地或在线方式去除连锁不平衡 — clump_data_local_Online","text":"","code":"clump_data_local_Online(   dat,   snp_col = \"SNP\",   pval_col = \"pval.exposure\",   clump_method = \"PVAL\",   beta_col = \"beta.exposure\",   se_col = \"se.exposure\",   clump_pval = 5e-08,   clump_kb = 10000,   clump_r2 = 0.001,   pop = \"EUR\",   bfile_1000G = NULL )"},{"path":"https://hortoner.github.io/QTLMR/reference/clump_data_local_Online.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"本地或在线方式去除连锁不平衡 — clump_data_local_Online","text":"dat 输入的GWAS数据。 snp_col SNP列的名称。 pval_col P值列的名称。 clump_method 去除连锁不平衡基于\"PVAL\"或\"LOG10P\"值，若数据中存在多个pval<计算机最小精确度1e-324时，请选择\"LOG10P\"。 beta_col beta值列的名称，选择\"LOG10P\"，需要填写，。 se_col se值列的名称，选择\"LOG10P\"，需要填写。 clump_pval 显著性P值的过滤阈值，默认为5e-8。 clump_kb 连锁不平衡窗口大小范围，默认值为10000。 clump_r2 连锁不平衡系数r2大小，默认值为0.001。 pop 人群种族，默认为\"EUR\"，在线方式去除连锁不平衡时需要填写。 bfile_1000G NULL表示使用在线方式，本地方式请填写1000G基因型数据文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/clump_data_local_Online.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"本地或在线方式去除连锁不平衡 — clump_data_local_Online","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/clump_LD_R2.html","id":null,"dir":"Reference","previous_headings":"","what":"获取连锁的SNP — clump_LD_R2","title":"获取连锁的SNP — clump_LD_R2","text":"获取连锁的SNP","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/clump_LD_R2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"获取连锁的SNP — clump_LD_R2","text":"","code":"clump_LD_R2(   dat,   snp_col = \"SNP\",   clump_kb = 1000,   clump_r2 = 0.01,   bfile_1000G = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/clump_LD_R2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"获取连锁的SNP — clump_LD_R2","text":"dat 输入的GWAS数据。 snp_col SNP列的名称。 clump_kb 连锁窗口大小范围，默认值为1000。 clump_r2 连锁系数r2大小，默认值为0.2。 bfile_1000G 1000G基因型数据文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/clump_LD_R2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"获取连锁的SNP — clump_LD_R2","text":"连锁的SNP","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_GWAS.html","id":null,"dir":"Reference","previous_headings":"","what":"GWAS共定位分析并绘制locuscomparer图 — coloc_GWAS","title":"GWAS共定位分析并绘制locuscomparer图 — coloc_GWAS","text":"这个函数用于执行共定位分析并绘图。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_GWAS.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GWAS共定位分析并绘制locuscomparer图 — coloc_GWAS","text":"","code":"coloc_GWAS(   exposure_dat,   outcome_dat,   type_exposure = \"quant\",   col_pvalues_exposure = \"pval\",   col_N_exposure = \"N\",   col_MAF_exposure = \"MAF\",   col_beta_exposure = \"beta\",   col_se_exposure = \"se\",   col_snp_exposure = \"SNP\",   col_chr_exposure = \"CHR\",   col_pos_exposure = \"BP\",   sd_exposure = NA,   type_outcome = \"cc\",   col_pvalues_outcome = \"pval.outcome\",   col_N_outcome = \"samplesize.outcome\",   col_MAF_outcome = NA,   col_beta_outcome = \"beta.outcome\",   col_se_outcome = \"se.outcome\",   col_snp_outcome = \"SNP\",   prevalence_outcome = NA,   save_stacked_dat = FALSE,   build = 38,   save_locus = FALSE,   title1 = \"xQTL\",   title2 = \"GWAS\",   width = 8,   height = 5,   plot_pdf = \"locuscompare\",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_GWAS.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GWAS共定位分析并绘制locuscomparer图 — coloc_GWAS","text":"exposure_dat 暴露数据GWAS。非R包内置xQTL数据，可使用xQTL_cis_dat()函数转换获取。 outcome_dat 结局数据GWAS。建议使用标准的TwosampleMR格式结局数据。 type_exposure 暴露数据GWAS类型，\"quant\"或\"cc\"，\"quant\"表示连续型数据，\"cc\"表示二分类型数据，默认为\"quant\"。 col_pvalues_exposure 必填，暴露数据GWAS中p值所在的列的名称，默认为\"pval\"。 col_N_exposure 必填，暴露数据GWAS中样本量所在的列的名称，默认为\"N\"。 col_MAF_exposure 必填，暴露数据GWAS中次要等位基因频率所在的列的名称，默认为\"MAF\"。 col_beta_exposure 必填，暴露数据GWAS中beta系数所在的列的名称，默认为\"beta\"。 col_se_exposure 必填，暴露数据GWAS中标准误差所在的列的名称，默认为\"se\"。 col_snp_exposure 必填，暴露数据GWAS中SNP标识所在的列的名称，默认为\"SNP\"。 col_chr_exposure 非必填，暴露数据GWAS中chr标识所在的列的名称，默认为\"CHR\"，若不准备Stacked regional plot数据可不填。 col_pos_exposure 非必填，暴露数据GWAS中pos标识所在的列的名称，默认为\"BP\"，若不准备Stacked regional plot数据可不填。 sd_exposure 暴露数据GWAS的标准差，默认为NA。 type_outcome 结局数据GWAS的类型，\"quant\"或\"cc\"，\"quant\"表示连续型数据，\"cc\"表示二分类型数据，默认为\"cc\"。 col_pvalues_outcome 必填，结局数据GWAS中p值所在的列的名称，默认为\"pval.outcome\"。 col_N_outcome 必填，结局数据GWAS中样本大小所在的列的名称，默认为\"samplesize.outcome\"。 col_MAF_outcome 非必填，结局数据GWAS中最小等位基因频率所在的列的名称，默认NA。 col_beta_outcome 必填，结局数据GWAS中beta系数所在的列的名称，默认为\"beta.outcome\"。 col_se_outcome 必填，结局数据GWAS中标准误差所在的列的名称，默认为\"se.outcome\"。 col_snp_outcome 必填，结局数据GWAS中SNP标识所在的列的名称，默认为\"SNP\"。 prevalence_outcome 结局数据的患病率，默认为NA。 save_stacked_dat TRUE或FALSE，是否返回基因组区域stack_assoc_plot图数据，默认为FALSE，如果TRUE，则返回assoc、SigSNP数据。 build 37或38，人类参考基因组版本，默认38。 save_locus TRUE或FALSE，是否保存locuscomparer作图，默认为FALSE。 title1 xQTL图的标题。 title2 GWAS图的标题。 width 图形宽度。 height 图形高度。 plot_pdf 保存的pdf图形文件名，默认locuscompare。 save_path 图形文件保存路径，默认\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_GWAS.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GWAS共定位分析并绘制locuscomparer图 — coloc_GWAS","text":"共定位分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_stack_assoc_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制stack_assoc_plot图 — coloc_stack_assoc_plot","title":"绘制stack_assoc_plot图 — coloc_stack_assoc_plot","text":"绘制stack_assoc_plot图","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_stack_assoc_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制stack_assoc_plot图 — coloc_stack_assoc_plot","text":"","code":"coloc_stack_assoc_plot(   assoc,   bfile_1000G,   SNP = NULL,   build = 38,   title1 = \"xQTL\",   title2 = \"GWAS\",   save_plot = FALSE,   width = 9,   height = 10,   plot_pdf = \"stack_assoc_plot\",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_stack_assoc_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制stack_assoc_plot图 — coloc_stack_assoc_plot","text":"assoc 运行coloc_GWAS函数时输出的stack_assoc_plot绘图数据。 bfile_1000G 1000G基因型数据文件路径。 SNP 需要展示的rsid，填写NULL时默认为最显著的SNP。 build 37或38，人类参考基因组版本，默认38。 title1 xQTL图的标题。 title2 GWAS图的标题。 save_plot TRUE或FALSE，是否保存stack_assoc_plot作图，默认为FALSE。 width 图形宽度。 height 图形高度。 plot_pdf 保存的pdf图形文件名，默认\"stack_assoc_plot\"。 save_path 图形文件保存路径，默认\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/coloc_stack_assoc_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制stack_assoc_plot图 — coloc_stack_assoc_plot","text":"geni.plots函数作图数据，可自定义绘图。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/cond_conjFDR.html","id":null,"dir":"Reference","previous_headings":"","what":"cond/conjFDR分析 — cond_conjFDR","title":"cond/conjFDR分析 — cond_conjFDR","text":"使用cfdr.pleio包实现了cond/conjFDR两种推断方法，以利用和识别一对表型性状之间的遗传多效性。 详见：https://github.com/alexploner/cfdr.pleio。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/cond_conjFDR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cond/conjFDR分析 — cond_conjFDR","text":"","code":"cond_conjFDR(   GWASfile = c(\"./dat/trait1_MTAG.txt\", \"./dat/trait2_MTAG.txt\"),   trait_names = c(\"trait1\", \"trait2\"),   refdata_location = \"./REF_DIR\",   n_iter = 50,   seed = 154226 )"},{"path":"https://hortoner.github.io/QTLMR/reference/cond_conjFDR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cond/conjFDR分析 — cond_conjFDR","text":"GWASfile 包含两个或多个GWAS数据文件的路径，可由format_dat()转换获得，MTAG或METAL格式数据。 trait_names 性状名称，默认c(\"trait1\", \"trait2\")。 refdata_location 字符串，遗传参考数据的文件夹路径。下载地址：https://zenodo.org/record/5750318/files/genref.zip，需解压使用。 n_iter 整数，迭代的次数，默认50。为了最小化随机选择的影响。 seed 整数，设置随机种子数。默认154226。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/cond_conjFDR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cond/conjFDR分析 — cond_conjFDR","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/CPASSOC_meta_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"使用cpassoc跨性状关联分析 — CPASSOC_meta_gwas","title":"使用cpassoc跨性状关联分析 — CPASSOC_meta_gwas","text":"详见：https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6417431/。 输入数据必须包含以SNP、CHR、BP、effect_allele、other_allele、Z为列名数据内容。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/CPASSOC_meta_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用cpassoc跨性状关联分析 — CPASSOC_meta_gwas","text":"","code":"CPASSOC_meta_gwas(   GWASfile = c(\"./dat1.txt\", \"./dat1.txt\"),   GWAS_samplesizes = c(10000, 2000),   GWAS_name = NULL,   mvrnorm_n = 1e+06,   methods_sig = \"SHet\",   sig_pval = 5e-08,   bfile = NULL,   window_kb = 500,   step_SNP = 50,   r2 = 0.2,   save_name = \"CPASSOC\",   save_path = \"./CPASSOC\",   cores = 4 )"},{"path":"https://hortoner.github.io/QTLMR/reference/CPASSOC_meta_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用cpassoc跨性状关联分析 — CPASSOC_meta_gwas","text":"GWASfile 包含两个或多个GWAS数据文件的路径，可由format_dat()转换的MTAG格式数据，如c(\"./dat1.txt\", \"./dat1.txt\")。 GWAS_samplesizes 性状样本量大小，如c(10000, 2000)。 GWAS_name 输入GWAS性状的名称，如c(\"trait1\", \"trait2\") mvrnorm_n 多元正态分布随机样本的数量，默认为1e6。 methods_sig \"SHet\"或\"SHom\"，提取显著性SNP的检验方法，默认\"SHet\"。 sig_pval 跨性状关联分析SNP的显著性阈值，默认5e-8。 bfile 对SNP进行成对LD修剪时，参考面板数据的文件路径。若设置为NULL，则不进行成对不修剪。 window_kb 成对LD修剪时窗口大小，默认500kb。 step_SNP 成对LD修剪时,每一步移动窗口的SNP数量，默认50。 r2 成对LD修剪时,表示r²（连锁不平衡的平方相关系数）的阈值。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/CPASSOC_meta_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用cpassoc跨性状关联分析 — CPASSOC_meta_gwas","text":"显著关联分析结果","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQTL_ukb_ppp_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"ukb-ppp cis-pQTL的暴露数据 — data_cispQTL_ukb_ppp_exp","title":"ukb-ppp cis-pQTL的暴露数据 — data_cispQTL_ukb_ppp_exp","text":"显著性 p<5e-8。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQTL_ukb_ppp_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ukb-ppp cis-pQTL的暴露数据 — data_cispQTL_ukb_ppp_exp","text":"","code":"data_cispQTL_ukb_ppp_exp(clump = 1)"},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQTL_ukb_ppp_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ukb-ppp cis-pQTL的暴露数据 — data_cispQTL_ukb_ppp_exp","text":"clump 1或2。1表示去除连锁不平衡参数为10000kb,r2=0.001；2表示去除连锁不平衡参数为5000kb,r2=0.001。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQTL_ukb_ppp_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ukb-ppp cis-pQTL的暴露数据 — data_cispQTL_ukb_ppp_exp","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_decode_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"decode cis-pQTL的暴露数据 — data_cispQT_decode_exp","title":"decode cis-pQTL的暴露数据 — data_cispQT_decode_exp","text":"显著性 p<5e-8。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_decode_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"decode cis-pQTL的暴露数据 — data_cispQT_decode_exp","text":"","code":"data_cispQT_decode_exp(clump = 1)"},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_decode_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"decode cis-pQTL的暴露数据 — data_cispQT_decode_exp","text":"clump 1、2、4或4。1表示去除连锁不平衡参数为10000kb,r2=0.001；2表示去除连锁不平衡参数为1000kb,r2=0.01；3表示去除连锁不平衡参数为5000kb,r2=0.001， 4表示数据来自于文章PMID:38540773，具体参数如文章方法所示。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_decode_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"decode cis-pQTL的暴露数据 — data_cispQT_decode_exp","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_fenland_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"fenland cis-pQTL的暴露数据 — data_cispQT_fenland_exp","title":"fenland cis-pQTL的暴露数据 — data_cispQT_fenland_exp","text":"显著性 p<5e-8，去除连锁不平衡参数为10000kb,r2=0.001。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_fenland_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fenland cis-pQTL的暴露数据 — data_cispQT_fenland_exp","text":"","code":"data_cispQT_fenland_exp()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_cispQT_fenland_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"fenland cis-pQTL的暴露数据 — data_cispQT_fenland_exp","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_196.html","id":null,"dir":"Reference","previous_headings":"","what":"196种肠道微生物暴露数据 — data_Gut_microbes_196","title":"196种肠道微生物暴露数据 — data_Gut_microbes_196","text":"p值=1e-5，去除连锁不平衡参数为默认参数，数据来源：PMID:33462485。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_196.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"196种肠道微生物暴露数据 — data_Gut_microbes_196","text":"","code":"data_Gut_microbes_196()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_196.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"196种肠道微生物暴露数据 — data_Gut_microbes_196","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_412.html","id":null,"dir":"Reference","previous_headings":"","what":"412种肠道微生物暴露数据 — data_Gut_microbes_412","title":"412种肠道微生物暴露数据 — data_Gut_microbes_412","text":"p值=1e-5，去除连锁不平衡参数为默认参数，数据来源：PMID:35115690。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_412.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"412种肠道微生物暴露数据 — data_Gut_microbes_412","text":"","code":"data_Gut_microbes_412()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_412.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"412种肠道微生物暴露数据 — data_Gut_microbes_412","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_473.html","id":null,"dir":"Reference","previous_headings":"","what":"473种肠道微生物暴露数据 — data_Gut_microbes_473","title":"473种肠道微生物暴露数据 — data_Gut_microbes_473","text":"p值=1e-5，去除连锁不平衡参数为默认参数，数据来源：PMID:35115689。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_473.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"473种肠道微生物暴露数据 — data_Gut_microbes_473","text":"","code":"data_Gut_microbes_473()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Gut_microbes_473.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"473种肠道微生物暴露数据 — data_Gut_microbes_473","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_exposure_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"IEU数据库中7020个临床表型暴露数据 — data_IEU_exposure_dat","title":"IEU数据库中7020个临床表型暴露数据 — data_IEU_exposure_dat","text":"p值=5e-8，去除连锁不平衡参数为默认参数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_exposure_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IEU数据库中7020个临床表型暴露数据 — data_IEU_exposure_dat","text":"","code":"data_IEU_exposure_dat()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_exposure_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IEU数据库中7020个临床表型暴露数据 — data_IEU_exposure_dat","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_prot_a.html","id":null,"dir":"Reference","previous_headings":"","what":"IEU数据库中Sun_BB_protein的3282个蛋白数据 — data_IEU_prot_a","title":"IEU数据库中Sun_BB_protein的3282个蛋白数据 — data_IEU_prot_a","text":"p值=1e-5，去除连锁不平衡参数为默认参数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_prot_a.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IEU数据库中Sun_BB_protein的3282个蛋白数据 — data_IEU_prot_a","text":"","code":"data_IEU_prot_a()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_prot_a.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IEU数据库中Sun_BB_protein的3282个蛋白数据 — data_IEU_prot_a","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_prot_c.html","id":null,"dir":"Reference","previous_headings":"","what":"IEU数据库中prot_c的1124个蛋白数据 — data_IEU_prot_c","title":"IEU数据库中prot_c的1124个蛋白数据 — data_IEU_prot_c","text":"p值=1e-5，去除连锁不平衡参数为默认参数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_prot_c.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IEU数据库中prot_c的1124个蛋白数据 — data_IEU_prot_c","text":"","code":"data_IEU_prot_c()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_IEU_prot_c.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"IEU数据库中prot_c的1124个蛋白数据 — data_IEU_prot_c","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Immunocytokine_731.html","id":null,"dir":"Reference","previous_headings":"","what":"731种免疫细胞因子暴露数据 — data_Immunocytokine_731","title":"731种免疫细胞因子暴露数据 — data_Immunocytokine_731","text":"p值=1e-5","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Immunocytokine_731.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"731种免疫细胞因子暴露数据 — data_Immunocytokine_731","text":"","code":"data_Immunocytokine_731(clump = 1)"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Immunocytokine_731.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"731种免疫细胞因子暴露数据 — data_Immunocytokine_731","text":"clump 1或2。1表示去除连锁不平衡参数为10000kb,r2=0.001；2表示去除连锁不平衡参数为100kb,r2=0.1，详见文章PMID: 37582716。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Immunocytokine_731.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"731种免疫细胞因子暴露数据 — data_Immunocytokine_731","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Inflammatory_factors_41.html","id":null,"dir":"Reference","previous_headings":"","what":"41种炎症因子暴露数据 — data_Inflammatory_factors_41","title":"41种炎症因子暴露数据 — data_Inflammatory_factors_41","text":"p值=5e-6，去除连锁不平衡参数为默认参数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Inflammatory_factors_41.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"41种炎症因子暴露数据 — data_Inflammatory_factors_41","text":"","code":"data_Inflammatory_factors_41()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Inflammatory_factors_41.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"41种炎症因子暴露数据 — data_Inflammatory_factors_41","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Inflammatory_proteins_91.html","id":null,"dir":"Reference","previous_headings":"","what":"91种血浆循环炎症蛋白 — data_Inflammatory_proteins_91","title":"91种血浆循环炎症蛋白 — data_Inflammatory_proteins_91","text":"p值=1e-5，去除连锁不平衡参数为默认参数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Inflammatory_proteins_91.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"91种血浆循环炎症蛋白 — data_Inflammatory_proteins_91","text":"","code":"data_Inflammatory_proteins_91()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Inflammatory_proteins_91.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"91种血浆循环炎症蛋白 — data_Inflammatory_proteins_91","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_cytoBand.html","id":null,"dir":"Reference","previous_headings":"","what":"cytoBand汇总信息数据 — data_info_cytoBand","title":"cytoBand汇总信息数据 — data_info_cytoBand","text":"数据下载地址：https://hgdownload.soe.ucsc.edu/goldenPath/hg19/database/或https://hgdownload.soe.ucsc.edu/goldenPath/hg38/database/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_cytoBand.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"cytoBand汇总信息数据 — data_info_cytoBand","text":"","code":"data_info_cytoBand(build = 38)"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_cytoBand.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"cytoBand汇总信息数据 — data_info_cytoBand","text":"build 37或38，人类参考基因组版本，默认38。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_cytoBand.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"cytoBand汇总信息数据 — data_info_cytoBand","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_decode_pQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"decode pQTL汇总信息数据 — data_info_decode_pQTL","title":"decode pQTL汇总信息数据 — data_info_decode_pQTL","text":"decode pQTL汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_decode_pQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"decode pQTL汇总信息数据 — data_info_decode_pQTL","text":"","code":"data_info_decode_pQTL()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_decode_pQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"decode pQTL汇总信息数据 — data_info_decode_pQTL","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_fenland_pQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"fenland pQTL汇总信息数据 — data_info_fenland_pQTL","title":"fenland pQTL汇总信息数据 — data_info_fenland_pQTL","text":"fenland pQTL汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_fenland_pQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"fenland pQTL汇总信息数据 — data_info_fenland_pQTL","text":"","code":"data_info_fenland_pQTL()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_fenland_pQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"fenland pQTL汇总信息数据 — data_info_fenland_pQTL","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_finngen.html","id":null,"dir":"Reference","previous_headings":"","what":"芬兰R7-R12汇总信息数据 — data_info_finngen","title":"芬兰R7-R12汇总信息数据 — data_info_finngen","text":"芬兰R7-R12汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_finngen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"芬兰R7-R12汇总信息数据 — data_info_finngen","text":"","code":"data_info_finngen()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_finngen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"芬兰R7-R12汇总信息数据 — data_info_finngen","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_GTEx_V8_GENE.html","id":null,"dir":"Reference","previous_headings":"","what":"GTEx_V8基因信息汇总数据 — data_info_GTEx_V8_GENE","title":"GTEx_V8基因信息汇总数据 — data_info_GTEx_V8_GENE","text":"GTEx_V8基因信息汇总数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_GTEx_V8_GENE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GTEx_V8基因信息汇总数据 — data_info_GTEx_V8_GENE","text":"","code":"data_info_GTEx_V8_GENE()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_GTEx_V8_GENE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GTEx_V8基因信息汇总数据 — data_info_GTEx_V8_GENE","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_GTEx_V8_samplesize.html","id":null,"dir":"Reference","previous_headings":"","what":"GTEx_V8样本量汇总信息数据 — data_info_GTEx_V8_samplesize","title":"GTEx_V8样本量汇总信息数据 — data_info_GTEx_V8_samplesize","text":"GTEx_V8样本量汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_GTEx_V8_samplesize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GTEx_V8样本量汇总信息数据 — data_info_GTEx_V8_samplesize","text":"","code":"data_info_GTEx_V8_samplesize()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_GTEx_V8_samplesize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GTEx_V8样本量汇总信息数据 — data_info_GTEx_V8_samplesize","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_ukb_neale.html","id":null,"dir":"Reference","previous_headings":"","what":"ukb neale汇总信息数据 — data_info_ukb_neale","title":"ukb neale汇总信息数据 — data_info_ukb_neale","text":"ukb neale汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_ukb_neale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ukb neale汇总信息数据 — data_info_ukb_neale","text":"","code":"data_info_ukb_neale()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_ukb_neale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ukb neale汇总信息数据 — data_info_ukb_neale","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_ukb_ppp_pQTL.html","id":null,"dir":"Reference","previous_headings":"","what":"ukb-ppp pQTL汇总信息数据 — data_info_ukb_ppp_pQTL","title":"ukb-ppp pQTL汇总信息数据 — data_info_ukb_ppp_pQTL","text":"ukb-ppp pQTL汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_ukb_ppp_pQTL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ukb-ppp pQTL汇总信息数据 — data_info_ukb_ppp_pQTL","text":"","code":"data_info_ukb_ppp_pQTL()"},{"path":"https://hortoner.github.io/QTLMR/reference/data_info_ukb_ppp_pQTL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"ukb-ppp pQTL汇总信息数据 — data_info_ukb_ppp_pQTL","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Metabolites_1400.html","id":null,"dir":"Reference","previous_headings":"","what":"1400种代谢产物的暴露数据 — data_Metabolites_1400","title":"1400种代谢产物的暴露数据 — data_Metabolites_1400","text":"去除连锁不平衡参数为默认参数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Metabolites_1400.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"1400种代谢产物的暴露数据 — data_Metabolites_1400","text":"","code":"data_Metabolites_1400(pval)"},{"path":"https://hortoner.github.io/QTLMR/reference/data_Metabolites_1400.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"1400种代谢产物的暴露数据 — data_Metabolites_1400","text":"pval p的显著性阈值可选择为1e-5,1e-6及5e-8。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/data_Metabolites_1400.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"1400种代谢产物的暴露数据 — data_Metabolites_1400","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/find_Confounders_ensembl.html","id":null,"dir":"Reference","previous_headings":"","what":"从ensembl数据库获取混杂因素 — find_Confounders_ensembl","title":"从ensembl数据库获取混杂因素 — find_Confounders_ensembl","text":"注意：输入数据必须包含SNP数据的列名","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/find_Confounders_ensembl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"从ensembl数据库获取混杂因素 — find_Confounders_ensembl","text":"","code":"find_Confounders_ensembl(   data,   snp_col = \"SNP\",   pval = 5e-08,   save_path = \"./\",   save_name = \"Confounders\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/find_Confounders_ensembl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"从ensembl数据库获取混杂因素 — find_Confounders_ensembl","text":"data 输入数据。 snp_col 包含rsid数据的列名，默认SNP。 pval SNP的显著性阈值，默认pval<5e-8。 save_path 分析结果保存路径，默认为\"./\"。 save_name 分析结果文件名，默认为\"Confounders\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/find_Confounders_ensembl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"从ensembl数据库获取混杂因素 — find_Confounders_ensembl","text":"结果数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/FM_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"简化的贝叶斯精细映射方法（FM-summary） — FM_summary","title":"简化的贝叶斯精细映射方法（FM-summary） — FM_summary","text":"它通过计算每个目标SNP及其附近变异的后验包含概率（PIP）来评估变异与疾病/性状关联的可信度，并生成99%可信的因果变异集合。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/FM_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"简化的贝叶斯精细映射方法（FM-summary） — FM_summary","text":"","code":"FM_summary(   GWASfile = \"xxx.txt\",   bfile = \"./1.data/1000G/EUR\",   index_snps = c(\"rs11966200\", \"rs145365399\", \"rs9391847\"),   index_snp_wind_kb = 500,   R2_threshold = 0.4,   snp_col = \"SNP\",   chr_col = \"chr\",   pos_col = \"pos\",   pval_col = \"pval\",   save_name = \"index\",   save_path = \"./FM\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/FM_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"简化的贝叶斯精细映射方法（FM-summary） — FM_summary","text":"GWASfile 字符串，输入的GWAS结果文件路径，文件应为txt格式，包含SNP、染色体、位置、p值等信息。 bfile 字符串，输入的基因型数据文件路径（PLINK格式的前缀，不包括扩展名）。 index_snps 向量，index SNP集合，函数将聚焦于index SNP进行分析。 index_snp_wind_kb 数字，index SNP周围的窗口大小，用于提取关联的变异，默认上下游500kb。 R2_threshold 数字，R²值的阈值，用于筛选与目标SNP关联性较高的变异。 snp_col 字符串，GWAS数据中SNP列的名称，默认为\"SNP\"。 chr_col 字符串，GWAS数据中染色体列的名称，默认为\"chr\"。 pos_col 字符串，GWAS数据中变异位置列的名称，默认为\"pos\"。 pval_col 字符串，GWAS数据中p值列的名称，默认为\"pval\"。 save_name 字符串，结果文件保存的前缀名称。 save_path 字符串，保存结果文件的路径，若路径不存在则自动创建。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/FM_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"简化的贝叶斯精细映射方法（FM-summary） — FM_summary","text":"返回一个包含目标SNP及其相关变异的结果数据框，其中包括每个变异的PIP、R²值和可信度信息。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"数据格式转换与清洗 — format_dat","title":"数据格式转换与清洗 — format_dat","text":"TwoSampleMR::format_data()函数的改进版，可自动保存标准TwosampleMR、SMR、METAL、MTAG分析文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"数据格式转换与清洗 — format_dat","text":"","code":"format_dat(   dat,   type = \"exposure\",   snps = NULL,   header = TRUE,   phenotype_col = \"Phenotype\",   snp_col = \"SNP\",   beta_col = \"beta\",   se_col = \"se\",   eaf_col = \"eaf\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"pval\",   units_col = \"units\",   ncase_col = \"ncase\",   ncontrol_col = \"ncontrol\",   samplesize_col = \"samplesize\",   gene_col = \"gene\",   id_col = \"id\",   min_pval = 1e-200,   z_col = \"z\",   info_col = \"info\",   chr_col = \"chr\",   pos_col = \"pos\",   log_pval = FALSE,   Twosample_dat = FALSE,   SMR_dat = FALSE,   MTAG_dat = FALSE,   METAL_dat = FALSE,   GWAS_name = \"GWAS\",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"数据格式转换与清洗 — format_dat","text":"dat 读入至R环境中输入数据。 type 指定数据转换的类型，\"exposure\"或\"outcome\"。默认为\"exposure\"。 snps 需要提取的SNP。如果为NULL，则不提取任何SNP并保留所有数据。默认为NULL。 header 数据是否包含标题。默认为TRUE。 phenotype_col 可选的列名，表示SNP对应的表型名称。默认为\"Phenotype\"。 snp_col 必填，包含rsid数据的列名。默认为\"SNP\"。 beta_col 必填，效应值大小列名。默认为\"beta\"。 se_col 必填，标准误列名。默认为\"se\"。 eaf_col 必填，效应等位基因频率列名。默认为\"eaf\"。 effect_allele_col 必填，效应等位基因列名。仅应包含字符\"\", \"C\", \"T\"或\"G\"。默认为\"effect_allele\"。 other_allele_col 必填，非效应等位基因列名。仅应包含字符\"\", \"C\", \"T\"或\"G\"。默认为\"other_allele\"。 pval_col 必填，统计学差异显著性检验指标p值列名。默认为\"pval\"。 units_col 可选的列名，表示单位。默认为\"units\"。 ncase_col 可选的列名，表示病例数。默认为\"ncase\"。 ncontrol_col 可选的列名，表示对照数。默认为\"ncontrol\"。 samplesize_col 可选的列名，表示样本量。默认为\"samplesize\"。 gene_col 可选的列名，表示基因名称。默认为\"gene\"。 id_col 列名，默认为\"id\"。 min_pval 允许的最小p值。默认为1e-200。 z_col 列名，默认为\"z\"。 info_col 列名，默认为\"info_col\"。 chr_col 列名，默认为\"chr_col\"。 pos_col 列名，默认为\"pos\"。 log_pval 指定p值是否为-log10(P)。默认为FALSE。 Twosample_dat 指定是否保存TwosampleMR数据文件，默认为FALSE。 SMR_dat 指定是否保存SMR数据文件，默认为FALSE。 MTAG_dat TRUE或FALSE，是否保存MTAG分析输入数据文件，默认为FALSE。 METAL_dat 指定是否保存metal分析输入数据文件，默认为FALSE。 GWAS_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"数据格式转换与清洗 — format_dat","text":"Twosample格式数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_Catalog.html","id":null,"dir":"Reference","previous_headings":"","what":"将GWAS Catalog数据库.gz或.tsv文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_Catalog","title":"将GWAS Catalog数据库.gz或.tsv文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_Catalog","text":"GWAS Catalog官网：https://www.ebi.ac.uk/gwas/home，请不要修改下载后的文件名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_Catalog.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将GWAS Catalog数据库.gz或.tsv文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_Catalog","text":"","code":"format_data_Catalog(   GWASfile = \" \",   GWAS_name = \" \",   type = \"outcome\",   snp_col = \"variant_id\",   beta_col = \"beta\",   se_col = \"standard_error\",   eaf_col = \"effect_allele_frequency\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"p_value\",   chr_col = \"chromosome\",   pos_col = \"base_pair_location\",   samplesize,   min_pval = 1e-200,   get_SNP = FALSE,   build = NULL,   save_path = \"./\",   Twosample_dat = TRUE,   SMR_dat = TRUE,   MTAG_dat = TRUE,   METAL_dat = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_Catalog.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将GWAS Catalog数据库.gz或.tsv文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_Catalog","text":"GWASfile 指定GWAS Catalog数据库.gz或.tsv文件的路径。 GWAS_name 指定输出文件名称。 type Twosample数据类型，\"exposure\"或\"outcome\"，默认为\"outcome\"。 snp_col 必填，SNP列的名称，默认为\"variant_id\"，如果需要get_SNP，建议填写\"SNP\"。 beta_col 必填，Beta值列的名称，默认为\"beta\"。 se_col 必填，标准误列的名称，默认为\"standard_error\"。 eaf_col 非必填，效应等位基因频率列的名称，默认为\"effect_allele_frequency\"。 effect_allele_col 必填，效应等位基因列的名称，默认为\"effect_allele\"。 other_allele_col 必填，次要等位基因列的名称，默认为\"other_allele\"。 pval_col 必填，P值列的名称，默认为\"p_value\"。 chr_col 必填，染色体列的名称，默认为\"chromosome\"。 pos_col 必填，坐标列的名称，默认为\"base_pair_location\"。 samplesize 必填，数值，指定GWAS数据的总样本量。 min_pval 允许的最小p值。默认为1e-200。 get_SNP TRUE或FALSE，是否将chrpos转换成SNP，默认为FALSE。 build get_SNP=TRUE时，需要指定GWAS的人类参考基因组版本，37或38，默认为NULL，则根据文件名获取基因组版本。 save_path 指定输出文件将保存的目录，默认为当前工作路径下。 Twosample_dat TRUE或FALSE，是否保存TwosampleMR数据文件，默认为TRUE。 SMR_dat TRUE或FALSE，是否保存SMR数据文件，默认为TRUE。 MTAG_dat TRUE或FALSE，是否保存MTAG分析输入数据文件，默认为TRUE。 METAL_dat TRUE或FALSE，是否保存metal分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_Catalog.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将GWAS Catalog数据库.gz或.tsv文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_Catalog","text":"TwosampleMR格式数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_decode.html","id":null,"dir":"Reference","previous_headings":"","what":"将decode原始数据txt.gz文件重注释转换为标准TwosampleMR、SMR、coloc共定位文件 — format_data_decode","title":"将decode原始数据txt.gz文件重注释转换为标准TwosampleMR、SMR、coloc共定位文件 — format_data_decode","text":"注意：此功能将重新注释原始数据！","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_decode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将decode原始数据txt.gz文件重注释转换为标准TwosampleMR、SMR、coloc共定位文件 — format_data_decode","text":"","code":"format_data_decode(   GWASfile = \" \",   assocvariants_file = \"assocvariants.annotated.txt.gz\",   cis_wind_kb = 1000,   build = 38,   save_path = \"./\",   type = \"outcome\",   Twosample_dat = TRUE,   coloc_dat = TRUE,   SMR_data = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_decode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将decode原始数据txt.gz文件重注释转换为标准TwosampleMR、SMR、coloc共定位文件 — format_data_decode","text":"GWASfile 指定decode数据原始文件txt.gz文件的路径。 assocvariants_file decode数据注释文件。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 build 37或38，人类参考基因组版本，默认38。 save_path 指定输出文件将保存的目录，默认当前工作路径下。 type Twosample数据类型，\"exposure\"或\"outcome\"默认为\"outcome\"。 Twosample_dat TRUE或FALSE，是否保存TwosampleMR数据文件，默认为TRUE。 coloc_dat TRUE或FALSE，是否保存coloc共定位数据文件，默认为TRUE。 SMR_data TRUE或FALSE，是否保存SMR分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_decode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将decode原始数据txt.gz文件重注释转换为标准TwosampleMR、SMR、coloc共定位文件 — format_data_decode","text":"TwosampleMR格式数据或coloc共定位数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_fenland.html","id":null,"dir":"Reference","previous_headings":"","what":"将fenland pQTL原始数据txt.gz文件为标准TwosampleMR、SMR、coloc共定位文件 — format_data_fenland","title":"将fenland pQTL原始数据txt.gz文件为标准TwosampleMR、SMR、coloc共定位文件 — format_data_fenland","text":"将原始数据进行格式转换。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_fenland.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将fenland pQTL原始数据txt.gz文件为标准TwosampleMR、SMR、coloc共定位文件 — format_data_fenland","text":"","code":"format_data_fenland(   GWASfile = \" \",   cis_wind_kb = 1000,   build = 37,   save_path = \"./\",   type = \"outcome\",   Twosample_dat = TRUE,   coloc_dat = TRUE,   SMR_data = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_fenland.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将fenland pQTL原始数据txt.gz文件为标准TwosampleMR、SMR、coloc共定位文件 — format_data_fenland","text":"GWASfile 指定fenland数据原始文件txt.gz文件的路径。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 build 37或38，人类参考基因组版本，默认37。 save_path 指定输出文件将保存的目录，默认当前工作路径下。 type Twosample数据类型，\"exposure\"或\"outcome\"默认为\"outcome\"。 Twosample_dat TRUE或FALSE，是否保存TwosampleMR数据文件，默认为TRUE。 coloc_dat TRUE或FALSE，是否保存coloc共定位数据文件，默认为TRUE。 SMR_data TRUE或FALSE，是否保存SMR分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_fenland.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将fenland pQTL原始数据txt.gz文件为标准TwosampleMR、SMR、coloc共定位文件 — format_data_fenland","text":"TwosampleMR格式数据或coloc共定位数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_FinnGen.html","id":null,"dir":"Reference","previous_headings":"","what":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_FinnGen","title":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_FinnGen","text":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_FinnGen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_FinnGen","text":"","code":"format_data_FinnGen(   GWASfile = \" \",   GWAS_name = \" \",   save_path = \"./\",   type = \"outcome\",   min_pval = 1e-200,   build_to_hg19 = FALSE,   Twosample_dat = TRUE,   SMR_dat = TRUE,   MTAG_dat = TRUE,   METAL_dat = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_FinnGen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_FinnGen","text":"GWASfile 指定FinnGen数据库.gz文件的路径。 GWAS_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下。 type Twosample数据类型，\"exposure\"或\"outcome\"，默认为\"outcome\"。 min_pval 允许的最小p值。默认为1e-200。 build_to_hg19 TRUE或FALSE，是否使用liftover函数将GRCh38转换成GRCh37，默认为FALSE。 Twosample_dat TRUE或FALSE，是否保存TwosampleMR数据文件，默认为TRUE。 SMR_dat TRUE或FALSE，是否保存SMR数据文件，默认为TRUE。 MTAG_dat TRUE或FALSE，是否保存MTAG分析输入数据文件，默认为TRUE。 METAL_dat TRUE或FALSE，是否保存metal分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_FinnGen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_FinnGen","text":"TwosampleMR格式数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_FinnGen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"将FinnGen数据库.gz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_FinnGen","text":"此函数读取FinnGen数据库.gz文件，格式化的数据保存为TwosampleMR和SMR格式的文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_IEU_VCF.html","id":null,"dir":"Reference","previous_headings":"","what":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_IEU_VCF","title":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_IEU_VCF","text":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_IEU_VCF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_IEU_VCF","text":"","code":"format_data_IEU_VCF(   IEU_VCF = \"ieu-a-30.vcf.gz\",   type = \"outcome\",   ncase = NA,   ncontrol = NA,   samplesize,   min_pval = 1e-200,   Twosample_dat = TRUE,   SMR_dat = TRUE,   MTAG_dat = TRUE,   METAL_dat = TRUE,   save_name = \"CD\",   save_path = \"./CD\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_IEU_VCF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_IEU_VCF","text":"IEU_VCF IEU数据库的id号或.VCF本地文件路径。 type Twosample数据类型，\"exposure\"或\"outcome\"，默认为\"outcome\"。 ncase 选填，病例组样本量，连续型GWAS数据的中的病例组样本量，填NA。 ncontrol 选填，对照组样本量，连续型GWAS数据的中的对照组样本量，填NA。 samplesize 必填，GWAS总样本量。 min_pval 允许的最小p值。默认为1e-200。 Twosample_dat TRUE或FALSE，是否保存TwosampleMR数据文件，默认为TRUE。 SMR_dat TRUE或FALSE，是否保存SMR数据文件，默认为TRUE。 MTAG_dat TRUE或FALSE，是否保存MTAG分析输入数据文件，默认为TRUE。 METAL_dat TRUE或FALSE，是否保存metal分析输入数据文件，默认为TRUE。 save_name 保存的文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_IEU_VCF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_IEU_VCF","text":"TwosampleMR格式数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_IEU_VCF.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"在线或本地读取IEU数据库.VCF文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_IEU_VCF","text":"此函数读取IEU数据库.VCF文件，格式化的数据保存为TwosampleMR、SMR、METAL格式的文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_METAL.html","id":null,"dir":"Reference","previous_headings":"","what":"将METAL分析结果数据转换为标准TwosampleMR、SMR文件 — format_data_METAL","title":"将METAL分析结果数据转换为标准TwosampleMR、SMR文件 — format_data_METAL","text":"此函数METAL分析结果数据，格式化的数据保存为标准TwosampleMR、SMR文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_METAL.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将METAL分析结果数据转换为标准TwosampleMR、SMR文件 — format_data_METAL","text":"","code":"format_data_METAL(   GWASfile = \" \",   type = \"outcome\",   samplesize,   IVW_mode = \"Multiplicative\",   min_pval = 1e-200,   Twosample_dat = TRUE,   SMR_dat = TRUE,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_METAL.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将METAL分析结果数据转换为标准TwosampleMR、SMR文件 — format_data_METAL","text":"GWASfile 指定METAL分析结果数据文件的路径。 type Twosample数据类型，\"exposure\"或\"outcome\"默认为\"outcome\"。 samplesize 多个队列meta分析的总样本量。 IVW_mode 逆方差加权法-IVW分析模式，固定效应模型:\"Fixed\"，随机效应模型:\"Multiplicative\"或\"Additive\"。 min_pval 允许的最小p值。默认为1e-200。 Twosample_dat TRUE或FALSE，是否保存Twosample数据文件。默认为TRUE。 SMR_dat TRUE或FALSE，是否保存SMR数据文件。默认为TRUE。 save_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_METAL.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将METAL分析结果数据转换为标准TwosampleMR、SMR文件 — format_data_METAL","text":"TwosampleMR格式数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_Neale.html","id":null,"dir":"Reference","previous_headings":"","what":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_ukb_Neale","title":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_ukb_Neale","text":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_Neale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_ukb_Neale","text":"","code":"format_data_ukb_Neale(   GWASfile = \" \",   variants_ref = \" \",   GWAS_name = \" \",   save_path = \"./\",   type = \"outcome\",   min_pval = 1e-200,   low_confidence_SNP = FALSE,   Twosample_dat = TRUE,   SMR_dat = TRUE,   MTAG_dat = TRUE,   METAL_dat = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_Neale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_ukb_Neale","text":"GWASfile 指定ukb nealelab数据库tsv.bgz文件的路径。 variants_ref SNP注释文件路径。 GWAS_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下。 type Twosample数据类型，\"exposure\"或\"outcome\"默认为\"outcome\"。 min_pval 允许的最小p值。默认为1e-200。 low_confidence_SNP TRUE或FALSE，是否过滤low confidence variant，默认为FALSE。 Twosample_dat TRUE或FALSE，是否保存TwosampleMR数据文件,默认为TRUE。 SMR_dat TRUE或FALSE，是否保存SMR数据文件，默认为TRUE。 MTAG_dat TRUE或FALSE，是否保存MTAG分析输入数据文件，默认为TRUE。 METAL_dat TRUE或FALSE，是否保存meta分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_Neale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_ukb_Neale","text":"TwosampleMR格式数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_Neale.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"将ukb nealelab数据库tsv.bgz文件转换为标准TwosampleMR、SMR、METAL、MTAG分析文件 — format_data_ukb_Neale","text":"此函数读取ukb nealelab数据库tsv.bgz文件，格式化的数据保存为TwosampleMR、SMR、METAL、MTAG格式的文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_pQTL_cis.html","id":null,"dir":"Reference","previous_headings":"","what":"将ukb_ppp基因所在染色体的数据.gz文件重注释转换为标准SMR、coloc共定位文件 — format_data_ukb_pQTL_cis","title":"将ukb_ppp基因所在染色体的数据.gz文件重注释转换为标准SMR、coloc共定位文件 — format_data_ukb_pQTL_cis","text":"此功能将提取ukb_ppp的顺式pQTL数据！","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_pQTL_cis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将ukb_ppp基因所在染色体的数据.gz文件重注释转换为标准SMR、coloc共定位文件 — format_data_ukb_pQTL_cis","text":"","code":"format_data_ukb_pQTL_cis(   GWASfile = \"discovery_chr1_ACADM_P11310_OID31277_v1_Oncology_II.gz\",   assocvariants_file = \"olink_rsid_map_mac5_info03_b0_7_chr1_patched_v2.tsv.gz\",   cis_wind_kb = 1000,   build = 38,   SMR_data = TRUE,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_pQTL_cis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将ukb_ppp基因所在染色体的数据.gz文件重注释转换为标准SMR、coloc共定位文件 — format_data_ukb_pQTL_cis","text":"GWASfile ukb_ppp基因所在染色体的数据.gz文件的路径，原始数据文件解压所得。 assocvariants_file ukb_ppp基因所在染色体的数据的注释文件。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 build 37或38，人类参考基因组版本，默认38。 SMR_data TRUE或FALSE，是否保存SMR分析输入数据文件，默认为TRUE。 save_path 指定输出文件将保存的目录，默认当前工作路径下。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/format_data_ukb_pQTL_cis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将ukb_ppp基因所在染色体的数据.gz文件重注释转换为标准SMR、coloc共定位文件 — format_data_ukb_pQTL_cis","text":"顺式pQTL数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GCTA_fastBAT.html","id":null,"dir":"Reference","previous_headings":"","what":"基于GCTA_fastBAT的gene-based关联分析研究 — GCTA_fastBAT","title":"基于GCTA_fastBAT的gene-based关联分析研究 — GCTA_fastBAT","text":"该函数用于执行GCTA软件包中的FastBAT分析，基于给定的GWAS数据文件和基因列表文件，进行快速的基因-表型关联分析，详见：https://yanglab.westlake.edu.cn/software/gcta/#fastBAT。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GCTA_fastBAT.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"基于GCTA_fastBAT的gene-based关联分析研究 — GCTA_fastBAT","text":"","code":"GCTA_fastBAT(   GWSAfile = \"./Migraine_SMR_FinnGen.ma\",   bfile = \"./1.data/1000G/EUR\",   gene_list = \"./glist-hg38\",   maf = 0.01,   cores = 6,   opt_arguments = NULL,   save_name = \"Migraine\",   save_path = \"fastBAT\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/GCTA_fastBAT.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"基于GCTA_fastBAT的gene-based关联分析研究 — GCTA_fastBAT","text":"GWSAfile 字符串，指定输入.ma格式的GWAS结果文件路径（如：Migraine_SMR_FinnGen.ma）。 bfile 字符串，进行基因型数据的连锁不平衡（LD）估计时的参考面板文件的前缀路径（如：./1.data/1000G/EUR）。 gene_list 字符串，指定基因列表文件的路径（如：./glist-hg38）。 maf 数值，指定过滤的最小等位基因频率（MAF），默认值为0.01。 cores 数值，指定要使用的CPU线程数量，默认值为2。 opt_arguments 字符串或NULL，额外的命令行参数，用于GCTA的FastBAT分析（默认为NULL）。 save_name 字符串，指定输出结果文件的名称。 save_path 字符串，指定结果文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GCTA_fastBAT.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"基于GCTA_fastBAT的gene-based关联分析研究 — GCTA_fastBAT","text":"返回.gene.fbat结果，结果文件包含以下内容： Gene 基因ID Chr 染色体编号 Start End 基因区域的左侧和右侧边界 .SNPs 基因区域内的SNP数量 SNP_start SNP_end 基因区域的左侧和右侧边界SNP位置 Chisq(Obs) 基因区域内所有SNP的卡方检验统计量之和 Pvalue 基因水平的检验p值 TopSNP.Pvalue 基因区域内最小的单个SNP GWAS p值 TopSNP 与基因关联的最显著GWAS SNP","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GCTA_fastBAT.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"基于GCTA_fastBAT的gene-based关联分析研究 — GCTA_fastBAT","text":"该方法利用全基因组关联研究（GWAS）的汇总数据和来自参考样本的个体级基因型数据的连锁不平衡（LD）数据， 执行人类复杂性状的快速集合关联分析。有关该方法的详细信息，请参阅Bakshi等人（2016年，Scientific Reports）的研究，PMID: 27604177。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_ensembl.html","id":null,"dir":"Reference","previous_headings":"","what":"从ensembl数据库中获取基因的信息 — Gene_start_end_info_ensembl","title":"从ensembl数据库中获取基因的信息 — Gene_start_end_info_ensembl","text":"从ensembl数据库中获取基因的信息","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_ensembl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"从ensembl数据库中获取基因的信息 — Gene_start_end_info_ensembl","text":"","code":"Gene_start_end_info_ensembl(gene_id)"},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_ensembl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"从ensembl数据库中获取基因的信息 — Gene_start_end_info_ensembl","text":"gene_id 基因名称或ENSG ID。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_ensembl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"从ensembl数据库中获取基因的信息 — Gene_start_end_info_ensembl","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_GTF.html","id":null,"dir":"Reference","previous_headings":"","what":"从gencodegenes的gtf.gz原始数据获取基因信息 — Gene_start_end_info_GTF","title":"从gencodegenes的gtf.gz原始数据获取基因信息 — Gene_start_end_info_GTF","text":"gtf.gz原始数据下载官网：https://www.gencodegenes.org/human/#","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_GTF.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"从gencodegenes的gtf.gz原始数据获取基因信息 — Gene_start_end_info_GTF","text":"","code":"Gene_start_end_info_GTF(   GTF_file = \"./inputdata/gencode.v19.chr_patch_hapl_scaff.annotation.gtf.gz\",   save_name = \"GRCh37\",   save_path = \"./outdata/GRCh37\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_GTF.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"从gencodegenes的gtf.gz原始数据获取基因信息 — Gene_start_end_info_GTF","text":"GTF_file 基因注释原始gtf.gz文件路径。 save_name 指定输出文件名称。 save_path 指定输出文件将保存的路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_GTF.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"从gencodegenes的gtf.gz原始数据获取基因信息 — Gene_start_end_info_GTF","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_modified.html","id":null,"dir":"Reference","previous_headings":"","what":"从内置数据中获取Ensembl id与Gene汇总信息数据 — Gene_start_end_info_modified","title":"从内置数据中获取Ensembl id与Gene汇总信息数据 — Gene_start_end_info_modified","text":"从内置数据中获取Ensembl id与Gene汇总信息数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_modified.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"从内置数据中获取Ensembl id与Gene汇总信息数据 — Gene_start_end_info_modified","text":"","code":"Gene_start_end_info_modified(build = 38)"},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_modified.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"从内置数据中获取Ensembl id与Gene汇总信息数据 — Gene_start_end_info_modified","text":"build 37或38，人类参考基因组版本，默认38。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Gene_start_end_info_modified.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"从内置数据中获取Ensembl id与Gene汇总信息数据 — Gene_start_end_info_modified","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_eQTLGen_Online.html","id":null,"dir":"Reference","previous_headings":"","what":"在线从IEU数据库获取的eQTLGen顺式eQTL数据 — get_ciseQTL_eQTLGen_Online","title":"在线从IEU数据库获取的eQTLGen顺式eQTL数据 — get_ciseQTL_eQTLGen_Online","text":"在线从IEU数据库获取的eQTLGen顺式eQTL数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_eQTLGen_Online.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"在线从IEU数据库获取的eQTLGen顺式eQTL数据 — get_ciseQTL_eQTLGen_Online","text":"","code":"get_ciseQTL_eQTLGen_Online(IEU_id = \" \", cis_wind_kb = 1000, save_path = \"./\")"},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_eQTLGen_Online.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"在线从IEU数据库获取的eQTLGen顺式eQTL数据 — get_ciseQTL_eQTLGen_Online","text":"IEU_id IEU数据库eqtl--的id号。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 save_path 指定输出文件将保存的目录，默认当前工作路径下。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_GTEx_V8_Online.html","id":null,"dir":"Reference","previous_headings":"","what":"在线获取GTEx_V8顺式eqtl数据 — get_ciseQTL_GTEx_V8_Online","title":"在线获取GTEx_V8顺式eqtl数据 — get_ciseQTL_GTEx_V8_Online","text":"在线获取GTEx_V8顺式eqtl数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_GTEx_V8_Online.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"在线获取GTEx_V8顺式eqtl数据 — get_ciseQTL_GTEx_V8_Online","text":"","code":"get_ciseQTL_GTEx_V8_Online(   Gene_name = \"PCSK9\",   tissues = \"Whole Blood\",   cis_wind_kb = 1000,   build = 38,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_GTEx_V8_Online.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"在线获取GTEx_V8顺式eqtl数据 — get_ciseQTL_GTEx_V8_Online","text":"Gene_name 要分析的基因名称。 tissues eqtl数据来源GTEx_V8的组织类型，默认是全血\"Whole Blood\"。 cis_wind_kb 指定顺式eQTL的上下游范围，默认1000kb，即1MB。 build 37或38，人类参考基因组版本，默认38。 save_path 基因eqtl数据保存路径，默认为当前文件夹\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_ciseQTL_GTEx_V8_Online.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"在线获取GTEx_V8顺式eqtl数据 — get_ciseQTL_GTEx_V8_Online","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_decode_ukb_Online.html","id":null,"dir":"Reference","previous_headings":"","what":"在线获取","title":"在线获取","text":"在线获取\"decode\"或\"ukb_ppp\"的顺式pQTL数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_decode_ukb_Online.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"在线获取","text":"","code":"get_cispQTL_decode_ukb_Online(   gene = \" \",   gene_ID = \" \",   resource = \" \",   cis_wind_kb = 1000,   build = 38,   save_name = \" \",   save_path = \"./\",   SMR_data = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_decode_ukb_Online.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"在线获取","text":"gene 基因名称或Ensemblid。 gene_ID decode数据的SomaScan ID或ukb_ppp的OlinkID，分别通过函数data_info_decode_pQTL()、data_info_ukb_ppp_pQTL()查询。 resource pQTL数据来源，\"decode\"或\"ukb_ppp\"。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。。 build 37或38，人类参考基因组版本，默认38。 save_name 分析结果文件名，建议设置为基因名。 save_path 基因pQTL数据保存路径，默认为当前文件夹\"./\"。 SMR_data TRUE或FALSE，是否保存SMR分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_decode_ukb_Online.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"在线获取","text":"顺式pQTL数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_fenland_Online.html","id":null,"dir":"Reference","previous_headings":"","what":"在线获取fenland的顺式pQTL数据 — get_cispQTL_fenland_Online","title":"在线获取fenland的顺式pQTL数据 — get_cispQTL_fenland_Online","text":"在线获取fenland的顺式pQTL数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_fenland_Online.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"在线获取fenland的顺式pQTL数据 — get_cispQTL_fenland_Online","text":"","code":"get_cispQTL_fenland_Online(   gene = \" \",   SomaScan_ids = \" \",   cis_wind_kb = 1000,   build = 37,   save_name = \" \",   save_path = \"./\",   SMR_data = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_fenland_Online.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"在线获取fenland的顺式pQTL数据 — get_cispQTL_fenland_Online","text":"gene 基因名称或Ensemblid。 SomaScan_ids SomaScan的ID号，通过函数data_info_fenland_pQTL()查询。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 build 37或38，人类参考基因组版本，默认37。 save_name 分析结果文件名，建议设置为基因名。 save_path 基因pQTL数据保存路径，默认为当前文件夹\"./\"。 SMR_data TRUE或FALSE，是否保存SMR分析输入数据文件，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_cispQTL_fenland_Online.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"在线获取fenland的顺式pQTL数据 — get_cispQTL_fenland_Online","text":"顺式pQTL数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_Drugs_gene_IVs.html","id":null,"dir":"Reference","previous_headings":"","what":"获取传统药靶基因工具变量 — get_Drugs_gene_IVs","title":"获取传统药靶基因工具变量 — get_Drugs_gene_IVs","text":"获取传统药靶基因工具变量","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_Drugs_gene_IVs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"获取传统药靶基因工具变量 — get_Drugs_gene_IVs","text":"","code":"get_Drugs_gene_IVs(   GWASfile = \"ieu-b-110\",   gene_id = \"PCSK9\",   wind_kb = 100,   clump_pval = 5e-08,   clump_kb = 100,   clump_r2 = 0.3,   min_eaf = 0.01,   build = 37,   pop = \"EUR\",   bfile_1000G = NULL )"},{"path":"https://hortoner.github.io/QTLMR/reference/get_Drugs_gene_IVs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"获取传统药靶基因工具变量 — get_Drugs_gene_IVs","text":"GWASfile Twosample格式的完整数据文件路径或IEU Open GWAS数据库id。 gene_id 特定药物靶基因名称或基因Ensembl id。 wind_kb 特定药物靶基因在GWAS中的编码起始上下游区域范围，默认100kb，即100000bp。 clump_pval GWAS的显著性P值的过滤阈值，默认为5e-8。 clump_kb 连锁不平衡窗口大小范围，默认值为100kb。 clump_r2 连锁不平衡系数r2大小，默认值为0.3。 min_eaf 效应等位基因频率过滤阈值，默认0.01。 build 37或38，GWASfile的人类参考基因组版本，默认37。 pop 人群种族，默认为\"EUR\"，在线方式去除连锁不平衡时需要填写。 bfile_1000G NULL表示使用在线方式，本地方式请填写1000G基因型数据文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_Drugs_gene_IVs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"获取传统药靶基因工具变量 — get_Drugs_gene_IVs","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_EAF_local.html","id":null,"dir":"Reference","previous_headings":"","what":"本地文件获取EAF值（不推荐） — get_EAF_local","title":"本地文件获取EAF值（不推荐） — get_EAF_local","text":"本地方法快速获取EAF值,无需联网。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_EAF_local.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"本地文件获取EAF值（不推荐） — get_EAF_local","text":"","code":"get_EAF_local(dat, frq_path = \" \", type = \"exposure\")"},{"path":"https://hortoner.github.io/QTLMR/reference/get_EAF_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"本地文件获取EAF值（不推荐） — get_EAF_local","text":"dat Twosample格式的暴露或者结局数据。 frq_path fileFrequency.frq参考文件路径。 type 数据类型,\"exposure\"或者\"outcome\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/get_EAF_local.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"本地文件获取EAF值（不推荐） — get_EAF_local","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_py_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置GNOVA软件环境 — GNOVA_py_install","title":"配置GNOVA软件环境 — GNOVA_py_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_py_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置GNOVA软件环境 — GNOVA_py_install","text":"","code":"GNOVA_py_install(install_pip = TRUE, force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_py_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置GNOVA软件环境 — GNOVA_py_install","text":"install_pip TRUE或FALSE，是否安装pip，默认TRUE。 force TRUE或FALSE，是否重新安装GNOVA软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_run.html","id":null,"dir":"Reference","previous_headings":"","what":"使用GNOVA进行遗传协方差分析 — GNOVA_run","title":"使用GNOVA进行遗传协方差分析 — GNOVA_run","text":"该函数用于调用GNOVA进行遗传协方差分析，官网地址：https://github.com/xtonyjiang/GNOVA。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用GNOVA进行遗传协方差分析 — GNOVA_run","text":"","code":"GNOVA_run(   test_help = FALSE,   Sumstatsfile = c(\"./Frailty.sumstats.gz\", \"./Insomnia.sumstats.gz\"),   N1 = NULL,   N2 = NULL,   bfile = \"./1000G.EUR.QC.@\",   annot = NULL,   opt_arguments = NULL,   save_name = \"results\",   save_path = \"./GNOVA\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用GNOVA进行遗传协方差分析 — GNOVA_run","text":"test_help 是否显示帮助信息 (默认：FALSE)。 Sumstatsfile 包含两个GWAS总结统计数据.sumstats.gz格式文件路径的字符向量文件路径。 N1 第一个总结统计文件的样本量 (默认：NULL)。 N2 第二个总结统计文件的样本量 (默认：NULL)。 bfile Plink格式的基因型数据文件名前缀路径，包含\".bed\"、\".bim\"、\".fam\"三个文件。 annot 注释文件的路径，如果进行注释分层分析需要提供该参数。 opt_arguments 其他可选参数，可以在此处提供额外的命令行参数。 save_name 保存结果的文件名，默认：\"results\"。 save_path 结果文件保存路径，默认：\"./GNOVA\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GNOVA_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用GNOVA进行遗传协方差分析 — GNOVA_run","text":"返回一个数据框，包含以下字段： annot_name: 注释的名称。 rho: 遗传协方差估计值。 rho_corrected: 经过样本重叠校正后的遗传协方差估计值。 se_rho: 遗传协方差估计值的标准误。 pvalue: 遗传协方差的统计检验p值。 pvalue_corrected: 经过样本重叠校正后的遗传协方差统计检验p值。 corr: 遗传相关性估计值。 corr_corrected: 经过样本重叠校正后的遗传相关性估计值。 h2_1: 第一个表型的遗传力估计值。 h2_2: 第二个表型的遗传力估计值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GSMR2_QTLMR.html","id":null,"dir":"Reference","previous_headings":"","what":"使用GSMR基于广义汇总数据的孟德尔随机化分析 — GSMR2_QTLMR","title":"使用GSMR基于广义汇总数据的孟德尔随机化分析 — GSMR2_QTLMR","text":"官网：https://yanglab.westlake.edu.cn/software/gsmr/，GSMR（广义汇总数据孟德尔随机化分析）是一种灵活且强大的方法，利用多个遗传工具，通过来自独立全基因组关联研究（GWAS）的汇总数据，检测风险因素与疾病之间的因果关联。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GSMR2_QTLMR.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用GSMR基于广义汇总数据的孟德尔随机化分析 — GSMR2_QTLMR","text":"","code":"GSMR2_QTLMR(   exposurefile = \"./2.pre_data/ukb-b-3957_TwosampleMR_IEU.txt\",   exposure_name = \"ukb\",   outcomefile = \"./2.pre_data/GCST90020053_TwosampleMR_Catalog.txt\",   outcome_name = \"Catalog\",   bfile_1000G = \"G:/QTLMR_test/1000G/EUR\",   n_ref = 503,   gwas_thresh = 5e-08,   heidi_outlier_flag = TRUE,   single_snp_heidi_thresh = 0.01,   multi_snps_heidi_thresh = 0.01,   nsnps_thresh = 10,   ld_r2_thresh = 0.05,   ld_fdr_thresh = 0.05,   gsmr2_beta = FALSE,   GSMR_plot = TRUE,   width = 6,   height = 5,   suppressWarnings = TRUE,   Bi_GSMR = TRUE,   save_name = \"GSMR2\",   save_path = \"./GSMR2\",   thread_num = 10 )"},{"path":"https://hortoner.github.io/QTLMR/reference/GSMR2_QTLMR.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用GSMR基于广义汇总数据的孟德尔随机化分析 — GSMR2_QTLMR","text":"exposurefile Twosample格式的完整暴露数据文件路径。 exposure_name 暴露性状的名称。 outcomefile Twosample格式的完整结局数据文件路径。 outcome_name 结局性状的名称。 bfile_1000G 参考面板数据文件路径。 n_ref 参考面板数据的样本量。 gwas_thresh 用于选择GWAS中工具变量SNP的p值显著阈值。 heidi_outlier_flag TRUE或FALSE，是否进行HEIDI异常值分析。 single_snp_heidi_thresh 单个SNP的HEIDI异常值分析的p值阈值。 multi_snps_heidi_thresh 多个SNP的HEIDI异常值分析的p值阈值。 nsnps_thresh GSMR分析所需的最小工具数（建议不要将该值设置为小于10）。 ld_r2_thresh 用于移除高LD SNP的LD r2阈值。 ld_fdr_thresh 用于移除SNP工具间偶然相关性的FDR阈值。 gsmr2_beta TRUE或FALSE，GSMR2测试版，包含一个新的HEIDI异常值方法（用于GSMR分析）。FALSE - 原始HEIDI异常值方法，TRUE - 新的HEIDI异常值方法。 GSMR_plot TRUE或FALSE，是否绘制GSMR结果数据图。 width 绘制生成的PDF宽度。 height 绘制生成的PDF高度。 suppressWarnings TRUE或FALSE，是否抑制GSMR警告信息提示。 Bi_GSMR TRUE或FALSE，是否进行双向GSMR分析。 save_name 保存结果文件的名称。 save_path 保存的结果文件路径。 thread_num GCTA并行运行线程数量。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GSMR2_QTLMR.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用GSMR基于广义汇总数据的孟德尔随机化分析 — GSMR2_QTLMR","text":"GSMR分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GWAS_liftover.html","id":null,"dir":"Reference","previous_headings":"","what":"使用liftover转换GWAS数据的基因组版本 — GWAS_liftover","title":"使用liftover转换GWAS数据的基因组版本 — GWAS_liftover","text":"参数详见函数MungeSumstats::liftover。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GWAS_liftover.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用liftover转换GWAS数据的基因组版本 — GWAS_liftover","text":"","code":"GWAS_liftover(   GWAS,   build_from = \"hg38\",   build_to = \"hg19\",   chain_file = NULL,   chain_source = \"ensembl\",   imputation_ind = FALSE,   chrom_col = \"CHR\",   start_col = \"BP\",   as_granges = FALSE,   style = \"NCBI\",   verbose = TRUE,   save_name = \"liftover_GWAS\",   save_path = NULL )"},{"path":"https://hortoner.github.io/QTLMR/reference/GWAS_liftover.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用liftover转换GWAS数据的基因组版本 — GWAS_liftover","text":"GWAS 环境变量中的GWAS数据。 build_from GWAS数据的版本，支持\"GRCh38/hg38\"或\"GRCh37/hg19\"。 build_to 转换后的GWAS数据版本，支持\"GRCh38/hg38\"或\"GRCh37/hg19\"。 chain_file 链文件路径，用于基因组版本转换，例如\"./GRCh38_to_GRCh37.chain\"。默认为NULL时，则自动下载。 chain_source 链文件来源，可选\"ensembl\"或\"ucsc\"，默认为\"ensembl\"。 imputation_ind 是否对丢失的位置信息进行插补，默认为FALSE。 chrom_col GWAS数据中染色体列的列名，默认为\"CHR\"。 start_col GWAS数据中起始位点列的列名，默认为\"BP\"。 as_granges 是否返回GRanges对象，默认为FALSE。 style 输出数据的基因组风格，支持\"NCBI\"或\"UCSC\"，默认为\"NCBI\"。 verbose 是否打印详细信息，默认为TRUE。 save_name 分析结果保存文件名。 save_path 分析结果保存路径，默认NULL，则不保存文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/GWAS_liftover.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用liftover转换GWAS数据的基因组版本 — GWAS_liftover","text":"转换后的GWAS数据，数据格式与输入一致。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"该函数基于GWAS汇总统计数据返回单一性状的SNP遗传力估计值及其标准误。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"","code":"HDL_h2(   GWASfile = \" \",   LD.path = \" \",   Nref = 335265,   eigen.cut = \"automatic\",   intercept.output = FALSE,   fill.missing.N = NULL,   lim = exp(-18),   save_name = \"h2\",   save_path = \"./HDL\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"GWASfile 字符型，MTAG格式数据文件路径，可由format_dat()函数转换获得。 LD.path 存储连锁不平衡（LD）信息的目录路径。 Nref 用于计算LD的参考样本的样本量。如果使用默认的UK Biobank参考样本，则Nref = 335265。 eigen.cut 用于HDL的LD分数矩阵中的特征值和特征向量。用户可指定0到1之间的数值。例如，eigen.cut = 0.99表示使用解释99％方差的主特征值及其对应的特征向量。如果使用默认的“自动”选项，将选择能够提供最稳定遗传力估计的eigen.cut。 intercept.output 逻辑值，默认为FALSE。是否在estimates.df中包含截距项？ fill.missing.N 如果为NULL（默认值），则缺失N的SNP将被移除。可以指定“median”、“min”或“max”以填充缺失的N。例如，“median”表示使用有N值的SNP的中位数来填充缺失的N。 lim 公差限制，默认lim = exp(-18)。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"返回一个包含以下内容的列表： h2 估计的基于SNP的遗传力。 h2.se 估计的遗传力的标准误。 P 基于Wald检验的P值。 eigen.use 计算中使用的eigen.cut。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"用户可以下载欧洲血统人群的预计算LD相关矩阵特征值和特征向量。下载链接：https://github.com/zhenin/HDL/wiki/Reference-panels。以下是从335,265位英国UK Biobank个体中计算得到的LD矩阵及其特征值分解。提供三组参考面板： 1）1,029,876个经过质量控制的UK Biobank的HapMap3基因型填充SNP。解压后大小约为33 GB。尽管耗时较长，但使用填充的面板可提供更准确的遗传相关性估计。因此，如果GWAS包含大部分HapMap3 SNP，建议使用该填充参考面板。 2）769,306个经过质量控制的UK Biobank的HapMap2基因型填充SNP。解压后大小约为18 GB。如果您的GWAS包含大部分HapMap 2 SNP，但上述HapMap 3参考面板中缺少许多SNP（超过1％），则推荐使用该HapMap2面板进行HDL分析。 3）307,519个经过质量控制的UK Biobank Axiom Array SNP。解压后大小约为7.5 GB。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"Ning Z, Pawitan Y, Shen X. High-definition likelihood inference genetic correlations across human complex traits. Nat Genet. 2020 Aug;52(8):859-864.","code":""},{"path":[]},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_h2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"使用HDL包基于SNP的遗传力的高精度似然推断 — HDL_h2","text":"Zheng Ning, Xia Shen","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_L.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HDL包进行局部遗传相关性分析 — HDL_L","title":"使用HDL包进行局部遗传相关性分析 — HDL_L","text":"应用HDL方法计算两种性状之间的局部遗传相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_L.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HDL包进行局部遗传相关性分析 — HDL_L","text":"","code":"HDL_L(   GWASfile = c(\"./2.pre_data/Frailty_MTAG.txt\", \"./2.pre_data/Insomnia_MTAG.txt\"),   Trait1name = \"Trait1\",   Trait2name = \"Trait2\",   LD.path = \"G:/QTLMR_test/HDL/LD.path\",   bim.path = \"G:/QTLMR_test/HDL/bimfile\",   Nref = 335272,   N0 = NULL,   start_loc = NULL,   end_loc = NULL,   eigen.cut = 0.99,   intercept.output = FALSE,   fill.missing.N = NULL,   lim = exp(-18),   alpha = 0.05,   save_name = \"rg\",   save_path = \"./HDL\",   cores = 5 )"},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_L.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HDL包进行局部遗传相关性分析 — HDL_L","text":"GWASfile 包含两种性状GWAS汇总统计数据的MTAG格式文件路径向量。如 c(\"./2.pre_data/Frailty_MTAG.txt\", \"./2.pre_data/Insomnia_MTAG.txt\")。 Trait1name 性状1的名称。 Trait2name 性状2的名称。 LD.path 存放连锁不平衡（LD）信息的目录路径。LD数据用于计算LD矩阵。 bim.path 存放解压后的 bimfile.zip 文件的目录路径，用于LD计算。 Nref 参考样本的样本大小，用于计算LD矩阵。UKB生物库数据默认值为335272。若使用UKB-ppp cis-pQTL，样本量为 54219。 N0 用于遗传相关性估计的样本数量。若为NULL，默认使用两个GWAS数据集中的最小样本量。 start_loc 遗传相关性分析的起始位置（染色体区域），默认为NULL时，则对所有区域进行分析。 end_loc 遗传相关性分析的结束位置（染色体区域），默认为NULL时，则对所有区域进行分析。 eigen.cut 用于HDL方法计算时的特征值阈值。默认值为0.99。 intercept.output 是否输出截距项。默认为FALSE。 fill.missing.N 如何处理SNP的缺失样本量（N）。默认为NULL，表示删除缺失N的SNP。可以选择 \"median\"、\"min\" 或 \"max\" 进行填充。 lim 公差限制，用于控制计算精度。默认为 exp(-18)。 alpha 计算似然置信区间时的显著性水平。默认为0.05。 save_name 结果输出文件的前缀名称。 save_path 输出结果的保存路径。 cores 并行运行的线程数量。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_L.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HDL包进行局部遗传相关性分析 — HDL_L","text":"返回包含遗传相关性、遗传协方差、遗传力估计及其置信区间和p值的详细数据框。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_L.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"使用HDL包进行局部遗传相关性分析 — HDL_L","text":"Li, Y., Pawitan, Y., & Shen, X. enhanced framework local genetic correlation analysis. (2024)","code":""},{"path":[]},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_L.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"使用HDL包进行局部遗传相关性分析 — HDL_L","text":"Zheng Ning, Xia Shen","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"该函数基于GWAS汇总统计数据返回两个性状之间的遗传相关性估计值和标准误差。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"","code":"HDL_rg(   GWASfile = c(\"./XXX_MTAG.txt\", \"./XXX_MTAG_IEU.txt\"),   LD.path,   Nref = 335265,   N0 = NULL,   eigen.cut = \"automatic\",   jackknife.df = FALSE,   intercept.output = FALSE,   fill.missing.N = NULL,   lim = exp(-18),   verbose = FALSE,   save_name = \"rg\",   save_path = \"./HDL\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"GWASfile 包含两个MTAG格式的GWAS数据文件的路径，如c(\"./XXX_MTAG.txt\", \"./XXX_MTAG_IEU.txt\")，可由format_dat()转换获得。 LD.path 字符串，指定存储连锁不平衡（LD）信息的目录路径。 Nref 数值，计算LD的参考样本的样本量。若使用默认的英国生物样本库参考样本，Nref = 335265。 N0 数值，两个队列中共同包含的个体数。估算的遗传相关性对错误指定的N0通常具有鲁棒性。若为NULL（默认值），默认值设置为队列1和队列2所有SNP中的最小样本量。 eigen.cut 数值，指定在每个LD得分矩阵中用于HDL的特征值和特征向量。用户可选择0到1之间的数值，例如eigen.cut = 0.99表示使用解释99%方差的主成分特征值及其对应的特征向量。如果使用默认值“automatic”，将采用生成最稳定遗传率估计的eigen.cut。 jackknife.df 逻辑值，默认为FALSE。是否返回分块删失估计。 intercept.output 逻辑值，默认为FALSE。是否在estimates.df中包含截距项。 fill.missing.N 若为NULL（默认值），将移除缺失N的SNP。可以指定“median”、“min”或“max”以相应填补缺失的N。例如，“median”表示使用有N值的SNP的中位数填充缺失值。 lim 公差限制，默认值为lim = exp(-18)。 verbose 逻辑值，默认为FALSE。是否在控制台打印遗传协方差优化过程。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"返回一个列表，包含以下内容： rg 估算的遗传相关性。 rg.se 估算的遗传相关性的标准误。 P 基于Wald检验的P值。 estimates.df 包含遗传率估计值及标准误、遗传协方差和遗传相关性的详细矩阵。 eigen.use 计算中使用的eigen.cut值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"用户可以下载预计算的欧洲人群LD相关矩阵的特征值和特征向量，下载链接：https://github.com/zhenin/HDL/wiki/Reference-panels 这些LD矩阵及其特征分解基于335,265名来自英国生物样本库的英国基因组个体。提供了两组参考面板： 307,519个已质量控制的英国生物样本库Axiom Array SNPs，解压后大小约为7.5 GB。 1,029,876个已质量控制的英国生物样本库填补SNPs，解压后大小约为31 GB。尽管耗时更长，填补面板提供的遗传相关性估计更为精确。 若GWAS包含大部分HapMap3 SNPs，建议使用填补参考面板。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"Ning Z, Pawitan Y, Shen X. High-definition likelihood inference genetic correlations across human complex traits. Nat Genet. 2020 Aug;52(8):859-864.","code":""},{"path":[]},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"使用HDL进行高精度似然推断遗传相关性分析 — HDL_rg","text":"Zheng Ning, Xia Shen","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"该函数是HDL_rg的并行版本，基于GWAS汇总统计数据返回两个性状之间的遗传相关性估计值及其标准误。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"","code":"HDL_rg_parallel(   GWASfile = c(\"./XXX_MTAG.txt\", \"./XXX_MTAG_IEU.txt\"),   LD.path,   Nref = 335265,   N0 = NULL,   numCores = 2,   eigen.cut = \"automatic\",   jackknife.df = FALSE,   intercept.output = FALSE,   fill.missing.N = NULL,   lim = exp(-18),   verbose = FALSE,   save_name = \"rg\",   save_path = \"./HDL\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"GWASfile 包含两个MTAG格式的GWAS数据文件的路径，如c(\"./XXX_MTAG.txt\", \"./XXX_MTAG_IEU.txt\")，可由format_dat()转换获得。 LD.path 存储连锁不平衡（LD）信息的目录路径。 Nref 用于计算LD的参考样本的样本量。如果使用默认的UK Biobank参考样本，则Nref = 335265。 N0 数值，两个队列中共同包含的个体数。估算的遗传相关性对错误指定的N0通常具有鲁棒性。若为NULL（默认值），默认值设置为队列1和队列2所有SNP中的最小样本量。 numCores 使用的核心数量。 eigen.cut 用于HDL的LD分数矩阵中的特征值和特征向量。用户可指定0到1之间的数值。例如，eigen.cut = 0.99表示使用解释99％方差的主特征值及其对应的特征向量。如果使用默认的“自动”选项，将选择能够提供最稳定遗传力估计的eigen.cut。 jackknife.df 逻辑值，默认为FALSE。是否返回块-删失法的估计结果？ intercept.output 逻辑值，默认为FALSE。是否在estimates.df中包含截距项？ fill.missing.N 若为NULL（默认值），则缺失N的SNP将被移除。可以指定“median”、“min”或“max”来填充缺失的N。例如，“median”表示使用有N值的SNP的中位数填充缺失的N。 lim 公差限制，默认lim = exp(-18)。 verbose 逻辑值，默认为FALSE。是否在控制台打印遗传协方差优化过程。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"返回一个包含以下内容的列表： rg 估计的遗传相关性。 rg.se 估计的遗传相关性的标准误。 P 基于Wald检验的P值。 estimates.df 包含遗传力、遗传协方差和遗传相关性的估计值和标准误的详细矩阵。 eigen.use 计算中使用的eigen.cut。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"用户可以下载欧洲血统人群的预计算LD相关矩阵特征值和特征向量。下载链接：https://github.com/zhenin/HDL/wiki/Reference-panels。以下是从335,265位英国UK Biobank个体中计算得到的LD矩阵及其特征值分解。提供三组参考面板： 1）1,029,876个经过质量控制的UK Biobank的HapMap3基因型填充SNP。解压后大小约为33 GB。尽管耗时较长，但使用填充的面板可提供更准确的遗传相关性估计。因此，如果GWAS包含大部分HapMap3 SNP，建议使用该填充参考面板。 2）769,306个经过质量控制的UK Biobank的HapMap2基因型填充SNP。解压后大小约为18 GB。如果您的GWAS包含大部分HapMap2 SNP，但上述HapMap3参考面板中缺少许多SNP（超过1％），则推荐使用该HapMap2面板。 3）307,519个经过质量控制的UK Biobank Axiom Array SNP。解压后大小约为7.5 GB。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"Ning Z, Pawitan Y, Shen X. High-definition likelihood inference genetic correlations across human complex traits. Nat Genet. 2020 Aug;52(8):859-864.","code":""},{"path":[]},{"path":"https://hortoner.github.io/QTLMR/reference/HDL_rg_parallel.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"使用HDL包多核进行遗传相关性的高精度似然推断 — HDL_rg_parallel","text":"Zheng Ning, Xia Shen","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Contrast_polygenicity.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件绘制性状之间多基因性对比度的图 — HESS_Contrast_polygenicity","title":"使用HESS软件绘制性状之间多基因性对比度的图 — HESS_Contrast_polygenicity","text":"官网：https://huwenboshi.github.io/hess/contrast_polygenicity/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Contrast_polygenicity.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件绘制性状之间多基因性对比度的图 — HESS_Contrast_polygenicity","text":"","code":"HESS_Contrast_polygenicity(   local_hsqg_est = c(\"./step2_trait1.txt\", \"./step2_trait2.txt\"),   trait_names = c(\"trait1\", \"trait2\"),   save_name = \"contrast\",   save_path = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Contrast_polygenicity.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件绘制性状之间多基因性对比度的图 — HESS_Contrast_polygenicity","text":"local_hsqg_est 遗传度结果文件路径名，例如c(\"./step2_trait1.txt\",\"./step2_trait2.txt\")。 trait_names 性状名称，例如c(\"trait1\", \"trait2\")，根据自己实际数据情况修改。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Contrast_polygenicity.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件绘制性状之间多基因性对比度的图 — HESS_Contrast_polygenicity","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_correlation.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件计算性状遗传协方差和相关性(ρ-HESS) — HESS_estimate_correlation","title":"使用HESS软件计算性状遗传协方差和相关性(ρ-HESS) — HESS_estimate_correlation","text":"官网：https://huwenboshi.github.io/hess/local_rhog/， 在第一步中，HESS 计算 LD 矩阵的特征值，GWAS 效应大小向量的平方投影到每个性状 LD 矩阵的特征向量上，以及 GWAS 效应大小向量投影到特征向量上的乘积，此步耗时较长。 在第二步中，HESS 使用步骤1的输出来获得每个性状的局部 SNP 遗传力的估计值。 在第三步，HESS 利用第二步的输出得到局部遗传协方差估计及其标准误差。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_correlation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件计算性状遗传协方差和相关性(ρ-HESS) — HESS_estimate_correlation","text":"","code":"HESS_estimate_correlation(   Sumstatsfile = c(\"./XXX.sumstats\", \"./XXX.sumstats\"),   bfile = \"./1kg_eur_1pct/1kg_eur_1pct_chr\",   partition = \"./ldetect-data/EUR/fourier_ls-all.bed\",   reinflate_lambda_gc = NULL,   tot_hsqg = NULL,   num_shared = 0,   pheno_cor = 0,   start_chr = 1,   end_chr = 22,   opt_arguments_step1 = NULL,   opt_arguments_step2 = NULL,   opt_arguments_step3 = NULL,   skip_step1 = FALSE,   save_name = \" \",   save_path = \" \",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_correlation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件计算性状遗传协方差和相关性(ρ-HESS) — HESS_estimate_correlation","text":"Sumstatsfile 第一步参数，两个性状.sumstats格式文件路径，例如c(\"./XXX.sumstats\",\"./XXX.sumstats\")。 bfile 第一步参数，PLINK格式的参考面板文件。 partition 第一步参数，用于指定基因组分区文件。 reinflate_lambda_gc 第二、三步参数，通过基因组控制因子重新填充汇总统计数据。 tot_hsqg 第二步参数，GWAS数据总的SNP遗传性和标准误。 num_shared 第三步参数，共享样本数，默认为 0。 pheno_cor 第三步参数，表型相关性，默认为 0。 start_chr 第一步参数，需要分析的染色体起始序号。 end_chr 第一步参数，需要分析的染色体终止序号。 opt_arguments_step1 step1其他命令行参数，默认NULL。 opt_arguments_step2 step2其他命令行参数，默认NULL。 opt_arguments_step3 step3其他命令行参数，默认NULL。 skip_step1 是否跳过第一步，直接进行第二步、第三步计算。用于调整第二步，第三步参数后再次计算。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_correlation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件计算性状遗传协方差和相关性(ρ-HESS) — HESS_estimate_correlation","text":"返回计算结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_heritability.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件计算局部SNP遗传力及标准误差 — HESS_estimate_heritability","title":"使用HESS软件计算局部SNP遗传力及标准误差 — HESS_estimate_heritability","text":"官网：https://huwenboshi.github.io/hess/local_hsqg/，从 GWAS 数据计算本地SNP遗传性的步骤包括两个主要部分。 第一步，计算 LD 矩阵的特征值，并将GWAS效应大小向量的平方投影到LD矩阵的特征向量上。 第二步，使用第一步的输出来获得局部SNP遗传力的估计值及其标准误差。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_heritability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件计算局部SNP遗传力及标准误差 — HESS_estimate_heritability","text":"","code":"HESS_estimate_heritability(   Sumstatsfile = \" \",   bfile = \"./1kg_eur_1pct/1kg_eur_1pct_chr\",   partition = \"./ldetect-data/EUR/fourier_ls-all.bed\",   reinflate_lambda_gc = NULL,   tot_hsqg = NULL,   start_chr = 1,   end_chr = 22,   opt_arguments_step1 = NULL,   opt_arguments_step2 = NULL,   save_name = \" \",   save_path = \" \",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_heritability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件计算局部SNP遗传力及标准误差 — HESS_estimate_heritability","text":"Sumstatsfile .sumstats格式文件路径。 bfile PLINK格式的参考面板文件。 partition 用于指定基因组分区文件。 reinflate_lambda_gc 通过基因组控制因子重新填充汇总统计数据。 tot_hsqg GWAS数据总的SNP遗传性和标准误。 start_chr 需要分析的染色体起始序号。 end_chr 需要分析的染色体终止序号。 opt_arguments_step1 step1其他命令行参数，默认NULL。 opt_arguments_step2 step2其他命令行参数，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_heritability.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件计算局部SNP遗传力及标准误差 — HESS_estimate_heritability","text":"返回计算结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_lambdagc.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件计算基因组控制因子 — HESS_estimate_lambdagc","title":"使用HESS软件计算基因组控制因子 — HESS_estimate_lambdagc","text":"使用HESS软件计算基因组控制因子","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_lambdagc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件计算基因组控制因子 — HESS_estimate_lambdagc","text":"","code":"HESS_estimate_lambdagc(   prefix = \"./step1\",   num_eig = 50,   pct = 0.5,   min_eigval = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_lambdagc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件计算基因组控制因子 — HESS_estimate_lambdagc","text":"prefix Local SNP遗传性估计步骤1输出的文件路径/前缀。 num_eig 数值，使用的特征向量数，默认50。 pct 数值，用于计算基因组控制因子的loci百分比，默认0.5。 min_eigval 数值，最小特征值，默认1。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_lambdagc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件计算基因组控制因子 — HESS_estimate_lambdagc","text":"返回结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_phenocor.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件计算性状表型的相关性 — HESS_estimate_phenocor","title":"使用HESS软件计算性状表型的相关性 — HESS_estimate_phenocor","text":"使用HESS软件计算性状表型的相关性","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_phenocor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件计算性状表型的相关性 — HESS_estimate_phenocor","text":"","code":"HESS_estimate_phenocor(ldsc_log = \" \", samplesize1, samplesize2, ns = 0)"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_phenocor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件计算性状表型的相关性 — HESS_estimate_phenocor","text":"ldsc_log LDSC_py_rg()函数计算遗传相关性生成的日志文件路径名。 samplesize1 数值，性状1的样本量。 samplesize2 数值，性状2的样本量。 ns 数值，两性状GWAS的重叠的样本量。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_estimate_phenocor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件计算性状表型的相关性 — HESS_estimate_phenocor","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_format_data.html","id":null,"dir":"Reference","previous_headings":"","what":"将TwosampleMR格式转换成HESS分析输入格式数据 — HESS_format_data","title":"将TwosampleMR格式转换成HESS分析输入格式数据 — HESS_format_data","text":"输出.sumstats格式数据(表头：CHR BP SNP A1 A2 Z N )，官网：https://huwenboshi.github.io/hess/input_format/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_format_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将TwosampleMR格式转换成HESS分析输入格式数据 — HESS_format_data","text":"","code":"HESS_format_data(   GWASfile = \" \",   N = NULL,   FOCUS_munge = FALSE,   gwas_loci = TRUE,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_format_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将TwosampleMR格式转换成HESS分析输入格式数据 — HESS_format_data","text":"GWASfile 字符串向量，标准的TwosampelMR格式数据文件路径。 N 样本量，如果TwosampelMR格式数据samplesize列为NA，需要补充，默认NULL。 FOCUS_munge 是否调用FOCUS软件格式化数据，默认FALSE。请注意，使用该方法生成的XXX.sumstats.gz文件需要解压成XXX.sumstats文件后，才能被HESS软件读取！ gwas_loci TRUE或FALSE，是否保存性状的基因组信息(CHR BP)数据。 save_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下，如果设置为NULL，则不保存文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_format_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将TwosampleMR格式转换成HESS分析输入格式数据 — HESS_format_data","text":"data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置HESS软件环境 — HESS_install","title":"配置HESS软件环境 — HESS_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置HESS软件环境 — HESS_install","text":"","code":"HESS_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置HESS软件环境 — HESS_install","text":"force TRUE或FALSE，是否重新安装HESS软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_putative_causality.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件推断性状特征之间因果关系并绘图 — HESS_putative_causality","title":"使用HESS软件推断性状特征之间因果关系并绘图 — HESS_putative_causality","text":"官网：https://huwenboshi.github.io/hess/infer_causality/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_putative_causality.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件推断性状特征之间因果关系并绘图 — HESS_putative_causality","text":"","code":"HESS_putative_causality(   local_rhog_est = \"./step3.txt\",   local_hsqg_est = c(\"./step2_trait1.txt\", \"./step2_trait2.txt\"),   trait_names = c(\"trait1\", \"trait2\"),   gwas_loci = \" \",   save_name = \" \",   save_path = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_putative_causality.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件推断性状特征之间因果关系并绘图 — HESS_putative_causality","text":"local_rhog_est 遗传协方差结果文件路径名，例如\"./step3.txt\"。如果赋值为NULL，则SNP遗传度曼哈顿图。 local_hsqg_est 遗传度结果文件路径名，例如c(\"./step2_trait1.txt\",\"./step2_trait2.txt\")。 trait_names 性状名称，例如c(\"trait1\", \"trait2\")，根据自己实际数据情况修改。 gwas_loci 性状的基因组信息(CHR BP)，可由HESS_format_data()函数转换获得。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_putative_causality.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件推断性状特征之间因果关系并绘图 — HESS_putative_causality","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Visualizing_estimates.html","id":null,"dir":"Reference","previous_headings":"","what":"使用HESS软件绘制SNP遗传度或协方差的曼哈顿图 — HESS_Visualizing_estimates","title":"使用HESS软件绘制SNP遗传度或协方差的曼哈顿图 — HESS_Visualizing_estimates","text":"官网：https://huwenboshi.github.io/hess/viz/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Visualizing_estimates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用HESS软件绘制SNP遗传度或协方差的曼哈顿图 — HESS_Visualizing_estimates","text":"","code":"HESS_Visualizing_estimates(   local_rhog_est = NULL,   local_hsqg_est = \" \",   trait_names = \" \",   save_name = \" \",   save_path = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Visualizing_estimates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用HESS软件绘制SNP遗传度或协方差的曼哈顿图 — HESS_Visualizing_estimates","text":"local_rhog_est 遗传协方差结果文件路径名，例如\"./step3.txt\"。如果赋值为NULL，则SNP遗传度曼哈顿图。 local_hsqg_est 遗传度结果文件路径名，例如\"step2_trait1.txt\"或c(\"./step2_trait1.txt\",\"./step2_trait2.txt\")。 trait_names 性状名称，例如\"trait1\"或c(\"trait1\", \"trait2\")，根据自己实际数据情况修改。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/HESS_Visualizing_estimates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用HESS软件绘制SNP遗传度或协方差的曼哈顿图 — HESS_Visualizing_estimates","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/install_Rtools.html","id":null,"dir":"Reference","previous_headings":"","what":"安装Rtools软件 — install_Rtools","title":"安装Rtools软件 — install_Rtools","text":"安装Rtools软件","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/install_Rtools.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"安装Rtools软件 — install_Rtools","text":"","code":"install_Rtools()"},{"path":"https://hortoner.github.io/QTLMR/reference/install_Rtools.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"安装Rtools软件 — install_Rtools","text":"","code":"install_Rtools() #> Installing package into 'C:/Users/19662/AppData/Local/Temp/RtmpUVih4E/temp_libpath5f385cb27d3d' #> (as 'lib' is unspecified) #> package 'installr' successfully unpacked and MD5 sums checked #>  #> The downloaded binary packages are in #> \tC:\\Users\\19662\\AppData\\Local\\Temp\\RtmpW45iJJ\\downloaded_packages #> Error in winDialog(type = \"yesno\", message = question): winDialog() cannot be used non-interactively"},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_predixcan_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用predixcan软件进行TWAS分析 — JTI_predixcan_test","title":"使用predixcan软件进行TWAS分析 — JTI_predixcan_test","text":"软件官网：https://github.com/hakyimlab/MetaXcan/tree/master","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_predixcan_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用predixcan软件进行TWAS分析 — JTI_predixcan_test","text":"","code":"JTI_predixcan_test(   test_help = FALSE,   GTEX_tissue = \"all\",   model_db_path = \"./JTI\",   covariance = \"./JTI\",   gwas_file = \"SNP_gwas_mc_merge_nogc.tbl.uniq\",   snp_column = \"SNP\",   effect_allele_column = \"A1\",   non_effect_allele_column = \"A2\",   beta_column = \"b\",   se_column = \"se\",   opt_arguments = \"--parallel\",   FDR_method = \"bonferroni\",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_predixcan_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用predixcan软件进行TWAS分析 — JTI_predixcan_test","text":"test_help 是否调阅predixcan.py的帮助文档，默认FALSE。 GTEX_tissue GTEx v8组织类型，默认\"\"，即对所有组织分析，也可指定组织，如\"JTI_Whole_Blood\"。 model_db_path 基因表达补全模型的路径（顺式eQTLs的估计权重/效应值）。 covariance 包含协方差信息的文件路径（用于估计基因水平效应量估计器的方差，详情见手稿方法部分的基因水平关联测试）。 gwas_file GWAS的文件路径。 snp_column 包含RSID的列名。 effect_allele_column 包含效应等位基因的列名。 non_effect_allele_column 包含非效应等位基因的列名。 beta_column 输入GWAS文件中包含每个SNP效应值的列名。 se_column 输入GWAS文件中包含每个SNP 标准方差值的列名。 opt_arguments predixcan.py的其他命令行参数(设置test_help=TRUE查看)，默认NULL。 FDR_method 对P值进行FDR矫正方法，\"fdr\"或\"bonferroni\"，默认\"bonferroni\"。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_predixcan_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用predixcan软件进行TWAS分析 — JTI_predixcan_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_predixcan_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用predixcan软件进行TWAS分析 — JTI_predixcan_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_SPrediXcan_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用S-PrediXcan软件进行TWAS分析 — JTI_SPrediXcan_test","title":"使用S-PrediXcan软件进行TWAS分析 — JTI_SPrediXcan_test","text":"软件官网：https://github.com/hakyimlab/MetaXcan/tree/master","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_SPrediXcan_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用S-PrediXcan软件进行TWAS分析 — JTI_SPrediXcan_test","text":"","code":"JTI_SPrediXcan_test(   test_help = FALSE,   GTEX_tissue = \"all\",   model_db_path = \"./JTI\",   covariance = \"./JTI\",   gwas_folder = \"./\",   gwas_file_pattern = \"SNP_gwas_mc_merge_nogc.tbl.uniq\",   snp_column = \"SNP\",   effect_allele_column = \"A1\",   non_effect_allele_column = \"A2\",   beta_column = \"b\",   se_column = \"se\",   opt_arguments = NULL,   FDR_method = \"bonferroni\",   save_path = \"./\",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_SPrediXcan_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用S-PrediXcan软件进行TWAS分析 — JTI_SPrediXcan_test","text":"test_help 是否调阅SPrediXcan.py的帮助文档，默认FALSE。 GTEX_tissue GTEx v8组织类型，默认\"\"，即对所有组织分析，也可指定组织，如\"JTI_Whole_Blood\"。 model_db_path 基因表达补全模型的路径（顺式eQTLs的估计权重/效应值）。 covariance 包含协方差信息的文件路径（用于估计基因水平效应量估计器的方差，详情见手稿方法部分的基因水平关联测试）。 gwas_folder 包含GWAS汇总统计数据的文件夹。 gwas_file_pattern GWAS文件（如果未按染色体分段，则为汇总统计的文件名）。 snp_column 包含RSID的列名。 effect_allele_column 包含效应等位基因的列名。 non_effect_allele_column 包含非效应等位基因的列名。 beta_column 输入GWAS文件中包含每个SNP效应值的列名。 se_column 输入GWAS文件中包含每个SNP 标准方差的列名。 opt_arguments SPrediXcan.py的其他命令行参数(设置test_help=TRUE查看)，默认NULL。 FDR_method 对P值进行FDR矫正方法，\"fdr\"或\"bonferroni\"，默认\"bonferroni\"。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_SPrediXcan_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用S-PrediXcan软件进行TWAS分析 — JTI_SPrediXcan_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/JTI_SPrediXcan_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用S-PrediXcan软件进行TWAS分析 — JTI_SPrediXcan_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_bivarplot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制双变量LAVA分析结果的散点图 — LAVA_bivarplot","title":"绘制双变量LAVA分析结果的散点图 — LAVA_bivarplot","text":"该函数用于根据LAVA双变量分析的结果，绘制散点图，并对结果进行可视化。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_bivarplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制双变量LAVA分析结果的散点图 — LAVA_bivarplot","text":"","code":"LAVA_bivarplot(   bivar_res = \"./LAVA/bivar_res.csv\",   fdr_method = \"bonferroni\",   color_low = \"blue\",   color_mid = \"yellow\",   color_high = \"red\",   color_midpoint = 0,   theme_base_size = 12,   x_axis_label_size = 10,   y_axis_label_size = 10,   ticks_size = 8,   plot_width = 8,   plot_height = 6,   save_name = \"LAVA\",   save_path = \"./LAVA\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_bivarplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制双变量LAVA分析结果的散点图 — LAVA_bivarplot","text":"bivar_res 字符串，LAVA双变量分析结果的文件路径，默认值为\"./LAVA/bivar_res.csv\"。 fdr_method 字符串，FDR调整的方法，默认值为\"bonferroni\"。可选择的调整方法包括 \"bonferroni\", \"hochberg\", \"hommel\", \"BH\", \"fdr\" 等。 color_low 字符串，低值区域的颜色，默认值为\"blue\"。 color_mid 字符串，中间值区域的颜色，默认值为\"yellow\"。 color_high 字符串，高值区域的颜色，默认值为\"red\"。 color_midpoint 数值，渐变色的中点，默认值为0。 theme_base_size 数值，图形主题的基本字体大小，默认值为12。 x_axis_label_size 数值，x轴标签的字体大小，默认值为10。 y_axis_label_size 数值，y轴标签的字体大小，默认值为10。 ticks_size 数值，坐标轴刻度标签的字体大小，默认值为10。 plot_width 数值，保存PDF的宽度，默认值为8。 plot_height 数值，保存PDF的高度，默认值为6。 save_name 字符串，保存PDF图形的文件名，默认值为\"LAVA\"。 save_path 字符串，保存PDF文件的路径，默认值为\"./LAVA\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_bivarplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制双变量LAVA分析结果的散点图 — LAVA_bivarplot","text":"返回数据框bivar_res，其中包含了FDR调整后的p值以及-log10(p)值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_run.html","id":null,"dir":"Reference","previous_headings":"","what":"使用 LAVA 包对所有基因组位点执行双变量遗传相关性分析 — LAVA_run","title":"使用 LAVA 包对所有基因组位点执行双变量遗传相关性分析 — LAVA_run","text":"软件官网：https://github.com/josefin-werme/LAVA。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用 LAVA 包对所有基因组位点执行双变量遗传相关性分析 — LAVA_run","text":"","code":"LAVA_run(   GWASfile = c(\"./XXX_MTAG_IEU.txt\", \"./XXX_MTAG_FinnGen.txt\"),   GWAS_name = c(\"XXX\", \"XXX\"),   cases = c(5000, 12000),   controls = c(14000, 480000),   sample_overlap_file = \"./sample.overlap.txt\",   ref_prefix = \"./g1000_eur/g1000_eur\",   loci_file = \"blocks_s2500_m25_f1_w200.GRCh37_hg19.locfile\",   loci_num = NULL,   phenos = NULL,   target = NULL,   min.K = 2,   prune.thresh = 99,   max.prop.K = 0.75,   drop.failed = TRUE,   univ.p.thresh = 0.05,   adap.thresh = c(1e-04, 1e-06),   param.lim = 1.25,   save_path = \"./LAVA\",   cores = 4 )"},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用 LAVA 包对所有基因组位点执行双变量遗传相关性分析 — LAVA_run","text":"GWASfile 包含两个MTAG格式的GWAS数据文件的路径，如c(\"./XXX_MTAG.txt\", \"./XXX_MTAG_IEU.txt\")，可由format_dat()转换获得，注意：GWAS数据的人类参考基因组版本需转换为GRCh37。 GWAS_name GWAS 文件对应的性状名称向量。每个名称与 GWASfile 中的文件一一对应。 cases 每个性状的病例样本数向量，与 GWAS_name 中的性状一一对应，如c(1000,NA,1200)，连续型GWAS数据的中的病例样本数为NA。 controls 每个性状的对照样本数向量，与 GWAS_name 中的性状一一对应，如c(3000,NA,36000)，连续型GWAS数据的中的对照样本数为NA。 sample_overlap_file 样本重叠信息文件的路径，描述 GWAS 样本间的重叠情况，使用LAVA_sample_overlap()函数获取。无样本重叠时，可以填写NULL。 ref_prefix 基因组参考数据的文件前缀，例如 1KG 欧洲人群的参考文件。下载地址：https://cncr.nl/research/lava/，与MAGMA分析的输入文件一致。 loci_file 位点信息文件的路径，包含基因组块划分信息（如染色体、起始位置、终止位置和 SNP 列表）。下载地址：https://github.com/josefin-werme/LAVA/blob/main/support_data/blocks_s2500_m25_f1_w200.GRCh37_hg19.locfile。 loci_num 要分析的位点范围（起始和终止的索引号），如c(1,100)。若为 NULL 则分析文件中的所有位点。 phenos 要分析的表型子集及其顺序。如果为NULL，将分析位点对象中的所有表型（按位点对象中列出的顺序）。 target 感兴趣的目标表型。如果为NULL，将计算所有表型对之间的双变量相关性；否则，将仅计算目标表型与其他所有表型之间的双变量相关性。 min.K 处理位点所需的最小主成分（PC）数量（不能少于 2）。如果不满足此条件，函数将失败，无法分析该位点。 prune.thresh 主成分选择时的累计解释方差阈值（百分比），默认值为 99。 max.prop.K 主成分数量的上限，占输入数据最小样本量的比例，默认值为 0.75。 drop.failed 布尔值，指示是否从输出中移除处理失败的性状。默认值为 TRUE。 univ.p.thresh 单变量测试的显著性阈值，用于筛选满足局部遗传力要求的性状，默认为0.05，建议0.05/2495。 adap.thresh 自适应阈值向量，用于调整 p 值生成的迭代次数。默认值为 c(1e-04, 1e-06)。默认迭代次数为 1e+4，但当 p 值低于这些阈值时，将增加到 1e+5 和 1e+6。 如果设为 NULL，最大迭代次数将限制为默认值（注意：这会显著加速分析，但会降低低 p 值时的准确性）。 param.lim 参数估计的阈值，超出该正负阈值的估计参数将被认为不可靠，将被设置为 NA，默认值为 1.25。 save_path 保存分析结果的路径，默认值为当前目录的 ./LAVA。 cores 并行计算时使用的核心数。默认值为 4。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用 LAVA 包对所有基因组位点执行双变量遗传相关性分析 — LAVA_run","text":"双变量分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_sample_overlap.html","id":null,"dir":"Reference","previous_headings":"","what":"创建 LAVA 分析输入的sample overlap文件 — LAVA_sample_overlap","title":"创建 LAVA 分析输入的sample overlap文件 — LAVA_sample_overlap","text":"创建 LAVA 分析输入的sample overlap文件","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_sample_overlap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"创建 LAVA 分析输入的sample overlap文件 — LAVA_sample_overlap","text":"","code":"LAVA_sample_overlap(files = \" \")"},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_sample_overlap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"创建 LAVA 分析输入的sample overlap文件 — LAVA_sample_overlap","text":"files 字符型或向量，一个或者多个文件LDSC输出的\"xxx.log\"日志文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LAVA_sample_overlap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"创建 LAVA 分析输入的sample overlap文件 — LAVA_sample_overlap","text":"矩阵结果","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LCV_run.html","id":null,"dir":"Reference","previous_headings":"","what":"潜在因果变量分析(LCV) — LCV_run","title":"潜在因果变量分析(LCV) — LCV_run","text":"软件官网：https://github.com/lukejoconnor/LCV。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LCV_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"潜在因果变量分析(LCV) — LCV_run","text":"","code":"LCV_run(   Sumstatsfile = c(\"./xxx.sumstats.gz\", \"./xxx.sumstats.gz\"),   ldscoresFile = NULL,   no.blocks = 100,   crosstrait.intercept = 1,   ldsc.intercept = 1,   n.1 = 1,   n.2 = 1,   intercept.12 = 0 )"},{"path":"https://hortoner.github.io/QTLMR/reference/LCV_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"潜在因果变量分析(LCV) — LCV_run","text":"Sumstatsfile 包含两个.sumstats.gz格式文件路径向量，由LDSC_py_sumstats()函数转换获得。 ldscoresFile 字符串，LD分数文件的目录路径，设置为NULL时，默认使用欧洲人群 LD 分数文件。 .blocks 整数，Jackknife 方法中分成的区块数量。它决定如何将数据划分成若干区块，以估计标准误差。 crosstrait.intercept 逻辑值，0 表示交叉性状的 LDSC 截距应固定，1 表示不固定。建议使用 1 来优化分析。 ldsc.intercept 逻辑值，0 表示 LDSC 截距应固定，1 表示不固定。建议使用 1 来优化分析。 n.1 整数，性状 1 的样本大小，仅在 ldsc.intercept = 0 时需要。 n.2 整数，性状 2 的样本大小，仅在 ldsc.intercept = 0 时需要。 intercept.12 标量，性状 1 和性状 2 之间采样误差的协方差，仅在 crosstrait_intercept = 0 时需要。如果两个 GWAS 数据集没有重叠，可以设置为 0。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LCV_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"潜在因果变量分析(LCV) — LCV_run","text":"返回一个包含多个统计量的列表，具体包括： zscore：遗传因果关系的 Z 分数。zscore >> 0 表示 gcp > 0，意味着性状 1 对性状 2 有遗传因果影响。 pval.gcpzero.2tailed：零假设 gcp = 0 的双尾 p 值，用于判断遗传因果关系是否显著。 gcp.pm：后验均值的 gcp 值。gcp = 1 表示性状 1 对性状 2 具有因果关系，gcp = -1 表示性状 2 对性状 1 具有因果关系。 gcp.pse：后验标准误差，表示 gcp 估计值的不确定性。 rho.est：估计的遗传相关性，衡量性状 1 和性状 2 之间的遗传联系。 rho.err：遗传相关性估计的标准误差。 pval.fullycausal：两个 p 值，分别对应于 gcp = 1 和 gcp = -1 的零假设的 p 值。 h2.zscore：两个性状的遗传性 Z 分数，表示性状 1 和性状 2 的遗传性。建议报告 Z 分数大于 7 的结果（这是一个非常严格的阈值）。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_h2.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldscr包计算遗传力 — LDSC_ldscr_h2","title":"使用ldscr包计算遗传力 — LDSC_ldscr_h2","text":"具体参数可参考函数ldscr::ldsc_h2()，数据必须包含samplesize样本量，不能缺失。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_h2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldscr包计算遗传力 — LDSC_ldscr_h2","text":"","code":"LDSC_ldscr_h2(   GWASfile = \"\",   ancestry,   sample_prev = NA,   population_prev = NA,   ld,   wld,   n_blocks = 200,   chisq_max = NA )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_h2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldscr包计算遗传力 — LDSC_ldscr_h2","text":"GWASfile 标准的TwosampelMR格式数据文件路径。 ancestry 字符串，指定的人种，可选值为\"AFR\"（非洲人），\"AMR\"（美洲人），\"CSA\"（中南美洲人），\"EAS\"（东亚人），\"EUR\"（欧洲人），或 \"MID\"（中东人），将使用相应的内置ld和wld文件。如果为空，则用户必须指定ld和wld文件的路径。 sample_prev 列表，包含当前样本中病例的患病率，用于将观察到的遗传力转换为患病率尺度上的遗传力。默认为NA，适用于定量性状或在观察尺度上估计遗传力。 population_prev 列表，包含该性状的人群患病率，用于将观察到的遗传力转换为患病率尺度上的遗传力。默认为NA，适用于定量性状或在观察尺度上估计遗传力。 ld 字符串，LD分数文件的目录路径，以*.l2.ldscore.gz 结尾。默认为NA，将使用ancestry参数指定的人种的内置LD分数文件。 wld 字符串，权重文件的目录路径。默认为NA，将使用ancestry参数指定的人种的内置权重文件。 n_blocks 数值，用于生成块交叉验证标准误差的块数。默认为200。 chisq_max 数值，用于将SNPs包含在LD分数回归中的Z^2的最大值。默认为80和N*0.001的最大值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_h2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldscr包计算遗传力 — LDSC_ldscr_h2","text":"data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_rg.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldscr包计算交叉性状遗传相关性 — LDSC_ldscr_rg","title":"使用ldscr包计算交叉性状遗传相关性 — LDSC_ldscr_rg","text":"具体参数可参考函数ldscr::ldsc_rg()，数据必须包含samplesize样本量，不能缺失。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_rg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldscr包计算交叉性状遗传相关性 — LDSC_ldscr_rg","text":"","code":"LDSC_ldscr_rg(   GWASfile = \"\",   ancestry,   sample_prev = NA,   population_prev = NA,   ld,   wld,   n_blocks = 200,   chisq_max = NA )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_rg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldscr包计算交叉性状遗传相关性 — LDSC_ldscr_rg","text":"GWASfile 字符串向量，标准的TwosampelMR格式数据文件路径。 ancestry 字符串，指定的人种，可选值为\"AFR\"（非洲人），\"AMR\"（美洲人），\"CSA\"（中南美洲人），\"EAS\"（东亚人），\"EUR\"（欧洲人），或 \"MID\"（中东人），将使用相应的内置ld和wld文件。如果为空，则用户必须指定ld和wld文件的路径。 sample_prev 列表，包含当前样本中病例的患病率，用于将观察到的遗传力转换为患病率尺度上的遗传力。默认为NA，适用于定量性状或在观察尺度上估计遗传力。 population_prev 列表，包含该性状的人群患病率，用于将观察到的遗传力转换为患病率尺度上的遗传力。默认为NA，适用于定量性状或在观察尺度上估计遗传力。 ld 字符串，LD分数文件的目录路径，以*.l2.ldscore.gz 结尾。默认为NA，将使用ancestry参数指定的人种的内置LD分数文件。 wld 字符串，权重文件的目录路径。默认为NA，将使用ancestry参数指定的人种的内置权重文件。 n_blocks 数值，用于生成块交叉验证标准误差的块数。默认为200。 chisq_max 数值，用于将SNPs包含在LD分数回归中的Z^2的最大值。默认为80和N*0.001的最大值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_ldscr_rg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldscr包计算交叉性状遗传相关性 — LDSC_ldscr_rg","text":"data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_MRlap.html","id":null,"dir":"Reference","previous_headings":"","what":"使用MRlap包分析交叉性状遗传相关性，矫正样本重叠引起的IVW-MR分析的偏差 — LDSC_MRlap","title":"使用MRlap包分析交叉性状遗传相关性，矫正样本重叠引起的IVW-MR分析的偏差 — LDSC_MRlap","text":"执行交叉性状遗传相关性分析，IVW-MR分析，并矫正由于暴露和结局样本重叠，弱工具的使用以及胜利者诅咒而引起的偏差。具体参数参考：MRlap::MRlap()， eur_w_ld_chr与w_hm3.snplist文件下载地址：https://utexas.box.com/s/vkd36n197m8klbaio3yzoxsee6sxo11v.","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_MRlap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用MRlap包分析交叉性状遗传相关性，矫正样本重叠引起的IVW-MR分析的偏差 — LDSC_MRlap","text":"","code":"LDSC_MRlap(   exposure,   exposure_name = \"exposure\",   outcome,   outcome_name = \"outcome\",   ld = \"./eur_w_ld_chr\",   hm3 = \"./eur_w_ld_chr/w_hm3.snplist\",   do_pruning = TRUE,   user_SNPsToKeep = \"\",   MR_threshold = 5e-08,   MR_pruning_dist = 10000,   MR_pruning_LD = 0.001,   MR_reverse = 0.001,   bfile_1000G = NULL,   save_logfiles = FALSE,   verbose = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_MRlap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用MRlap包分析交叉性状遗传相关性，矫正样本重叠引起的IVW-MR分析的偏差 — LDSC_MRlap","text":"exposure Twosample格式的完整暴露数据。 exposure_name 暴露特征的名称，默认为\"exposure\"。 outcome Twosample格式的完整结局数据。 outcome_name 结果特征的名称，默认为\"outcome\"。 ld 用于分析的LD分数所在文件夹的路径。期望的LD分数格式应符合原始LD分数回归软件的要求，默认\"./eur_w_ld_chr\"。 hm3 包含用于将等位基因对齐到特征之间的SNPs的alt、ref等位基因和rsid的文件路径，默认\"./eur_w_ld_chr/w_hm3.snplist\"。 do_pruning 逻辑值，指示是否应通过修剪来确定主导SNPs（如果为FALSE，则用户应提供user_SNPsToKeep，并且所有MR_参数将被忽略），默认为TRUE。 user_SNPsToKeep 作为工具变量使用的SNP RSIDs的向量（仅在do_pruning==FALSE时使用），默认为\"\"（character） MR_threshold 数值，用于选择MR分析的工具变量的阈值，应低于1e-5，默认为5e-8。 MR_pruning_dist 数值，MR分析去除连锁不平衡的窗口值，应在10—50000kb之间，默认为10000。 MR_pruning_LD 数值，MR分析去除连锁不平衡的LD阈值（r2），应在0和1之间（如果为0，则使用基于距离的修剪），默认为0.001。 MR_reverse 数值，用于排除与结局关联更强的MR分析的工具变量的p值，默认为1e-3。 bfile_1000G 1000G文件的参考面板文件的路径。 save_logfiles 逻辑值，指示是否保存LDSC的日志文件，默认为FALSE。 verbose 逻辑值，指示是否报告进度信息，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_MRlap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用MRlap包分析交叉性状遗传相关性，矫正样本重叠引起的IVW-MR分析的偏差 — LDSC_MRlap","text":"返回包含MRlap分析结果的列表","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_MRlap.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用MRlap包分析交叉性状遗传相关性，矫正样本重叠引起的IVW-MR分析的偏差 — LDSC_MRlap","text":"MRcorrection: \"observed_effect\"：IVW-MR 观察到的因果效应估计, \"observed_effect_se\"：IVW-MR 观察到的因果效应标准误差, \"m_IVs\"：使用的 IV 数量, \"IVs\"：使用的 IV 的 rsid, \"observed_effect_p\"：IVW-MR 观察到的因果效应 p 值, \"corrected_effect\"：校正后的因果效应估计, \"corrected_effect_se\"：校正后的因果效应标准误差, \"corrected_effect_p\"：校正后的因果效应 p 值, \"test_difference\"：用于测试观察到的和校正后的效应之间差异的检验统计量, \"p_difference\"：与用于测试观察到的和校正后的效应之间差异的检验统计量对应的 p 值。 LDSC: \"h2_exp\"：暴露数据遗传力估计, \"h2_exp_se\"：暴露数据遗传力标准误差, \"int_exp\"：暴露数据截距估计, \"h2_out\"：结局数据遗传力估计, \"h2_out_se\"：结局数据遗传力标准误差, \"int_out\"：结局数据截距估计, \"gcov\"：遗传协方差估计, \"gcov_se\"：遗传协方差标准误差, \"rg\"：遗传相关性估计, \"int_crosstrait\"：交叉性状截距估计, \"int_crosstrait_se\"：交叉性状截距标准误差。 GeneticArchitecture: \"polygenicity\"：暴露多基因性估计, \"perSNP_heritability\"：暴露每个SNP遗传力估计。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_h2.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldsc软件进行临床性状遗传力 — LDSC_py_h2","title":"使用ldsc软件进行临床性状遗传力 — LDSC_py_h2","text":"软件官网：https://github.com/bulik/ldsc，使用前请先使用LDSC_py_install函数配置ldsc软件环境。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_h2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldsc软件进行临床性状遗传力 — LDSC_py_h2","text":"","code":"LDSC_py_h2(   test_help = FALSE,   Sumstatsfile = \" \",   ref_ld_chr = \"./eur_w_ld_chr\",   w_ld_chr = \"./eur_w_ld_chr\",   opt_arguments = NULL,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_h2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldsc软件进行临床性状遗传力 — LDSC_py_h2","text":"test_help 是否调阅ldsc软件ldsc.py的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 ref_ld_chr 字符串，LD分数文件的目录路径，以 *.l2.ldscore.gz 结尾。 w_ld_chr 字符串，权重文件的目录路径。 opt_arguments ldsc软件ldsc.py的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_h2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldsc软件进行临床性状遗传力 — LDSC_py_h2","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置ldsc软件环境 — LDSC_py_install","title":"配置ldsc软件环境 — LDSC_py_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置ldsc软件环境 — LDSC_py_install","text":"","code":"LDSC_py_install(install_pip = TRUE, force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置ldsc软件环境 — LDSC_py_install","text":"install_pip TRUE或FALSE，是否安装pip，默认TRUE。 force TRUE或FALSE，是否重新安装ldsc软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_ph.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldsc软件进行分区遗传力计算 — LDSC_py_ph","title":"使用ldsc软件进行分区遗传力计算 — LDSC_py_ph","text":"软件官网：https://github.com/bulik/ldsc/wiki/Partitioned-Heritability，使用前请先使用LDSC_py_install函数配置ldsc软件环境。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_ph.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldsc软件进行分区遗传力计算 — LDSC_py_ph","text":"","code":"LDSC_py_ph(   test_help = FALSE,   Sumstatsfile = \"./BMI.sumstats.gz\",   ref_ld_chr = \"./1000G_EUR_Phase3_baseline/baseline.\",   w_ld_chr = \"./weights_hm3_no_hla/weights.\",   frqfile_chr = \"./1000G_Phase3_frq/1000G.EUR.QC.\",   opt_arguments = NULL,   save_name = \"BMI\",   save_path = \"./BMI\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_ph.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldsc软件进行分区遗传力计算 — LDSC_py_ph","text":"test_help 是否调阅ldsc软件ldsc.py的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 ref_ld_chr 字符串，LD分数文件路径/文件名前缀。 w_ld_chr 字符串，用于回归权重的LD Scores的文件路径/文件名前缀。 frqfile_chr SNP的频率质控文件。 opt_arguments ldsc软件ldsc.py的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_ph.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldsc软件进行分区遗传力计算 — LDSC_py_ph","text":"分区遗传力计算结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_ph.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用ldsc软件进行分区遗传力计算 — LDSC_py_ph","text":"分区遗传力计算结果解读： \"Category\"：注释类别（比如DHS,Coding等）, \"Prop._SNPs \"：SNPs 占比, \"Prop._h2\"：遗传度占比, \"Enrichment\"：Enrichment, \"Enrichment_std_error\"：Enrichment标准误, \"Enrichment_p\"：Enrichment P值, \"Coefficient \"：回归系数, \"Coefficient_std_error\"：回归系数标准误, \"Coefficient_z-score\"：回归系数Z值, 一般文献重点关注第三列的结果（Prop._h2）。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_rg.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldsc软件进行遗传相关性分析 — LDSC_py_rg","title":"使用ldsc软件进行遗传相关性分析 — LDSC_py_rg","text":"软件官网：https://github.com/bulik/ldsc，使用前请先使用LDSC_py_install函数配置ldsc软件环境。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_rg.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldsc软件进行遗传相关性分析 — LDSC_py_rg","text":"","code":"LDSC_py_rg(   test_help = FALSE,   Sumstatsfile = \" \",   ref_ld_chr = \"./eur_w_ld_chr\",   w_ld_chr = \"./eur_w_ld_chr\",   opt_arguments = NULL,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_rg.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldsc软件进行遗传相关性分析 — LDSC_py_rg","text":"test_help 是否调阅ldsc软件ldsc.py的帮助文档，默认FALSE。 Sumstatsfile 两个或多个.sumstats.gz格式文件路径，例如：c(\"./pgc_bip.sumstats.gz\",\"./pgc_scz.sumstats.gz\")。 ref_ld_chr 字符串，LD分数文件的目录路径，以 *.l2.ldscore.gz 结尾。 w_ld_chr 字符串，权重文件的目录路径。 opt_arguments ldsc软件ldsc.py的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_rg.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldsc软件进行遗传相关性分析 — LDSC_py_rg","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_SEG.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldsc软件进行组织或细胞类型特异性分析 — LDSC_py_SEG","title":"使用ldsc软件进行组织或细胞类型特异性分析 — LDSC_py_SEG","text":"软件官网：https://github.com/bulik/ldsc/wiki/Cell-type-specific-analyses，使用前请先使用LDSC_py_install函数配置ldsc软件环境。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_SEG.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldsc软件进行组织或细胞类型特异性分析 — LDSC_py_SEG","text":"","code":"LDSC_py_SEG(   test_help = FALSE,   Sumstatsfile = \"./BMI.sumstats.gz\",   ref_ld_chr = \"./1000G_EUR_Phase3_baseline/baseline.\",   w_ld_chr = \"./weights_hm3_no_hla/weights.\",   ref_ld_chr_cts = \"GTEx.ldcts\",   opt_arguments = NULL,   save_name = \"BMI\",   save_path = \"./BMI\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_SEG.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldsc软件进行组织或细胞类型特异性分析 — LDSC_py_SEG","text":"test_help 是否调阅ldsc软件ldsc.py的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 ref_ld_chr 字符串，LD分数文件路径/文件名前缀。 w_ld_chr 字符串，用于回归权重的LD Scores的文件路径/文件名前缀。 ref_ld_chr_cts .ldcts文件名，注意运行此函数时，必须将工作路径与.ldcts文件路径保持一致。 opt_arguments ldsc软件ldsc.py的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_SEG.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldsc软件进行组织或细胞类型特异性分析 — LDSC_py_SEG","text":"细胞类型特异性分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_sumstats.html","id":null,"dir":"Reference","previous_headings":"","what":"使用ldsc软件生成.sumstats.gz格式文件(表头：SNP A1 A2 N Z) — LDSC_py_sumstats","title":"使用ldsc软件生成.sumstats.gz格式文件(表头：SNP A1 A2 N Z) — LDSC_py_sumstats","text":"软件官网：https://github.com/bulik/ldsc，使用前请先使用LDSC_py_install函数配置ldsc软件环境。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_sumstats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用ldsc软件生成.sumstats.gz格式文件(表头：SNP A1 A2 N Z) — LDSC_py_sumstats","text":"","code":"LDSC_py_sumstats(   GWASfile = \" \",   GWAS_name = \" \",   N = NULL,   MAF_min = 0.01,   opt_arguments = NULL,   merge_alleles = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_sumstats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用ldsc软件生成.sumstats.gz格式文件(表头：SNP A1 A2 N Z) — LDSC_py_sumstats","text":"GWASfile 标准的TwosampelMR格式数据文件路径。 GWAS_name GWAS数据的名称。 N GWAS的样本量大小，如果TwosampelMR格式数据文件缺失样本量则需填写，默认NULL。 MAF_min 最小次要等位基因频率，默认0.01。 opt_arguments ldsc软件munge_sumstats.py的其他命令行参数，默认NULL。 merge_alleles 带有alt、ref和rsid的snp文件的路径，用于将性状(性状)间的等位基因进行对齐，例如：w_hm3.snplist。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/LDSC_py_sumstats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用ldsc软件生成.sumstats.gz格式文件(表头：SNP A1 A2 N Z) — LDSC_py_sumstats","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_genes_Manhattanplot.html","id":null,"dir":"Reference","previous_headings":"","what":"对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制 — MAGMA_genes_Manhattanplot","title":"对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制 — MAGMA_genes_Manhattanplot","text":"对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_genes_Manhattanplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制 — MAGMA_genes_Manhattanplot","text":"","code":"MAGMA_genes_Manhattanplot(   genes_out = \"./UC.genes.out.txt\",   gene_loc = \"./ENSGv110.coding.genes.txt\",   Del_CHR_X = TRUE,   Manhtn_plot = TRUE,   threshold_sig = \"bonferroni\",   Manhtn_gene_sig = 10,   signal_cex = 1,   width = 9,   height = 7,   save_name = \"MAGMA_gsa\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_genes_Manhattanplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制 — MAGMA_genes_Manhattanplot","text":"genes_out MAGMA_gene_based()函数生成的XXX.genes..txt文件路径。 gene_loc 基因的位置信息文件路径，MAGMA软件官网可下载文件。 Del_CHR_X 逻辑值，TRUE或FALSE，是否剔除X染色上的数据。 Manhtn_plot 逻辑值，TRUE或FALSE，是否绘制曼哈顿图。 threshold_sig 曼哈顿图的显著性阈值的虚线所在Y轴的位置，\"fdr\"或\"bonferroni\"矫正的阈值。 Manhtn_gene_sig 数值，显著基因标记标签的数量。 signal_cex 数值，显著基因在图形中圆点的大小。 width 图形宽度。 height 图形高度。 save_name 保存的pdf图形文件名，默认\"gsa_plot\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_genes_Manhattanplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制 — MAGMA_genes_Manhattanplot","text":"基因注释及多重矫正后结果","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gene_based.html","id":null,"dir":"Reference","previous_headings":"","what":"使用MAGMA软件进行gene-based & gene-set-based关联分析 — MAGMA_gene_based","title":"使用MAGMA软件进行gene-based & gene-set-based关联分析 — MAGMA_gene_based","text":"软件官网：https://cncr.nl/research/magma/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gene_based.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用MAGMA软件进行gene-based & gene-set-based关联分析 — MAGMA_gene_based","text":"","code":"MAGMA_gene_based(   GWAS_file = \"./ULCER_METAL_FinnGen.txt\",   bfile_1000G = \"./g1000_eur/g1000_eur\",   gene_loc = \"ENSGv110.coding.genes.txt\",   set_annot = \"MSigDB_20231Hs_MAGMA.txt\",   SNP_P_col = c(3, 10),   samplesize_col = \"N\",   save_name = \"UC\",   save_path = \"./UC\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gene_based.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用MAGMA软件进行gene-based & gene-set-based关联分析 — MAGMA_gene_based","text":"GWAS_file GWAS的文件路径。 bfile_1000G 1000G基因型数据文件路径，MAGMA软件官网可下载文件。 gene_loc 基因的位置信息文件路径，MAGMA软件官网可下载文件。 set_annot 基因集文件路径，下载地址：https://fuma.ctglab.nl/downloadPage。 SNP_P_col GWAS数据中SNP和P值所在列位置，向量格式如：c(3,10)。 samplesize_col GWAS数据中样本量的列名，或直接赋值样本量数量。 save_name 保存结果的文件名。 save_path 保存结果的文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gene_based.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用MAGMA软件进行gene-based & gene-set-based关联分析 — MAGMA_gene_based","text":"data 分析结果数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gsa_barplot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制MAGMA分析结果柱状图 — MAGMA_gsa_barplot","title":"绘制MAGMA分析结果柱状图 — MAGMA_gsa_barplot","text":"用于组织特异性和通路富集分析结果图形可视化。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gsa_barplot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制MAGMA分析结果柱状图 — MAGMA_gsa_barplot","text":"","code":"MAGMA_gsa_barplot(   gsa_out = \" \",   showNum = 60,   X_text_size = 7,   X_text_angle = 70,   Y_text_size = 10,   fdr = TRUE,   save_plot = TRUE,   pdf_name = \"gsa_plot\",   width = 9,   height = 7,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gsa_barplot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制MAGMA分析结果柱状图 — MAGMA_gsa_barplot","text":"gsa_out MAGMA_gene_based()或MAGMA_Tissue_specific()函数生成的XXX.gsa..txt文件路径。 showNum 绘制最显著的柱状数量。 X_text_size X轴字体大小。 X_text_angle X轴字体角度。 Y_text_size Y轴字体大小。 fdr TRUE或FALSE，是否进行fdr矫正绘图，默认为TRUE。 save_plot TRUE或FALSE，是否保存柱状图，默认为TRUE。 pdf_name 保存的pdf图形文件名，默认\"gsa_plot\"。 width 图形宽度。 height 图形高度。 save_path 图形文件保存路径，默认\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_gsa_barplot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制MAGMA分析结果柱状图 — MAGMA_gsa_barplot","text":"fdr矫正结果","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_Tissue_specific.html","id":null,"dir":"Reference","previous_headings":"","what":"使用MAGMA进行交叉组织特异性分析 — MAGMA_Tissue_specific","title":"使用MAGMA进行交叉组织特异性分析 — MAGMA_Tissue_specific","text":"软件官网：https://cncr.nl/research/magma/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_Tissue_specific.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用MAGMA进行交叉组织特异性分析 — MAGMA_Tissue_specific","text":"","code":"MAGMA_Tissue_specific(   genes_raw = \"./UC/UC.genes.raw\",   gene_covar = \"./gtex_v8_ts_avg_log2TPM.txt\",   save_name = \"UC\",   save_path = \"./UC\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_Tissue_specific.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用MAGMA进行交叉组织特异性分析 — MAGMA_Tissue_specific","text":"genes_raw MAGMA_gene_based()函数分析生成的XXX.genes.raw文件路径。 gene_covar 基因表达文件路径，下载地址：https://fuma.ctglab.nl/downloadPage。 save_name 保存结果的文件名。 save_path 保存结果的文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MAGMA_Tissue_specific.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用MAGMA进行交叉组织特异性分析 — MAGMA_Tissue_specific","text":"data 分析结果数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/METAL_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"使用METAL软件对GWAS进行meta分析 — METAL_gwas","title":"使用METAL软件对GWAS进行meta分析 — METAL_gwas","text":"使用METAL软件对全基因组关联研究(GWAS)数据进行META分析，电脑内存小容易运行崩溃，软件地址：https://github.com/explodecomputer/random-metal。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/METAL_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用METAL软件对GWAS进行meta分析 — METAL_gwas","text":"","code":"METAL_gwas(   GWASfile = c(\"./dat1.txt\", \"./dat1.txt\"),   SEPARATOR = \"TAB\",   snp_col = \"SNP\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   beta_col = \"beta\",   se_col = \"se\",   pval_col = \"pval\",   eaf_col = \"eaf\",   samplesize_col = \"N\",   chr_col = NULL,   pos_col = NULL,   analysis_method = \"SE\",   IVW_mode = \"Multiplicative\",   Genomic_Control_Correction = TRUE,   Average_FREQ = TRUE,   Heterogeneity = TRUE,   Sample_Overlap_Correction = TRUE,   OVERLAP_ZCUTOFF = 1,   Filter_MAF = NULL,   Filter_N = NULL,   Filter_SNPs = NULL,   save_path = \"./\",   save_name = \"METAANALYSIS\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/METAL_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用METAL软件对GWAS进行meta分析 — METAL_gwas","text":"GWASfile 向量，包含两个或多个GWAS数据文件的路径，如c(\"./dat1.txt\", \"./dat1.txt\")。 SEPARATOR 指定数据文件中列之间的分隔符，默认为\"TAB\"。 snp_col 必填，SNP列的名称。 effect_allele_col 必填，效应等位基因列的名称。 other_allele_col 必填，次要等位基因列的名称。 beta_col 必填，β值列的名称。 se_col 必填，标准误差列的名称。 pval_col 必填，P值列的名称。 eaf_col 非必填，效应等位基因频率列的名称；若缺失eaf值，请将设置Average_FREQ = FALSE。 samplesize_col 必填，样本量列的名称。 chr_col 染色体列的名称，默认为NULL，输入数据为GRCH38(hg38)或GRCH37(hg19)相同版本时填写，否则合并错误。 pos_col 坐标列的名称，默认为NULL，输入数据为GRCH38(hg38)或GRCH37(hg19)相同版本时填写，否则合并错误。 analysis_method \"SE\"或\"samplesize\"，SE表示逆方差加权法-IVW，samplesize表示基于样本量加权。 IVW_mode 逆方差加权法-IVW分析模式，默认随机效应模型 \"Multiplicative\"，固定效应模型填 \"Fixed\"。 Genomic_Control_Correction 逻辑值，是否进行基因组控制校正，默认为TRUE。 Average_FREQ TRUE或FALSE，是否计算平均频率，默认为TRUE。 Heterogeneity TRUE或FALSE，是否进行异质性分析，默认为TRUE。 Sample_Overlap_Correction TRUE或FALSE，是否进行样本重叠校正，默认为TRUE。 OVERLAP_ZCUTOFF 数值，样本重叠校正的Z截断值，默认为1。 Filter_MAF 数值，次要等位基因频率过滤值，默认为NULL。 Filter_N 数值，样本大小过滤值，默认为NULL。 Filter_SNPs 字符向量，需要过滤的SNP，默认为NULL。 save_path 分析结果保存路径，默认为\"./META_GWAS\"。 save_name 分析结果文件名，默认为\"METAANALYSIS\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/METAL_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用METAL软件对GWAS进行meta分析 — METAL_gwas","text":"无返回值，将执行GWAS分析并将结果保存到指定路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MetaXcan_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置MetaXcan软件环境 — MetaXcan_install","title":"配置MetaXcan软件环境 — MetaXcan_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MetaXcan_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置MetaXcan软件环境 — MetaXcan_install","text":"","code":"MetaXcan_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/MetaXcan_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置MetaXcan软件环境 — MetaXcan_install","text":"force TRUE或FALSE，是否重新安装MetaXcan软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate.html","id":null,"dir":"Reference","previous_headings":"","what":"MiXeR双变量跨性状分析 — MiXeR_Bivariate","title":"MiXeR双变量跨性状分析 — MiXeR_Bivariate","text":"本函数利用MiXeR算法对两个输入的GWAS数据集进行双变量跨性状分析，官网：https://github.com/precimed/mixer。 MiXeR软件对CPU要求很高，最低内存要求是可用RAM至少为32 GB。MiXeR能够高效地利用多核CPU，因此建议在至少具有16个物理核心的系统上运行MiXeR。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MiXeR双变量跨性状分析 — MiXeR_Bivariate","text":"","code":"MiXeR_Bivariate(   help = FALSE,   GWASfile = c(\"~/Desktop/test/SSGAC_EDU_2018_no23andMe_noMHC.csv.gz\",     \"~/Desktop/test/SCZ_qc_noMHC.csv.gz\"),   trait1_save_path = \"~/Desktop/test/SSGAC_EDU\",   trait2_save_path = \"~/Desktop/test/SCZ\",   bfile = \"./1000g\",   mixer_py = \"~/mixer/precimed/mixer.py\",   lib = \"~/mixer/src/build/lib/libbgmg.so\",   stars_rep = 1,   end_rep = 20,   fit2 = TRUE,   opt_arguments_fit = NULL,   opt_arguments_test = NULL,   save_path = \"./VS\",   cores = 24 )"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MiXeR双变量跨性状分析 — MiXeR_Bivariate","text":"help 逻辑值，若为TRUE则显示帮助信息，默认FALSE。 GWASfile 字符向量，包含两个GWAS汇总统计文件的路径，例如 c(\"path//trait1.csv.gz\", \"path//trait2.csv.gz\")。 trait1_save_path 字符型，保存性状1分析结果的文件夹路径。 trait2_save_path 字符型，保存性状2分析结果的文件夹路径。 bfile 字符型，参考数据的文件目录路径，数据下载地址：https://github.com/comorment/mixer/tree/main/reference/ldsc/1000G_EUR_Phase3_plink。 mixer_py 字符型，MiXeR Python可执行文件的路径，例如 \"~/mixer/precimed/mixer.py\"。 lib 字符型，库文件 libbgmg.的路径，例如 \"~/mixer/src/build/lib/libbgmg.\"。libbgmg.so文件需要预先编译软件获得。 stars_rep 整数，分析的起始重复编号，范围为1到20。 end_rep 整数，分析的结束重复编号，范围为1到20。 fit2 逻辑值，是否对每个重复项进行模型拟合；设为 TRUE 启用。设为 FALSE 表示，仅执行test，对指定的性状文件进行验证。 opt_arguments_fit 字符型，拟合步骤的附加可选参数，例如DiffEvo算法只循环1次（默认循环20次） '--diffevo-fast-repeats 1'。 opt_arguments_test 字符型，测试步骤的附加可选参数，默认为 NULL。 save_path 字符型，保存跨性状分析结果的路径，例如 \"./VS\"。 cores 数值型，指定线程数以加速计算，默认为8。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MiXeR双变量跨性状分析 — MiXeR_Bivariate","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate_visualize.html","id":null,"dir":"Reference","previous_headings":"","what":"MiXeR双变量跨性状分析可视化 — MiXeR_Bivariate_visualize","title":"MiXeR双变量跨性状分析可视化 — MiXeR_Bivariate_visualize","text":"此函数使用MiXeR算法对双变量跨性状分析结果进行可视化。具体展示两个性状的联合模型拟合结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate_visualize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MiXeR双变量跨性状分析可视化 — MiXeR_Bivariate_visualize","text":"","code":"MiXeR_Bivariate_visualize(   help = FALSE,   json_fit = \"./VS/SSGAC_EDU_2018_no23andMe_noMHC_vs_SCZ_qc_noMHC.fit.rep@.json\",   json_test = \"./VS/SSGAC_EDU_2018_no23andMe_noMHC_vs_SCZ_qc_noMHC.test.rep@.json\",   mixer_py = \"~/gsa-mixer/precimed/mixer_figures.py\",   statistic = \"mean std\",   trait1_name = \"EDU\",   trait2_name = \"SCZ\",   trait1_color = 0,   trait2_color = 1,   flip = FALSE,   opt_arguments_fit = NULL,   opt_arguments_test = NULL,   opt_arguments_two = NULL,   save_name = \"VS\",   save_path = \"./combined\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate_visualize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MiXeR双变量跨性状分析可视化 — MiXeR_Bivariate_visualize","text":"help 逻辑值，若为TRUE则显示帮助信息，默认FALSE。 json_fit 字符型，包含拟合分析结果的JSON文件路径。 json_test 字符型，包含测试分析结果的JSON文件路径。 mixer_py 字符型，MiXeR的Python脚本路径，用于可视化（如\"~/mixer/precimed/mixer_figures.py\"）。 statistic 字符型，指定可视化时的统计方法，默认设置为\"mean std\"。 trait1_name 字符型，性状1的名称。 trait2_name 字符型，性状2的名称。 trait1_color 数值型，韦恩图中性状1的颜色，可选择0~8。 trait2_color 数值型，韦恩图中性状2的颜色，可选择0~8。 flip 逻辑值，是否翻转图片，默认FALSE。 opt_arguments_fit 字符型，可选参数，用于传递给mixer_figures.py combinefit分析的额外参数，默认为NULL。 opt_arguments_test 字符型，可选参数，用于传递给mixer_figures.py combinetest分析的额外参数，默认为NULL。 opt_arguments_two 字符型，可选参数，用于传递给mixer_figures.py two分析的额外参数，默认为NULL。 save_name 字符型，保存可视化结果的文件名，默认为\"Bivariate_visualize\"。 save_path 字符型，结果保存路径，默认为\"./combined\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate_visualize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MiXeR双变量跨性状分析可视化 — MiXeR_Bivariate_visualize","text":"返回分析结果数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Bivariate_visualize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MiXeR双变量跨性状分析可视化 — MiXeR_Bivariate_visualize","text":"","code":"MiXeR_Bivariate_visualize(    json_fit = \"./VS/SSGAC_EDU_2018_no23andMe_noMHC_vs_SCZ_qc_noMHC.fit.rep@.json\",    json_test = \"./VS/SSGAC_EDU_2018_no23andMe_noMHC_vs_SCZ_qc_noMHC.test.rep@.json\",    mixer_py = \"~/mixer/precimed/mixer_figures.py\",    statistic = \"mean std\",    save_name = \"VS\",    save_path = \"./combined\" ) #> ℹ 正在进行双变量跨性状分析可视化绘图，请稍后... #>  #>  #>  #> Error: './combined/VS.csv' does not exist in current working directory ('C:/Users/19662/Desktop/QTLMR/docs/reference')."},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_format_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"MiXeR分析输入数据格式转换 — MiXeR_format_dat","title":"MiXeR分析输入数据格式转换 — MiXeR_format_dat","text":"该函数用于将GWAS数据文件格式转换为适用于MiXeR的输入格式，执行基本质控，并在需要时计算有效样本量。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_format_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MiXeR分析输入数据格式转换 — MiXeR_format_dat","text":"","code":"MiXeR_format_dat(   GWASfile = \"./ieu-a-30_MTAG_IEU.txt\",   ncase = 5956,   ncontrol = 14927,   opt_arguments_csv = NULL,   opt_arguments_qc = NULL,   exclude_ranges = \"6:26000000-34000000\",   save_name = \"CD\",   save_path = \"./CD_dat\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_format_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MiXeR分析输入数据格式转换 — MiXeR_format_dat","text":"GWASfile 字符型，MTAG格式数据文件路径，可由format_dat()函数转换获得。 ncase 数值型，病例数，二分类GWAS数据需填写，用于公式:neff = 4 / (1/ncase + 1/ncontrol)计算有效样本量。连续性类GWAS数据，则填写NULL。 ncontrol 数值型，对照组数量，二分类GWAS数据需填写，用于公式:neff = 4 / (1/ncase + 1/ncontrol)计算有效样本量。连续性类GWAS数据，则填写NULL。 opt_arguments_csv 字符型，可选参数，用于传递sumstats.py csv参数，默认为NULL。 opt_arguments_qc 字符型，可选参数，用于传递sumstats.py qc额外参数，默认为NULL。 exclude_ranges 字符型，需排除的染色体范围，默认是\"6:26000000-34000000\"，即排除MHC区域。 save_name 字符型，保存的文件名。 save_path 字符型，转换后文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_format_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MiXeR分析输入数据格式转换 — MiXeR_format_dat","text":"返回格式化和质控后的文件，适用于MiXeR分析。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_format_dat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MiXeR分析输入数据格式转换 — MiXeR_format_dat","text":"","code":"MiXeR_format_dat(GWASfile = \"./ieu-a-30_MTAG_IEU.txt\",                  ncase = 5956,                  ncontrol = 14927,                  opt_arguments_csv = NULL,                  opt_arguments_qc = NULL,                  exclude_ranges = \"6:26000000-34000000\",                  save_name = \"CD\",                  save_path = \"./CD_dat\") #> ℹ 正在格式转换，请稍后... #>  #>  #>  #> ✔ 数据格式成功转换! #> Time difference of 5.464748 secs"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置MiXeR软件环境 — MiXeR_install","title":"配置MiXeR软件环境 — MiXeR_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置MiXeR软件环境 — MiXeR_install","text":"","code":"MiXeR_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置MiXeR软件环境 — MiXeR_install","text":"force TRUE或FALSE，是否重新安装MiXeR软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_run.html","id":null,"dir":"Reference","previous_headings":"","what":"MiXeR分析 — MiXeR_run","title":"MiXeR分析 — MiXeR_run","text":"该函数用于运行MiXeR分析，包括单变量和双变量模型的拟合与可视化。通过给定的GWAS文件进行分析，保存结果并生成相应的图形。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MiXeR分析 — MiXeR_run","text":"","code":"MiXeR_run(   GWASfile = c(\"./SSGAC_EDU_2018_no23andMe_noMHC.csv.gz\", \"./SCZ_qc_noMHC.csv.gz\"),   GWASname = c(\"EDU\", \"SCZ\"),   bfile = \"./1000g\",   mixer_py = \"./mixer/precimed/mixer.py\",   mixer_figures_py = \"./mixer/precimed/mixer_figures.py\",   lib = \"./mixer/src/build/lib/libbgmg.so\",   statistic = \"mean std\",   fit1_diffevo_fast_repeats = 20,   fit2_diffevo_fast_repeats = 1,   save_path = \"./MiXeR\",   cores = 85 )"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MiXeR分析 — MiXeR_run","text":"GWASfile 一个字符串向量，包含需要分析的GWAS文件路径，由MiXeR_format_dat()函数转换获得。例如c(\"./SSGAC_EDU_2018_no23andMe_noMHC.csv.gz\",\"./SCZ_qc_noMHC.csv.gz\")。 GWASname 一个字符串向量，表示与每个GWAS文件相对应的名称，用于结果保存和可视化的标识。 bfile 字符型，参考数据的文件目录路径，数据下载地址：https://github.com/comorment/mixer/tree/main/reference/ldsc/1000G_EUR_Phase3_plink。 mixer_py MiXeR Python脚本的路径，用于执行MiXeR分析。 mixer_figures_py MiXeR Python脚本的路径，用于生成分析结果的图形。 lib 字符型，库文件 libbgmg.的路径，例如 \"~/mixer/src/build/lib/libbgmg.\"。libbgmg.so文件需要预先编译软件获得。 statistic 用于可视化的统计类型，支持的统计值有\"mean\"和\"std\"。 fit1_diffevo_fast_repeats 单变量分析中，Diffevo快速拟合的重复次数。 fit2_diffevo_fast_repeats 双变量分析中，Diffevo快速拟合的重复次数。 save_path 结果保存的文件夹路径。如果文件夹不存在，则自动创建。 cores 用于并行计算的核心数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MiXeR分析 — MiXeR_run","text":"NULL 返回值为NULL，但会在指定的save_path文件夹中保存分析结果和图形。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"MiXeR分析 — MiXeR_run","text":"该函数首先进行单变量MiXeR分析并可视化结果，然后针对多个GWAS文件进行双变量MiXeR分析和可视化。每个分析过程将保存到指定路径，并生成相关的图表文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate.html","id":null,"dir":"Reference","previous_headings":"","what":"MiXeR单变量分析 — MiXeR_Univariate","title":"MiXeR单变量分析 — MiXeR_Univariate","text":"使用MiXeR工具对给定的GWAS数据进行单变量分析。官网：https://github.com/precimed/mixer。 MiXeR软件对CPU要求很高，最低内存要求是可用RAM至少为32 GB。MiXeR能够高效地利用多核CPU，因此建议在至少具有16个物理核心的系统上运行MiXeR。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MiXeR单变量分析 — MiXeR_Univariate","text":"","code":"MiXeR_Univariate(   help = FALSE,   GWASfile = \"./SSGAC_EDU_2018_no23andMe_noMHC.csv.gz\",   bfile = \"~/1000g\",   mixer_py = \"./mixer/precimed/mixer.py\",   lib = \"./mixer/src/build/lib/libbgmg.so\",   stars_rep = 1,   end_rep = 20,   fit1 = TRUE,   opt_arguments_fit = NULL,   opt_arguments_test = NULL,   save_path = \"./SSGAC_EDU\",   cores = 8 )"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MiXeR单变量分析 — MiXeR_Univariate","text":"help 逻辑值，若为TRUE则显示帮助信息，默认FALSE。 GWASfile 字符型，包含GWAS数据的文件路径，默认值为\"./SSGAC_EDU_2018_no23andMe_noMHC.csv.gz\"。 bfile 字符型，参考数据的文件目录路径，数据下载地址：https://github.com/comorment/mixer/tree/main/reference/ldsc/1000G_EUR_Phase3_plink。 mixer_py 字符型，MiXeR Python可执行文件的路径，例如 \"~/mixer/precimed/mixer.py\"。 lib 字符型，库文件 libbgmg.的路径，例如 \"~/mixer/src/build/lib/libbgmg.\"。libbgmg.so文件需要预先编译软件获得。 stars_rep 数值型，开始迭代的重复次数，默认为1，取值范围为1到20。 end_rep 数值型，结束迭代的重复次数，默认为20，取值范围为1到20。 fit1 逻辑值，是否对每个重复项进行模型拟合；设为 TRUE 启用。设为 FALSE 表示，仅执行test，对指定的性状文件进行验证。 opt_arguments_fit 字符型，拟合步骤的附加可选参数，例如DiffEvo算法只循环1次（默认循环20次） '--diffevo-fast-repeats 1'。 opt_arguments_test 字符型，测试步骤的附加可选参数，默认为 NULL。 save_path 字符型，保存结果的路径，默认值为\"./SSGAC_EDU\"。 cores 数值型，指定线程数以加速计算，默认为8。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MiXeR单变量分析 — MiXeR_Univariate","text":"返回fit1和test1分析生成的结果文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate_visualize.html","id":null,"dir":"Reference","previous_headings":"","what":"MiXeR单变量分析可视化 — MiXeR_Univariate_visualize","title":"MiXeR单变量分析可视化 — MiXeR_Univariate_visualize","text":"使用MiXeR的mixer_figures.py脚本对单变量分析结果进行可视化。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate_visualize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MiXeR单变量分析可视化 — MiXeR_Univariate_visualize","text":"","code":"MiXeR_Univariate_visualize(   help = FALSE,   json_fit = \"./SCZ/SCZ_qc_noMHC.fit.rep@.json\",   mixer_py = \"~/mixer/precimed/mixer_figures.py\",   statistic = \"mean std\",   opt_arguments = NULL,   save_name = \"SCZ_Univariate_visualize\",   save_path = \"./plot\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate_visualize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MiXeR单变量分析可视化 — MiXeR_Univariate_visualize","text":"help 逻辑型，是否显示帮助信息，默认为FALSE。 json_fit 字符型，指定fit1分析结果的JSON文件路径。例如\"./SCZ/SCZ_qc_noMHC.fit.rep@.json\"。 mixer_py 字符型，可视化脚本mixer_figures.py的路径，例如\"~/mixer/precimed/mixer_figures.py\"。 statistic 字符型，指定生成图表的统计指标，默认为\"mean std\"。 opt_arguments 字符型，可选参数，用于传递给mixer_figures.py combinefit分析的额外参数，默认为NULL。 save_name 字符型，保存文件的名称前缀。 save_path 字符型，指定图表保存的路径，默认为\"./plot\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate_visualize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MiXeR单变量分析可视化 — MiXeR_Univariate_visualize","text":"返回可视化分析结果的CSV数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MiXeR_Univariate_visualize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MiXeR单变量分析可视化 — MiXeR_Univariate_visualize","text":"","code":"MiXeR_Univariate_visualize(json_fit = \"./SCZ/SCZ_qc_noMHC.fit.rep@.json\",                            mixer_py = \"~/mixer/precimed/mixer_figures.py\",                            statistic = \"mean std\",                            help = FALSE,                            opt_arguments = NULL,                            save_name = \"SCZ_Univariate_visualize\",                            save_path = \"./plot\") #> ℹ 正在进行单变量分析可视化绘图，请稍后... #>  #>  #> Error: './plot/SCZ_Univariate_visualize.csv' does not exist in current working directory ('C:/Users/19662/Desktop/QTLMR/docs/reference')."},{"path":"https://hortoner.github.io/QTLMR/reference/modified_harmonise_proxy_Ensembl.html","id":null,"dir":"Reference","previous_headings":"","what":"本地数据harmonise并基于Ensembl数据库代理SNP — modified_harmonise_proxy_Ensembl","title":"本地数据harmonise并基于Ensembl数据库代理SNP — modified_harmonise_proxy_Ensembl","text":"本地数据harmonise并基于Ensembl数据库代理SNP","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_harmonise_proxy_Ensembl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"本地数据harmonise并基于Ensembl数据库代理SNP — modified_harmonise_proxy_Ensembl","text":"","code":"modified_harmonise_proxy_Ensembl(   exposure_dat,   outcome_dat,   num = 1,   r2_thershold = 0.8,   build = \"37\",   pop = \"EUR\",   save_path = \"./\",   save_name = \"harmonise_dat\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/modified_harmonise_proxy_Ensembl.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"本地数据harmonise并基于Ensembl数据库代理SNP — modified_harmonise_proxy_Ensembl","text":"exposure_dat TwosampleMR格式暴露数据。 outcome_dat TwosampleMR格式结局数据。 num 代理SNP数目的起始位置。 r2_thershold 代理SNP连锁不平衡r2过滤阈值，默认0.8。 build 需指定暴露数据参考的人类基因组类型,\"37\"或\"38\" pop 人群种族,默认为\"EUR\"。 save_path 数据保存路径，默认为当前文件夹\"./\"。 save_name 分析结果文件名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_harmonise_proxy_Ensembl.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"本地数据harmonise并基于Ensembl数据库代理SNP — modified_harmonise_proxy_Ensembl","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_proxy_1000G.html","id":null,"dir":"Reference","previous_headings":"","what":"本地数据提取结局数据并基于1000G代理SNP — modified_proxy_1000G","title":"本地数据提取结局数据并基于1000G代理SNP — modified_proxy_1000G","text":"本地数据提取结局数据并基于1000G代理SNP","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_proxy_1000G.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"本地数据提取结局数据并基于1000G代理SNP — modified_proxy_1000G","text":"","code":"modified_proxy_1000G(   snps,   GWASfile = \" \",   proxies = T,   rsq = 0.8,   kb = 5000,   nsnp = 5000,   maf_threshold = 0.3,   bfile_1000G = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/modified_proxy_1000G.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"本地数据提取结局数据并基于1000G代理SNP — modified_proxy_1000G","text":"snps 暴露数据的SNP。 GWASfile TwosampleMR格式的完整结局数据路径。 proxies 是否寻找代理的SNP。 rsq 代理SNP连锁不平衡r2过滤阈值，默认0.8。 kb 连锁不平衡窗口大小，默认5000。 nsnp SNP的数量，默认5000。 maf_threshold 次要等位基因频率MAF过滤阈值，默认0.3。 bfile_1000G 1000G基因型数据文件路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_proxy_1000G.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"本地数据提取结局数据并基于1000G代理SNP — modified_proxy_1000G","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_Proxy_SNP_LDlink.html","id":null,"dir":"Reference","previous_headings":"","what":"本地数据提取结局数据并基于LDlink代理SNP — modified_Proxy_SNP_LDlink","title":"本地数据提取结局数据并基于LDlink代理SNP — modified_Proxy_SNP_LDlink","text":"本地数据提取结局数据并基于LDlink代理SNP","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_Proxy_SNP_LDlink.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"本地数据提取结局数据并基于LDlink代理SNP — modified_Proxy_SNP_LDlink","text":"","code":"modified_Proxy_SNP_LDlink(   exposure_dat,   outcome_dat,   r2 = 0.8,   pop = \"EUR\",   build_exposure = \"grch37\",   build_outcome = \"grch37\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/modified_Proxy_SNP_LDlink.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"本地数据提取结局数据并基于LDlink代理SNP — modified_Proxy_SNP_LDlink","text":"exposure_dat TwoSampleMR格式暴露数据。 outcome_dat TwoSampleMR格式完整结局数据。 r2 代理SNP连锁不平衡r2阈值。 pop 人群种族,默认为\"EUR\"。 build_exposure 需指定暴露数据参考的人类基因组类型,\"grch37\"或\"grch38\"。 build_outcome 需指定结局数据参考的人类基因组类型,\"grch37\"或\"grch38\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/modified_Proxy_SNP_LDlink.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"本地数据提取结局数据并基于LDlink代理SNP — modified_Proxy_SNP_LDlink","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MRPRESSO_outliers_snp.html","id":null,"dir":"Reference","previous_headings":"","what":"MR-PRESSO逐一剔除水平多效性的SNP — MRPRESSO_outliers_snp","title":"MR-PRESSO逐一剔除水平多效性的SNP — MRPRESSO_outliers_snp","text":"如果存在水平多效性的SNP，采用MRPRESSO方法将outliers的p值从小到大逐一剔除SNP，直至global p>0.05，详见：PMID: 36810112。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MRPRESSO_outliers_snp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MR-PRESSO逐一剔除水平多效性的SNP — MRPRESSO_outliers_snp","text":"","code":"MRPRESSO_outliers_snp(dat, NbDistribution = 1000)"},{"path":"https://hortoner.github.io/QTLMR/reference/MRPRESSO_outliers_snp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MR-PRESSO逐一剔除水平多效性的SNP — MRPRESSO_outliers_snp","text":"dat harmonise_data后的数据。 NbDistribution 运算迭代的次数，默认1000。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MRPRESSO_outliers_snp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MR-PRESSO逐一剔除水平多效性的SNP — MRPRESSO_outliers_snp","text":"list 剔除多效性SNP后的dat数据及MR-PRESSO检验结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MR_JTI_Beta.html","id":null,"dir":"Reference","previous_headings":"","what":"计算MR_JTI结果的beta值及95% CI — MR_JTI_Beta","title":"计算MR_JTI结果的beta值及95% CI — MR_JTI_Beta","text":"软件官网：https://github.com/gamazonlab/MR-JTI?tab=readme-ov-file。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MR_JTI_Beta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"计算MR_JTI结果的beta值及95% CI — MR_JTI_Beta","text":"","code":"MR_JTI_Beta(   GWASfile = \"./EC/EC_TwosampleMR_Catalog.txt\",   Gene_name = \"CYP19A1\",   tissues_V8 = \"Adipose - Subcutaneous\",   bfile_1000G = \"./1000G.EUR.QC\",   cis_wind_kb = 1000,   clump_r2 = 0.01,   build = 38,   n_genes = 4,   opt_arguments = NULL,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MR_JTI_Beta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"计算MR_JTI结果的beta值及95% CI — MR_JTI_Beta","text":"GWASfile 标准的TwosampelMR结局格式数据文件路径。 Gene_name 要分析的基因名称。 tissues_V8 eqtl数据来源GTEx_V8的组织类型，默认是全血\"Adipose - Subcutaneous\"，可通过data_info_GTEx_V8_samplesize()查找。 bfile_1000G 1000G基因型数据文件路径。 cis_wind_kb 指定顺式eQTL的上下游范围，默认1000kb，即1MB。 clump_r2 对eQTL进行clump的r2值大小，默认0.01。 build 37或38，人类参考基因组版本，默认38。 n_genes 多重检验的基因总数(Bonferroni校正)，即单个组织阳性结果的基因数量。n_genes = 1表示用户只需要名义显著性水平(即P<0.05将被视为显著)。 opt_arguments 其他命令行参数(可通过官网查看，如–n_folds，–n_bootstrap等)，默认NULL。。 save_path 结果文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MR_JTI_Beta.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"计算MR_JTI结果的beta值及95% CI — MR_JTI_Beta","text":"计算结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_cross_gwas.html","id":null,"dir":"Reference","previous_headings":"","what":"使用MTAG进行跨性状表型meta分析 — MTAG_cross_gwas","title":"使用MTAG进行跨性状表型meta分析 — MTAG_cross_gwas","text":"软件官网：https://github.com/JonJala/mtag/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_cross_gwas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用MTAG进行跨性状表型meta分析 — MTAG_cross_gwas","text":"","code":"MTAG_cross_gwas(   test_help = FALSE,   GWASfile = c(\"./dat1.txt\", \"./dat1.txt\"),   snp_col = \"SNP\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   beta_col = \"beta\",   se_col = \"se\",   pval_col = \"pval\",   eaf_col = \"eaf\",   samplesize_col = \"N\",   Zscores_col = \"Z\",   maf_min = 0.01,   merged_sig_pval = 5e-08,   n_min = NULL,   no_overlap = FALSE,   perfect_gencov = FALSE,   equal_h2 = FALSE,   fdr = TRUE,   opt_arguments = NULL,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_cross_gwas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用MTAG进行跨性状表型meta分析 — MTAG_cross_gwas","text":"test_help 是否调阅MTAG软件mtag.py的帮助文档，默认FALSE。 GWASfile 包含两个或多个GWAS数据文件的路径，可由format_dat()转换获得。 snp_col SNP列的名称。 effect_allele_col 效应等位基因列的名称。 other_allele_col 次要等位基因列的名称。 beta_col β值列的名称。 se_col 标准误差列的名称。 pval_col P值列的名称。 eaf_col 效应等位基因频率列的名称。 samplesize_col 样本量列的名称。 Zscores_col Z-scores列的名称。 maf_min 默认0.01，用于过滤maf<0.01的罕见SNP。 merged_sig_pval 跨性状分析合并结果SNP的显著性阈值，默认5e-8，若设置为NULL则不合并数据。 n_min 指定GWAS数据中SNP的样本量下限。 no_overlap 假定在输入GWAS汇总统计数据之间没有样本重叠，默认为FALSE。 perfect_gencov 假定每个GWAS都是针对同一\"性状\"的不同测量值，默认为FALSE。 equal_h2 假设所有性状传递给MTAG具有相同的遗传性，默认为FALSE。 fdr 执行maxFDR分析，默认为TRUE。 opt_arguments MTAG软件mtag.py的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_cross_gwas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用MTAG进行跨性状表型meta分析 — MTAG_cross_gwas","text":"跨性状分析合并结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置MTAG软件环境 — MTAG_install","title":"配置MTAG软件环境 — MTAG_install","text":"软件官网：https://github.com/JonJala/mtag。请预先安装miniconda：https://repo.anaconda.com/miniconda/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置MTAG软件环境 — MTAG_install","text":"","code":"MTAG_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/MTAG_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置MTAG软件环境 — MTAG_install","text":"force TRUE或FALSE，是否重新安装HESS软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://hortoner.github.io/QTLMR/reference/PLACO_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"使用PLACO进行复合零假设下的多效性分析 — PLACO_analysis","title":"使用PLACO进行复合零假设下的多效性分析 — PLACO_analysis","text":"软件官网：https://github.com/RayDebashree/PLACO。 输入数据必须包含以SNP, CHR, BP, effect_allele, other_allele、pval、Z为列名数据内容。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PLACO_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用PLACO进行复合零假设下的多效性分析 — PLACO_analysis","text":"","code":"PLACO_analysis(   GWASfile = c(\"./dat1.txt\", \"./dat1.txt\"),   p_threshold = 5e-08,   filer_Zscores = TRUE,   FDR_method = \"fdr\",   decor = FALSE,   save_path = \"./\",   cores = 4 )"},{"path":"https://hortoner.github.io/QTLMR/reference/PLACO_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用PLACO进行复合零假设下的多效性分析 — PLACO_analysis","text":"GWASfile 包含两个或多个GWAS数据文件的路径，如c(\"./dat1.txt\", \"./dat1.txt\")，建议使用format_dat()转换的MTAG格式数据。 p_threshold SNP的显著性阈值，默认为5e-8。 filer_Zscores 是否剔除Z分数的平方大于80的SNP。默认TRUE，因为极大的效应量可以影响PLACO显示伪信号。 FDR_method 对结果进行多重检验矫正的方法。\"bonferroni\"或\"fdr\"（则矫正筛选qvalue<0.05），或数值（如5e-8，则不矫正筛选p.placo<5e-8）。 decor 是否取消Z分数的关联，默认FALSE。如果性状是相互依赖或相互关联，建议TRUE。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PLACO_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用PLACO进行复合零假设下的多效性分析 — PLACO_analysis","text":"多效性遗传变异SNV。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_Coloc_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"PWCOCO与Coloc分析的基因组区域数据提取 — PWCOCO_Coloc_dat","title":"PWCOCO与Coloc分析的基因组区域数据提取 — PWCOCO_Coloc_dat","text":"根据index基因/SNP信息,提取指定基因组区域GWAS数据，用于后续PWCOCO与Coloc分析。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_Coloc_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"PWCOCO与Coloc分析的基因组区域数据提取 — PWCOCO_Coloc_dat","text":"","code":"PWCOCO_Coloc_dat(   GWAS_stats1 = \" \",   GWAS_stats2 = \" \",   gene = NULL,   index_SNP = NULL,   wind_kb = 1000,   build = 37,   PWCOCO = TRUE,   Coloc = TRUE,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_Coloc_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"PWCOCO与Coloc分析的基因组区域数据提取 — PWCOCO_Coloc_dat","text":"GWAS_stats1 标准Twosample格式性状1 GWAS数据的文件路径，数据文件必须包含染色体及坐标信息。 GWAS_stats2 标准Twosample格式性状2 GWAS数据的文件路径，数据文件必须包含染色体及坐标信息。 gene index基因名称或者ENSG ID。注意：只能选择gene与index_SNP其中一个填写。 index_SNP index SNP名称，建议为lead SNP或top SNP。注意：只能选择gene与index_SNP其中一个填写。 wind_kb index基因/SNP的基因座上下游范围，默认1000kb，即1000000bp。 build GWAS数据的基因组版本，37或38。注意：GWAS_stats1与GWAS_stats2必须是相同基因组版本！ PWCOCO 逻辑值，是否保存数据提取后PWCOCO输入格式数据。 Coloc 逻辑值，是否保存数据提取后Coloc输入格式数据。 save_path 结果文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_Coloc_dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"PWCOCO与Coloc分析的基因组区域数据提取 — PWCOCO_Coloc_dat","text":"无返回值。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_run.html","id":null,"dir":"Reference","previous_headings":"","what":"使用PWCOCO进行成对条件与共定位分析 — PWCOCO_run","title":"使用PWCOCO进行成对条件与共定位分析 — PWCOCO_run","text":"PWCOCO算法集成了来自 GCTA-COJO和cococ R包的方法。官网：https://github.com/jwr-git/pwcoco。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用PWCOCO进行成对条件与共定位分析 — PWCOCO_run","text":"","code":"PWCOCO_run(   bfile = \"./1.data/1000G/EUR\",   sum_stats1 = \"./data/atp1a4_test.exp.txt\",   sum_stats2 = \"./data/atp1a4_test.out.txt\",   p_cutoff1 = 5e-08,   p_cutoff2 = 5e-08,   chr = 1,   top_snp = 1e+10,   ld_window = 1e+07,   collinear = 0.9,   maf = 0.1,   freq_threshold = 0.2,   init_h4 = 80,   out_cond = TRUE,   coloc_pp = c(1e-04, 1e-04, 1e-05),   n1 = 6601,   n2 = 115803,   n1_case = NULL,   n2_case = NULL,   pve1 = NULL,   pve2 = NULL,   pve_file1 = NULL,   pve_file2 = NULL,   threads = 8,   save_name = \"pwcoco_out\",   save_path = \"./pwcoco\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用PWCOCO进行成对条件与共定位分析 — PWCOCO_run","text":"bfile 参考数据集文件路径，通常为Plink的bed/bim/fam格式文件。该文件的三个部分（bed、bim、fam）需要同名且位于同一目录下。 sum_stats1 性状1 GWAS数据的文件路径，示例数据：https://github.com/jwr-git/pwcoco/tree/master/data，格式要求详见下面的details描述。 sum_stats2 性状2 GWAS数据的文件路径，示例数据：https://github.com/jwr-git/pwcoco/tree/master/data，格式要求详见下面的details描述。 p_cutoff1 性状1数据集的P值截断值，用于筛选显著的SNPs，默认为5e-8。 p_cutoff2 性状2数据集的P值截断值，用于筛选显著的SNPs，默认为5e-8。 chr 指定染色体编号，仅对参考基因型数据集中的该染色体上的SNPs进行分析。 top_snp 最大允许选择的SNP数量，默认值为1e10，意味着不限制SNP数量。 ld_window 连锁不平衡（LD）窗口大小，单位为kb。当SNPs之间的距离超过该阈值时，认为它们不在连锁不平衡中，默认值为1e7。 collinear SNPs之间的共线性阈值，若两个SNP的相关系数超过该值，则认为它们是共线性SNP，默认值为0.9。 maf 最低等位基因频率（MAF）阈值，用于过滤参考基因型数据集中的SNPs，默认值为0.1。 freq_threshold 参考基因型数据集中，SNP在两个表型数据集中的频率差异超过该阈值时，排除该SNP，默认值为0.2。 init_h4 初步共定位分析的H4值阈值。若初步分析的H4（即假设四种共定位模式的后验概率）达到该值，程序将提前停止，默认值为80（表示80%的概率）。设置为0时，程序将始终继续分析。 out_cond 是否保存条件分析后的数据为文本文件。默认为TRUE，表示保存。 coloc_pp 三个先验概率P值的向量，表示在共定位分析中假设的先验概率，默认为c(1e-4, 1e-4, 1e-5)。 n1 性状1数据集的样本量大小，若sum_stats1数据已包含该列，可填写NULL。 n2 性状2数据集的样本量大小，若sum_stats2数据已包含该列，可填写NULL。 n1_case 性状1数据集中的病例数，若sum_stats1数据已包含该列或数据类型为连续型，可填写NULL。 n2_case 性状2数据集中的病例数，若sum_stats2数据已包含该列或数据类型为连续型，可填写NULL。 pve1 性状1数据集的表型方差解释（PVE）值，用于估算遗传预测的表型的方差贡献（如果适用），可填写NULL。 pve2 性状2数据集的表型方差解释（PVE）值，用于估算遗传预测的表型的方差贡献（如果适用），可填写NULL。 pve_file1 性状1数据集的PVE文件路径，用于指定表型方差解释的文件（如果适用），可填写NULL。 pve_file2 性状2数据集的PVE文件路径，用于指定表型方差解释的文件（如果适用），可填写NULL。 threads 可用的线程数，支持并行计算，默认值为8。 save_name 结果文件的保存名称前缀，默认为\"pwcoco_out\"。 save_path 结果文件保存路径，默认为\"./pwcoco\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用PWCOCO进行成对条件与共定位分析 — PWCOCO_run","text":"返回一个包含共定位分析结果的数据框（data frame），该数据框包括每个SNP的共定位分析结果，如H4值、P值等。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/PWCOCO_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用PWCOCO进行成对条件与共定位分析 — PWCOCO_run","text":"输入sum_stats文件格式要求：表型文件不需要特定的文件格式，而是需要遵循以下结构： SNP    A1    A2    A1_freq    beta    se    p    n    case 其中，各列的名称不重要，重要的是数据的顺序。具体来说，文件应包括以下列： SNP：SNP的标识符。 A1：效应等位基因（通常是变异等位基因）。 A2：参考等位基因。 A1_freq：效应等位基因的频率。 beta：效应大小，表示SNP与表型的关联程度。 se：标准误差，表示效应大小估计的精确度。 p：P值，表示SNP与表型关联的统计显著性。 n：样本总数（可选），用于病例对照研究（case/control study）中的样本总数。 case：病例数（可选），用于病例对照研究中的病例数。 对于二分类数据，n和case列是可选的。包括这些列时，PWCoCo会将数据视为二分类数据数据（case/control data）进行共定位分析， 而不是连续型数据（quantitative data），连续型数据只需要n列（样本总数）。这些列也可以通过命令行参数传递。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/remove_MHC_data.html","id":null,"dir":"Reference","previous_headings":"","what":"移除MHC区域的SNP数据 — remove_MHC_data","title":"移除MHC区域的SNP数据 — remove_MHC_data","text":"MHC对疾病的影响及此区域的SNP过于强大，与结局的关联强度及其复杂的LD结构使其容易受到水平多效性和违反MR假设的影响。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/remove_MHC_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"移除MHC区域的SNP数据 — remove_MHC_data","text":"","code":"remove_MHC_data(   dat,   chr_col = \"chr.exposure\",   pos_col = \"pos.exposure\",   MHC_start = 28477797,   MHC_end = 33448354 )"},{"path":"https://hortoner.github.io/QTLMR/reference/remove_MHC_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"移除MHC区域的SNP数据 — remove_MHC_data","text":"dat 暴露数据。 chr_col 数据中包含染色体序号的列名。 pos_col 数据中包含坐标的列名。 MHC_start MHC区SNP的起始位置。 MHC_end MHC区SNP的终止位置。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/remove_MHC_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"移除MHC区域的SNP数据 — remove_MHC_data","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_format_BESD.html","id":null,"dir":"Reference","previous_headings":"","what":"构建SMR分析所需的BESD二进制数据文件 — SMR_format_BESD","title":"构建SMR分析所需的BESD二进制数据文件 — SMR_format_BESD","text":"注意：输入数据必须包含SNP、CHR、BP、effect_allele、other_allele、eaf、beta、se、pval列名","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_format_BESD.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"构建SMR分析所需的BESD二进制数据文件 — SMR_format_BESD","text":"","code":"SMR_format_BESD(   GWASfile = \" \",   Ensemblid = \" \",   build = 38,   pvalue = NULL,   cis_wind_kb = 1000,   save_path = \"./\",   save_name = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_format_BESD.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"构建SMR分析所需的BESD二进制数据文件 — SMR_format_BESD","text":"GWASfile 顺式xQTL数据文件。非R包内置数据，可使用xQTL_cis_dat()函数转换获取。 Ensemblid xQTL数据基因的Ensemblid。 build 37或38，人类参考基因组版本，默认38。 pvalue 显著性P值的阈值过滤值，默认NULL，建议设置为0.00157。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 save_path xQTL数据的二进制文件保存路径，默认为当前文件夹\"./\"。 save_name 分析结果文件名，建议设置为基因名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_Locus_Effect_Plot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制SMR locus与Effect Plot图 — SMR_Locus_Effect_Plot","title":"绘制SMR locus与Effect Plot图 — SMR_Locus_Effect_Plot","text":"绘制SMR locus与Effect Plot图","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_Locus_Effect_Plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制SMR locus与Effect Plot图 — SMR_Locus_Effect_Plot","text":"","code":"SMR_Locus_Effect_Plot(   GWAS_file = \" \",   GWAS_name = \" \",   xQTL_file = \" \",   bfile_1000G = \" \",   gene_list = \" \",   probe = \" \",   probe_wind = 500,   save_path = \"./\",   diff_freq = 0.2,   diff_freq_prop = 0.05,   MAF = 0.01,   cis_wind = 2000,   pval = 5e-08,   smr_multi = TRUE,   smr_multi_set_wind = NULL,   smr_multi_ld_snp = 0.1,   heidi_mtd = 1,   HEIDI_test_pval = 0.00157,   ld_upper = 0.9,   ld_lower = 0.05,   nSNPs_min = 3,   nSNPs_max = 20,   thread_num = 4,   SMR_Locus_Plot = TRUE,   SMR_Effect_Plot = TRUE,   probeNEARBY = NULL,   smr_thresh = 0.05,   heidi_thresh = 0.05,   pointsize = 20,   max_anno_probe = 8,   anno_selfdef = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_Locus_Effect_Plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制SMR locus与Effect Plot图 — SMR_Locus_Effect_Plot","text":"GWAS_file smr分析中的gwas文件，需要提前准备好。 GWAS_name GWAS的名称。 xQTL_file smr分析的二进制数据文件。 bfile_1000G 1000G参考基因组的文件地址。 gene_list 用于绘图的基因注释文件路径。 probe 指定probeID，具体见.smr文件的probeID列。 probe_wind 定义以指定探针为中心的窗口范围，默认为500kb。 save_path SMR作图数据输出文件的路径。 diff_freq 对等位基因频率进行质量控制，如果SNP的效应等位基因频率差异在两两配对的数据集中（包括the LD reference sample, eQTL summary data GWAS summary data）的超过指定的差异阈值，将排除该SNP。默认为0.2。 diff_freq_prop SMR分析中，允许具有等位基因频率差异的的SNP的最大比例。如果由diff_freq排除的SNP比率大于diff_freq_prop指定的阈值，SMR分析将停止（提示错误信息）。默认值为0.05。 MAF 根据参考样本中的次要等位基因频率（MAF）阈值去除SNP，默认值为0.01。maf的取值范围在0-0.5。 cis_wind SMR分析中，定义一个以探针为中心的染色体范围，以选择cis-eQTL（通过p值阈值）进行SMR分析。默认值为2000Kb。 pval 筛选用于SMR分析的top显著相关QTL（如eQTL）的p值，默认为5.0e-8。 smr_multi 是否进行基于多个SNP的smr分析，默认为TRUE，反之则使用top snp进行SMR分析。 smr_multi_set_wind 选定基于多个snp进行SMR分析的基因区域，定义最显著cis-QTL为中心的染色体区域。 默认是选择smr_cis_wind内所有的snp进行SMR分析，默认为NULL。反之，可进行自己指定，如500kb，写作500。 smr_multi_ld_snp 除纳入SMR分析的QTLs（如eQTL）中存在连锁不平衡的QTLs，默认值是0.1。 heidi_mtd HEIDI检验中，指定一个方法进行HEIDI检验。0是最初的原始HEIDI检验，由Zhu et al (2016 Nature Genetics)提出；1是新的HEIDI检验，模拟结果表明，使用cis-eQTL区域中排名前20位的SNP（按照p值进行排序）进行异质性测试，HEIDI测试的功效最初增加，但随着SNP数量（m）的增加而降低，峰值在m = ~20。默认值为1。 HEIDI_test_pval HEIDI检验中，筛选用于HEIDI检验的QTL的p值，默认p值为1.57e-3，相当于卡方值（df=1）10。 ld_upper HEIDI检验中，用于排除与top SNP存在显著连锁不平衡的QTL(如eQTL),默认值是0.9。 ld_lower HEIDI检验中，用于排除与top SNP不存在连锁不平衡或者微弱连锁不平衡的QTL(如eQTL),默认值是0.05。 nSNPs_min HEIDI检验中，使用顺式snp数量的最小数量，小于该阈值将不进行HEIDI检验。因为如果SNP的数量太少，HEIDI测试检测异质性的能力很小，并可能产生误导性的结果。默认值为3。 nSNPs_max HEIDI检验中，使用顺式snp数量的最大数量，如果经过LD筛选后的cis-SNP的数量大于m，则仅使用前m个SNP进行HEIDI检验（按照QTL的p值进行排序），默认值为20。 thread_num 指定用于并行计算的线程数。默认值为4。 SMR_Locus_Plot 是否绘制绘制SMR locus图。 SMR_Effect_Plot 是否绘制绘制Effect Plot图。 probeNEARBY eQTLs层，可指定感兴趣的探针id以绘制对应的QTLs数据。 smr_thresh SMR测试的全基因组显著性水平阈值，默认为0.05，一般对p_SMR进行FDR矫正0.05/n, heidi_thresh HEIDI测试的阈值，默认值为0.05。 pointsize 纵坐标对应标题字体的大小，默认为20。 max_anno_probe locus图中显示的探针最大数目，默认值为8。 anno_selfdef 是否使用使用第三部分的库来排列探针名称,默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_Locus_Effect_Plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制SMR locus与Effect Plot图 — SMR_Locus_Effect_Plot","text":"ReadSMRData函数输入数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_multi_HEIDI.html","id":null,"dir":"Reference","previous_headings":"","what":"基于SMR软件的孟德尔随机化分析 — SMR_multi_HEIDI","title":"基于SMR软件的孟德尔随机化分析 — SMR_multi_HEIDI","text":"这个函数利用SMR软件进行遗传因素与表型特征相关性分析。它用于检测给定基因与GWAS信号之间的相关性，并提供分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_multi_HEIDI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"基于SMR软件的孟德尔随机化分析 — SMR_multi_HEIDI","text":"","code":"SMR_multi_HEIDI(   GWAS_file = \" \",   GWAS_name = \" \",   xQTL_file = \" \",   bfile_1000G = \" \",   Gene_name = NULL,   save_path = \"./\",   diff_freq = 0.2,   diff_freq_prop = 0.05,   MAF = 0.01,   cis_wind = 2000,   pval = 5e-08,   smr_multi = TRUE,   smr_multi_set_wind = NULL,   smr_multi_ld_snp = 0.1,   heidi_mtd = 1,   HEIDI_test_pval = 0.00157,   ld_upper = 0.9,   ld_lower = 0.05,   nSNPs_min = 3,   nSNPs_max = 20,   thread_num = 4 )"},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_multi_HEIDI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"基于SMR软件的孟德尔随机化分析 — SMR_multi_HEIDI","text":"GWAS_file GWAS数据文件路径，其文件格式为\".ma\"。 GWAS_name GWAS数据的名称。 xQTL_file xQTL数据文件路径。 bfile_1000G 1000G基因型数据文件路径。 Gene_name 要分析的基因名称，默认为NULL时，则对所有基因分析。 save_path 结果保存路径，默认为\"./\"。 diff_freq 对等位基因频率进行质量控制，如果SNP的效应等位基因频率差异在两两配对的数据集中（包括the LD reference sample, eQTL summary data GWAS summary data）的超过指定的差异阈值，将排除该SNP。默认为0.2。 diff_freq_prop SMR分析中，允许具有等位基因频率差异的的SNP的最大比例。如果由diff_freq排除的SNP比率大于diff_freq_prop指定的阈值，SMR分析将停止（提示错误信息）。默认值为0.05。 MAF 根据参考样本中的次要等位基因频率（MAF）阈值去除SNP，默认值为0.01。maf的取值范围在0-0.5。 cis_wind SMR分析中，定义一个以探针为中心的染色体范围，以选择cis-eQTL（通过p值阈值）进行SMR分析。默认值为2000Kb。 pval 筛选用于SMR分析的top显著相关QTL（如eQTL）的p值，默认为5.0e-8。 smr_multi 是否进行基于多个SNP的smr分析，默认为TRUE，反之则使用top snp进行SMR分析。 smr_multi_set_wind 选定基于多个snp进行SMR分析的基因区域，定义最显著cis-QTL为中心的染色体区域。 默认是选择smr_cis_wind内所有的snp进行SMR分析，默认为NULL。反之，可进行自己指定，如500kb，写作500。 smr_multi_ld_snp 除纳入SMR分析的QTLs（如eQTL）中存在连锁不平衡的QTLs，默认值是0.1。 heidi_mtd HEIDI检验中，指定一个方法进行HEIDI检验。0是最初的原始HEIDI检验，由Zhu et al (2016 Nature Genetics)提出；1是新的HEIDI检验，模拟结果表明，使用cis-eQTL区域中排名前20位的SNP（按照p值进行排序）进行异质性测试，HEIDI测试的功效最初增加，但随着SNP数量（m）的增加而降低，峰值在m = ~20。默认值为1。 HEIDI_test_pval HEIDI检验中，筛选用于HEIDI检验的QTL的p值，默认p值为1.57e-3，相当于卡方值（df=1）10。 ld_upper HEIDI检验中，用于排除与top SNP存在显著连锁不平衡的QTL(如eQTL),默认值是0.9。 ld_lower HEIDI检验中，用于排除与top SNP不存在连锁不平衡或者微弱连锁不平衡的QTL(如eQTL),默认值是0.05。 nSNPs_min HEIDI检验中，使用顺式snp数量的最小数量，小于该阈值将不进行HEIDI检验。因为如果SNP的数量太少，HEIDI测试检测异质性的能力很小，并可能产生误导性的结果。默认值为3。 nSNPs_max HEIDI检验中，使用顺式snp数量的最大数量，如果经过LD筛选后的cis-SNP的数量大于m，则仅使用前m个SNP进行HEIDI检验（按照QTL的p值进行排序），默认值为20。 thread_num 指定用于并行计算的线程数。默认值为4。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SMR_multi_HEIDI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"基于SMR软件的孟德尔随机化分析 — SMR_multi_HEIDI","text":"data 分析结果数据。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_format_data.html","id":null,"dir":"Reference","previous_headings":"","what":"将TwosampleMR格式转换成SUPERGNOVA分析输入格式数据 — SUPERGNOVA_format_data","title":"将TwosampleMR格式转换成SUPERGNOVA分析输入格式数据 — SUPERGNOVA_format_data","text":"输出.sumstats.gz格式数据(表头：SNP A1 A2 Z N )。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_format_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将TwosampleMR格式转换成SUPERGNOVA分析输入格式数据 — SUPERGNOVA_format_data","text":"","code":"SUPERGNOVA_format_data(   GWASfile = \" \",   N = NULL,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_format_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将TwosampleMR格式转换成SUPERGNOVA分析输入格式数据 — SUPERGNOVA_format_data","text":"GWASfile 字符串向量，标准的TwosampelMR格式数据文件路径。 N 样本量，如果TwosampelMR格式数据samplesize列为NA，需要补充，默认NULL。 save_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下，如果设置为NULL，则不保存文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_format_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将TwosampleMR格式转换成SUPERGNOVA分析输入格式数据 — SUPERGNOVA_format_data","text":"data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_py_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置SUPERGNOVA软件环境 — SUPERGNOVA_py_install","title":"配置SUPERGNOVA软件环境 — SUPERGNOVA_py_install","text":"配置SUPERGNOVA软件环境","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_py_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置SUPERGNOVA软件环境 — SUPERGNOVA_py_install","text":"","code":"SUPERGNOVA_py_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_py_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置SUPERGNOVA软件环境 — SUPERGNOVA_py_install","text":"force TRUE或FALSE，是否重新安装SUPERGNOVA软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_run.html","id":null,"dir":"Reference","previous_headings":"","what":"使用 SUPERGNOVA 进行局部遗传相关性分析 — SUPERGNOVA_run","title":"使用 SUPERGNOVA 进行局部遗传相关性分析 — SUPERGNOVA_run","text":"此函数用于运行 SUPERGNOVA 算法，该算法计算两个性状之间的局部遗传相关性，官网：https://github.com/qlu-lab/SUPERGNOVA。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用 SUPERGNOVA 进行局部遗传相关性分析 — SUPERGNOVA_run","text":"","code":"SUPERGNOVA_run(   test_help = FALSE,   Sumstatsfile = c(\"ASD.txt.sumstats.gz\", \"CP.txt.sumstats.gz\"),   trait1_samplesizes = NULL,   trait2_samplesizes = NULL,   bfile = \"./bfiles/eur_chr@_SNPmaf5\",   partition = \"./partition/eur_chr@.bed\",   save_name = \"res\",   save_path = \"./supergnova\",   thread = NULL )"},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用 SUPERGNOVA 进行局部遗传相关性分析 — SUPERGNOVA_run","text":"test_help 是否输出 SUPERGNOVA 的帮助信息。默认为 FALSE。当设置为 TRUE 时，仅显示帮助信息，不执行分析。 Sumstatsfile 包含 GWAS 汇总统计数据的文件路径列表。文件需以 *.sumstats.gz 格式提供，支持多个性状文件。 trait1_samplesizes 第一个性状的样本量。若为空，则不指定此参数。 trait2_samplesizes 第二个性状的样本量。若为空，则不指定此参数。 bfile 参考数据面板文件（LD 文件）的路径前缀，用于计算局部遗传相关性。默认值为 \"./bfiles/eur_chr@_SNPmaf5\"。 partition 分区文件路径前缀，定义局部遗传相关性的区域。默认值为 \"./partition/eur_chr@.bed\"。 save_name 输出结果文件的名称（不包含后缀）。默认值为 \"res\"。 save_path 结果文件的保存路径。默认值为 \"./supergnova\"。 thread 每条染色体运算的线程数，设置为NULL时，则启用所有线程。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用 SUPERGNOVA 进行局部遗传相关性分析 — SUPERGNOVA_run","text":"返回结果。注意：某些表型的某些基因组区域的真实遗传力可能非常小。尽管存在估计局部遗传力的方法，但它们可能会提供不稳定的结果，在许多情况下会给出负的遗传力估计。SUPERGNOVA 会忽略负的遗传力估计，将相关性估计置为 \"NA\"。因此，我们建议用户在进行局部遗传相关性分析时，更多关注遗传协方差而非遗传相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/SUPERGNOVA_run.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用 SUPERGNOVA 进行局部遗传相关性分析 — SUPERGNOVA_run","text":"bfile 参数表示 .bed/.bim/.fam 基因型数据文件的前缀。注意 @，它表示一个通配符字符，SUPERGNOVA 将会用 1-22 替代它。或者，如果您有一个包含所有22个染色体的基因型数据文件集，您可以只指定一个 bfile，例如1号染色体eur_chr1_SNPmaf5。我们建议您使用全基因组数据作为参考面板，尽管您可能只对某个特定区域的局部遗传相关性感兴趣。 partition 参数表示基因组分区文件，格式为 bed 文件。注意 @，它表示一个通配符字符，SUPERGNOVA 将会用 1-22 替代它。或者，如果您只对某些特定的基因组区域感兴趣，您可以指定一个总结所有感兴趣区域的 bed 文件，例如1号染色eur_chr1.bed。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/tran_chrpos_from_SNP.html","id":null,"dir":"Reference","previous_headings":"","what":"rsid转chrpos — tran_chrpos_from_SNP","title":"rsid转chrpos — tran_chrpos_from_SNP","text":"此函数基于SNPlocs.Hsapiens.dbSNP155.GRCh37与SNPlocs.Hsapiens.dbSNP155.GRCh38，请预先安装包至本地。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/tran_chrpos_from_SNP.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"rsid转chrpos — tran_chrpos_from_SNP","text":"","code":"tran_chrpos_from_SNP(   GWASfile = \" \",   snp_col = \"rsids\",   chr_col = \"chr.outcome\",   pos_col = \"pos.outcome\",   build = 37,   save_path = \"./\",   save_name = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/tran_chrpos_from_SNP.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"rsid转chrpos — tran_chrpos_from_SNP","text":"GWASfile 需要转换的GWAS数据文件路径。 snp_col 输入数据中包含SNP的列名，默认为\"rsids\"。 chr_col 输出数据中chr列的列名，默认保存数据列名为\"chr.outcome\"。 pos_col 输出数据中pos列的列名，默认保存数据列名为\"pos.outcome\"。 build 人类参考基因组的版本，37或38，默认38。 save_path 指定输出文件将保存的目录，默认当前工作路径下。 save_name 分析结果保存文件名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/tran_chrpos_from_SNP.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"rsid转chrpos — tran_chrpos_from_SNP","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/tran_SNP_from_chrpos.html","id":null,"dir":"Reference","previous_headings":"","what":"chrpos转rsid — tran_SNP_from_chrpos","title":"chrpos转rsid — tran_SNP_from_chrpos","text":"此函数基于SNPlocs.Hsapiens.dbSNP155.GRCh37与SNPlocs.Hsapiens.dbSNP155.GRCh38，请预先安装包至本地。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/tran_SNP_from_chrpos.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"chrpos转rsid — tran_SNP_from_chrpos","text":"","code":"tran_SNP_from_chrpos(   GWASfile = \" \",   chr_col = \"chromosome\",   pos_col = \"base_pair_location\",   build = 37,   save_path = \"./\",   save_name = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/tran_SNP_from_chrpos.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"chrpos转rsid — tran_SNP_from_chrpos","text":"GWASfile 需要转换的GWAS数据文件路径。 chr_col 数据中包含染色体序号的列名。 pos_col 数据中包含坐标的列名。 build 人类参考基因组的版本，37或38，默认37。 save_path 指定输出文件将保存的目录，默认当前工作路径下。 save_name 分析结果保存文件名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/tran_SNP_from_chrpos.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"chrpos转rsid — tran_SNP_from_chrpos","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_format_data.html","id":null,"dir":"Reference","previous_headings":"","what":"将TwosampleMR格式转换成TWAS FOCUS分析输入格式数据 — TWAS_FOCUS_format_data","title":"将TwosampleMR格式转换成TWAS FOCUS分析输入格式数据 — TWAS_FOCUS_format_data","text":"输出.sumstats.gz格式数据(表头：CHR BP SNP A1 A2 Z N )，官网：https://github.com/mancusolab/ma-focus/wiki/Cleaning-GWAS-summary-data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_format_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将TwosampleMR格式转换成TWAS FOCUS分析输入格式数据 — TWAS_FOCUS_format_data","text":"","code":"TWAS_FOCUS_format_data(   GWASfile = \" \",   N = NULL,   FOCUS_munge = TRUE,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_format_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将TwosampleMR格式转换成TWAS FOCUS分析输入格式数据 — TWAS_FOCUS_format_data","text":"GWASfile 字符串向量，标准的TwosampelMR格式数据文件路径。 N 样本量，如果TwosampelMR格式数据samplesize列为NA，需要补充，默认NULL。 FOCUS_munge 是否调用FOCUS软件格式化数据，默认TRUE。 save_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下，如果设置为NULL，则不保存文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_format_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将TwosampleMR格式转换成TWAS FOCUS分析输入格式数据 — TWAS_FOCUS_format_data","text":"data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_import.html","id":null,"dir":"Reference","previous_headings":"","what":"使用FOCUS软件创建权重数据 — TWAS_FOCUS_import","title":"使用FOCUS软件创建权重数据 — TWAS_FOCUS_import","text":"软件官网：https://github.com/mancusolab/ma-focus/wiki/Creating--weight-database。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_import.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用FOCUS软件创建权重数据 — TWAS_FOCUS_import","text":"","code":"TWAS_FOCUS_import(   import_help = FALSE,   path = \"./WEIGHTS/GTExv8.EUR.Whole_Blood.nofilter.pos\",   resource = \"fusion\",   tissue = \"Whole_Blood\",   name = \"Whole_Blood\",   assay = \"rnaseq\",   opt_arguments = c(\"--use-ens-id\", \"--from-gencode\"),   save_name = \"GTExv8.EUR.Whole_Blood.nofilter.pos\",   save_path = \"FOCUS_WEIGHTS\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_import.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用FOCUS软件创建权重数据 — TWAS_FOCUS_import","text":"import_help 是否调阅FOCUS软件import的帮助文档，默认FALSE。 path FUSION/PrediXcan的权重数据所在文件的路径，如\"./WEIGHTS/GTExv8.EUR.Whole_Blood.nofilter.pos\"。 resource 权重数据文件来源，\"fusion\"或\"PrediXcan\"，默认\"fusion\"。 tissue 组织类型，如\"Whole_Blood\"。 name Name expression reference panel (e.g., GTEx). assay Technology used measure expression levels (e.g.,rnaseq).\"rnaseq\"或\"array\"。 opt_arguments FOCUS软件import的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置FOCUS软件环境 — TWAS_FOCUS_install","title":"配置FOCUS软件环境 — TWAS_FOCUS_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置FOCUS软件环境 — TWAS_FOCUS_install","text":"","code":"TWAS_FOCUS_install(force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置FOCUS软件环境 — TWAS_FOCUS_install","text":"force TRUE或FALSE，是否重新安装FOCUS软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_Multi_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用FOCUS软件进行循环多种组织TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_Multi_test","title":"使用FOCUS软件进行循环多种组织TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_Multi_test","text":"软件官网：https://github.com/mancusolab/ma-focus。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_Multi_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用FOCUS软件进行循环多种组织TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_Multi_test","text":"","code":"TWAS_FOCUS_Multi_test(   finemap_help = FALSE,   Sumstatsfile = \"./UC.sumstats.gz\",   ref_ld = \"./1000G_EUR_Phase3_plink/1000G.EUR.QC.\",   weights_file = \"./FOCUS_WEIGHTS\",   start_chr = 1,   end_chr = 22,   plot = TRUE,   locations = \"38:EUR\",   prior_prob = \"gencode38\",   p_threshold = 5e-08,   opt_arguments = NULL,   pip_sig = 0.9,   save_name = \"UC\",   save_path = \"./UC\",   cores = 2 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_Multi_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用FOCUS软件进行循环多种组织TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_Multi_test","text":"finemap_help 是否调阅FOCUS软件finemap的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 ref_ld PLINK格式的参考面板数据的文件路径，只填写到不包含序号的文件前缀，下载地址：https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays/LDSCORE。 weights_file FOCUS分析所需权重数据.db文件的文件夹路径。 start_chr 需要分析的染色体起始序号。 end_chr 需要分析的染色体终止序号。 plot 是否绘制fine-mapping图，默认TRUE。 locations 通过指定以下选项使用默认的独立区域'37:EUR', '37:AFR', '37:EAS','37:EUR-AFR', '37:EUR-EAS', '37:EAS-AFR', '37:EUR-EAS-AFR', '38:EUR', '38:AFR', '38:EAS','38:EUR-AFR', '38:EUR-EAS', '38:EAS-AFR', '38:EUR-EAS-AFR'。 prior_prob 具有因果关系基因的先验概率类型名称，'gencode37'或'gencode38'或使用一个固定的数值概率，例如直接指定1e-3。 p_threshold 执行TWAS精细定位所需的最小GWAS p值显著性阈值，默认5e-8。 opt_arguments FOCUS软件finemap的其他命令行参数(设置finemap_help = TRUE查看)，默认NULL。 pip_sig pip的显著性阈值，0-1之间，默认0.9。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_Multi_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用FOCUS软件进行循环多种组织TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_Multi_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_Multi_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用FOCUS软件进行循环多种组织TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_Multi_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用FOCUS软件进行TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_test","title":"使用FOCUS软件进行TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_test","text":"软件官网：https://github.com/mancusolab/ma-focus。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用FOCUS软件进行TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_test","text":"","code":"TWAS_FOCUS_test(   finemap_help = FALSE,   Sumstatsfile = \"./UC.sumstats.gz\",   ref_ld = \"./1000G_EUR_Phase3_plink/1000G.EUR.QC.\",   weights_file_db = \"./GTExv8.ALL.Whole_Blood.db\",   start_chr = 1,   end_chr = 22,   plot = TRUE,   locations = \"38:EUR\",   prior_prob = \"gencode38\",   p_threshold = 5e-08,   opt_arguments = NULL,   pip_sig = 0.9,   save_name = \"UC\",   save_path = \"./UC\",   cores = 2 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用FOCUS软件进行TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_test","text":"finemap_help 是否调阅FOCUS软件finemap的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 ref_ld PLINK格式的参考面板数据的文件路径，只填写到不包含序号的文件前缀，下载地址：https://console.cloud.google.com/storage/browser/broad-alkesgroup-public-requester-pays/LDSCORE。 weights_file_db FOCUS分析所需权重数据.db文件路径。 start_chr 需要分析的染色体起始序号。 end_chr 需要分析的染色体终止序号。 plot 是否绘制fine-mapping图，默认TRUE。 locations 通过指定以下选项使用默认的独立区域'37:EUR', '37:AFR', '37:EAS','37:EUR-AFR', '37:EUR-EAS', '37:EAS-AFR', '37:EUR-EAS-AFR', '38:EUR', '38:AFR', '38:EAS','38:EUR-AFR', '38:EUR-EAS', '38:EAS-AFR', '38:EUR-EAS-AFR'。 prior_prob 具有因果关系基因的先验概率类型名称，'gencode37'或'gencode38'或使用一个固定的数值概率，例如直接指定1e-3。 p_threshold 执行TWAS精细定位所需的最小GWAS p值显著性阈值，默认5e-8。 opt_arguments FOCUS软件finemap的其他命令行参数(设置finemap_help = TRUE查看)，默认NULL。 pip_sig pip的显著性阈值，0-1之间，默认0.9。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用FOCUS软件进行TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_FOCUS_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用FOCUS软件进行TWAS的基因-性状关联信号精细定位分析 — TWAS_FOCUS_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_assoc_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用FUSION软件进行TWAS分析 — TWAS_fusion_assoc_test","title":"使用FUSION软件进行TWAS分析 — TWAS_fusion_assoc_test","text":"软件官网：http://gusevlab.org/projects/fusion/，使用前请先使用TWAS_Fusion_format_data函数进行数据格式转换。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_assoc_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用FUSION软件进行TWAS分析 — TWAS_fusion_assoc_test","text":"","code":"TWAS_fusion_assoc_test(   test_help = FALSE,   Sumstatsfile = \"PGC2.SCZ.sumstats\",   weights = \"./WEIGHTS/GTExv8.EUR.Whole_Blood.nofilter.pos\",   weights_dir = \"./WEIGHTS/\",   resource = \"GTEx_v8\",   ref_ld_chr = \"./LDREF/1000G.EUR.\",   start_chr = 1,   end_chr = 22,   coloc_pval = NULL,   GWASN = NULL,   perm = 10000,   PANELN = NA,   opt_arguments = NULL,   remove_MHC = TRUE,   FDR_method = \"bonferroni\",   save_name = \"SCZ\",   save_path = \"./SCZ\",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_assoc_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用FUSION软件进行TWAS分析 — TWAS_fusion_assoc_test","text":"test_help 是否调阅FUSION软件FUSION.assoc_test的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 weights 权重数据文件，官网可下载。 weights_dir 权重数据文件所在的文件夹。 resource 权重数据文件来源，\"GTEx_v8\"或\"\"，默认\"GTEx_v8\"。 ref_ld_chr 连锁不平衡的参考数据，下载地址：https://alkesgroup.broadinstitute.org/FUSION/LDREF.tar.bz2。 start_chr 需要分析的染色体起始序号。 end_chr 需要分析的染色体终止序号。 coloc_pval 根据TWAS显著阈值筛选进行共定位分析，默认不进行共定位分析设置：NULL，常规设置为0.05。 GWASN GWAS即Sumstatsfile数据的样本量，默认不进行共定位分析设置：NULL。 perm 设置置换检验次数，默认值是10000。 PANELN 参考面板的权重数据，默认为NA。 opt_arguments FUSION软件FUSION.assoc_test的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 remove_MHC 是否移除MHC区域的SNP。 FDR_method 对TWAS.P值进行FDR矫正方法，\"fdr\"或\"bonferroni\"，默认\"bonferroni\"，若填NULL则不进行FDR矫正。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_assoc_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用FUSION软件进行TWAS分析 — TWAS_fusion_assoc_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_assoc_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用FUSION软件进行TWAS分析 — TWAS_fusion_assoc_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_conditonal_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用FUSION软件进行Joint/conditional分析 — TWAS_fusion_conditonal_test","title":"使用FUSION软件进行Joint/conditional分析 — TWAS_fusion_conditonal_test","text":"软件官网：http://gusevlab.org/projects/fusion/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_conditonal_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用FUSION软件进行Joint/conditional分析 — TWAS_fusion_conditonal_test","text":"","code":"TWAS_fusion_conditonal_test(   test_help = FALSE,   Sumstatsfile = \"PGC2.SCZ.sumstats\",   inputfile = \"./SCZ/SCZ_sig.dat\",   ref_ld_chr = \"./LDREF/1000G.EUR.\",   start_chr = 1,   end_chr = 22,   locus_win_kb = 1000,   build = 38,   plot_legend = \"all\",   opt_arguments = NULL,   save_name = \"SCZ\",   save_path = \"./SCZ/conditional\",   cores = 2 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_conditonal_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用FUSION软件进行Joint/conditional分析 — TWAS_fusion_conditonal_test","text":"test_help 是否调阅FUSION软件FUSION.post_process的帮助文档，默认FALSE。 Sumstatsfile .sumstats.gz格式文件路径。 inputfile TWAS_fusion_assoc_test分析生成的\"XXX_sig.dat\"文件路径。 ref_ld_chr 连锁不平衡的参考数据，下载地址：https://alkesgroup.broadinstitute.org/FUSION/LDREF.tar.bz2。 start_chr 需要分析的染色体起始序号。 end_chr 需要分析的染色体终止序号。 locus_win_kb 区域图的kb值大小，默认1000kb，即1000000bp。 build 37或38，人类参考基因组版本，默认38。 plot_legend 添加图例的类型，\"\"或\"joint\"，默认\"\"。 opt_arguments FUSION软件FUSION.post_process的其他命令行参数(设置test_help = TRUE查看参数)，默认NULL。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_conditonal_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用FUSION软件进行Joint/conditional分析 — TWAS_fusion_conditonal_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_format_data.html","id":null,"dir":"Reference","previous_headings":"","what":"将TwosampleMR格式转换成TWAS Fusion分析输入格式数据 — TWAS_fusion_format_data","title":"将TwosampleMR格式转换成TWAS Fusion分析输入格式数据 — TWAS_fusion_format_data","text":"输出.sumstats.gz格式数据(表头：SNP A1 A2 Z N )，官网：http://gusevlab.org/projects/fusion/。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_format_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"将TwosampleMR格式转换成TWAS Fusion分析输入格式数据 — TWAS_fusion_format_data","text":"","code":"TWAS_fusion_format_data(   GWASfile = \" \",   N = NULL,   save_name = \" \",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_format_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"将TwosampleMR格式转换成TWAS Fusion分析输入格式数据 — TWAS_fusion_format_data","text":"GWASfile 字符串向量，标准的TwosampelMR格式数据文件路径。 N 样本量，如果TwosampelMR格式数据samplesize列为NA，需要补充，默认NULL。 save_name 指定输出文件名称。 save_path 指定输出文件将保存的目录，默认当前工作路径下，如果设置为NULL，则不保存文件。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_format_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"将TwosampleMR格式转换成TWAS Fusion分析输入格式数据 — TWAS_fusion_format_data","text":"data。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_Multi_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用FUSION软件进行循环多种组织分析 — TWAS_fusion_Multi_test","title":"使用FUSION软件进行循环多种组织分析 — TWAS_fusion_Multi_test","text":"调用TWAS_fusion_assoc_test函数循环分析如GTEx_v8多种组织。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_Multi_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用FUSION软件进行循环多种组织分析 — TWAS_fusion_Multi_test","text":"","code":"TWAS_fusion_Multi_test(   Sumstatsfile = \"PGC2.SCZ.sumstats\",   weights_type = \"nofilter.pos\",   weights_dir = \"./WEIGHTS/\",   resource = \"GTEx_v8\",   ref_ld_chr = \"./LDREF/1000G.EUR.\",   start_chr = 1,   end_chr = 22,   coloc_pval = NULL,   GWASN = NULL,   perm = 10000,   PANELN = NA,   opt_arguments = NULL,   remove_MHC = TRUE,   FDR_method = \"bonferroni\",   save_name = \"SCZ\",   save_path = \"./SCZ\",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_Multi_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用FUSION软件进行循环多种组织分析 — TWAS_fusion_Multi_test","text":"Sumstatsfile .sumstats.gz格式文件路径。 weights_type 权重数据文件类型，\"nofilter.pos\" 或\"pos\" ，默认\"nofilter.pos\"。 weights_dir 权重数据文件所在的文件夹。 resource 权重数据文件来源，\"GTEx_v8\"或\"\"，默认\"GTEx_v8\"。 ref_ld_chr 连锁不平衡的参考数据，下载地址：https://alkesgroup.broadinstitute.org/FUSION/LDREF.tar.bz2。 start_chr 需要分析的染色体起始序号。 end_chr 需要分析的染色体终止序号。 coloc_pval 根据TWAS显著阈值筛选进行共定位分析，默认不进行共定位分析设置：NULL，常规设置为0.05。 GWASN GWAS即Sumstatsfile数据的样本量，默认不进行共定位分析设置：NULL。 perm 设置置换检验次数，默认值是10000。 PANELN 参考面板的权重数据，默认为NA。 opt_arguments FUSION软件FUSION.assoc_test的其他命令行参数(如TWAS_fusion_assoc_test函数设置)，默认NULL。 remove_MHC 是否移除MHC区域的SNP。 FDR_method 对TWAS.P值进行FDR矫正方法，\"fdr\"或\"bonferroni\"，默认\"bonferroni\"，若填NULL则不进行FDR矫正。 save_name 保存文件的文件名称。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_Multi_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用FUSION软件进行循环多种组织分析 — TWAS_fusion_Multi_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_fusion_Multi_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用FUSION软件进行循环多种组织分析 — TWAS_fusion_Multi_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_cross_tissue_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用UTMOST软件进行跨组织联合TWAS分析 — TWAS_UTMOST_cross_tissue_test","title":"使用UTMOST软件进行跨组织联合TWAS分析 — TWAS_UTMOST_cross_tissue_test","text":"软件官网：https://github.com/Joker-Jerome/UTMOST，数据下载地址：https://zhaocenter.org/UTMOST。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_cross_tissue_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用UTMOST软件进行跨组织联合TWAS分析 — TWAS_UTMOST_cross_tissue_test","text":"","code":"TWAS_UTMOST_cross_tissue_test(   weight_db = \"./2.UTMOST/database_normalized_pruned/\",   cov_dir = \"./3.UTMOST_GBJ/covariance_joint_GTEx8_normalized_pruned/\",   input_folder = \"./2.UTMOST/\",   gene_info = \"./2.UTMOST/gene_info.txt\",   output_dir = \"./\",   output_name = \"joint_GBJ\",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_cross_tissue_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用UTMOST软件进行跨组织联合TWAS分析 — TWAS_UTMOST_cross_tissue_test","text":"weight_db 包含.db文件的权重数据文件路径，注意：必须为绝对路径！例如：\"D:/database_normalized_pruned\"。 cov_dir 包含.cov和.snplist文件的协方差结果的文件路径(跨组织的基因水平测试统计协方差矩阵），注意：必须为绝对路径！例如：\"D:/covariance_joint_GTEx8_normalized_pruned\"。 input_folder 包含TWAS_UTMOST_single_tissue_test()函数生成的.UTMOST.csv的文件夹路径，例如：\"./results\"。 gene_info TWAS_UTMOST_single_tissue_test()函数生成的gene_info.txt文件路径，例如：\"./results/gene_info.txt\"。 output_dir 结果文件保存的路径，注意：必须为绝对路径！例如：\"D:/results\"。 output_name 结果文件保存的文件名。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_cross_tissue_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用UTMOST软件进行跨组织联合TWAS分析 — TWAS_UTMOST_cross_tissue_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_cross_tissue_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用UTMOST软件进行跨组织联合TWAS分析 — TWAS_UTMOST_cross_tissue_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_install.html","id":null,"dir":"Reference","previous_headings":"","what":"配置UTMOST软件环境 — TWAS_UTMOST_install","title":"配置UTMOST软件环境 — TWAS_UTMOST_install","text":"请预先安装miniconda：https://repo.anaconda.com/miniconda/","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_install.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"配置UTMOST软件环境 — TWAS_UTMOST_install","text":"","code":"TWAS_UTMOST_install(install_pip = TRUE, force = FALSE)"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_install.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"配置UTMOST软件环境 — TWAS_UTMOST_install","text":"install_pip TRUE或FALSE，是否安装pip，默认TRUE。 force TRUE或FALSE，是否重新安装UTMOST软件环境，默认FALSE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_single_tissue_test.html","id":null,"dir":"Reference","previous_headings":"","what":"使用UTMOST软件进行单一组织TWAS分析 — TWAS_UTMOST_single_tissue_test","title":"使用UTMOST软件进行单一组织TWAS分析 — TWAS_UTMOST_single_tissue_test","text":"软件官网：https://github.com/Joker-Jerome/UTMOST，数据下载地址：https://zhaocenter.org/UTMOST。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_single_tissue_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"使用UTMOST软件进行单一组织TWAS分析 — TWAS_UTMOST_single_tissue_test","text":"","code":"TWAS_UTMOST_single_tissue_test(   test_help = FALSE,   GTEX_tissue = \"all\",   model_db_path = \"./database_normalized_pruned\",   covariance = \"./covariance_GTEx8_normalized_pruned\",   gwas_folder = \"./\",   gwas_file_pattern = \"SNP_gwas_mc_merge_nogc.tbl.uniq\",   snp_column = \"SNP\",   effect_allele_column = \"A1\",   non_effect_allele_column = \"A2\",   beta_column = \"b\",   pvalue_column = \"p\",   opt_arguments = NULL,   save_path = \"./\",   cores = 1 )"},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_single_tissue_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"使用UTMOST软件进行单一组织TWAS分析 — TWAS_UTMOST_single_tissue_test","text":"test_help 是否调阅single_tissue_association_test的帮助文档，默认FALSE。 GTEX_tissue GTEx v8组织类型，默认\"\"，即对所有组织分析，也可指定组织，如\"Whole_Blood\"。 model_db_path 基因表达补全模型的路径（顺式eQTLs的估计权重/效应值）。 covariance 包含协方差信息的文件路径（用于估计基因水平效应量估计器的方差，详情见手稿方法部分的基因水平关联测试）。 gwas_folder 包含GWAS汇总统计数据的文件夹。 gwas_file_pattern GWAS文件（如果未按染色体分段，则为汇总统计的文件名）。 snp_column 包含RSID的列名。 effect_allele_column 包含效应等位基因的列名。 non_effect_allele_column 包含非效应等位基因的列名。 beta_column 输入GWAS文件中包含每个SNP效应值的列名。 pvalue_column 输入GWAS文件中包含每个SNP P值的列名。 opt_arguments UTMOST软件single_tissue_association_test的其他命令行参数(设置test_help=TRUE查看)，默认NULL。 save_path 文件保存路径。 cores 并行运算电脑的线程数。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_single_tissue_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"使用UTMOST软件进行单一组织TWAS分析 — TWAS_UTMOST_single_tissue_test","text":"分析结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/TWAS_UTMOST_single_tissue_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"使用UTMOST软件进行单一组织TWAS分析 — TWAS_UTMOST_single_tissue_test","text":"目的是通过结合基因组关联研究（GWAS）的汇总统计数据和基因表达数据，来预测和测试基因表达与特定疾病或表型之间的相关性。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/venn_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制韦恩图 — venn_plot","title":"绘制韦恩图 — venn_plot","text":"绘制韦恩图","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/venn_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制韦恩图 — venn_plot","text":"","code":"venn_plot(   files = c(\"./UTMOST.txt\", \"./FUSION.txt\", \"./MAGMA.txt\"),   columns = NULL,   show_elements = FALSE,   show_percentage = TRUE,   digits = 1,   fill_color = c(\"blue\", \"yellow\", \"green\", \"red\"),   fill_alpha = 0.5,   stroke_color = \"black\",   stroke_alpha = 1,   stroke_size = 1,   stroke_linetype = \"solid\",   set_name_color = \"black\",   set_name_size = 6,   text_color = \"black\",   text_size = 4,   label_sep = \",\",   count_column = NULL,   show_outside = c(\"auto\", \"none\", \"always\"),   auto_scale = FALSE,   save_plot = TRUE,   save_name = \"venn_plot\",   width = 9,   height = 7,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/venn_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制韦恩图 — venn_plot","text":"files 一个字符向量，包含输入文件的路径，默认是c(\"./UTMOST.txt\",\"./FUSION.txt\",\"./MAGMA.txt\")。 columns 用于选择列/元素的字符向量索引。 show_elements 显示集合元素而不是计数/百分比，默认值为FALSE。 show_percentage 显示每个集合的百分比，默认值为TRUE。 digits 小数点后的位数，默认值为1。 fill_color 填充圆圈的颜色，默认是c(\"blue\", \"yellow\", \"green\", \"red\")。 fill_alpha 填充圆圈的透明度，默认值为0.5。 stroke_color 绘制圆圈的描边颜色，默认值为\"black\"。 stroke_alpha 绘制圆圈的描边透明度，默认值为1。 stroke_size 绘制圆圈的描边大小，默认值为1。 stroke_linetype 绘制圆圈的线型，默认值为\"solid\"。 set_name_color 集合名称的文本颜色，默认值为\"black\"。 set_name_size 集合名称的文本大小，默认值为6。 text_color 交集内容的文本颜色，默认值为\"black\"。 text_size 交集内容的文本大小，默认值为4。 label_sep 用于显示元素的分隔符字符，默认值为\",\"。 count_column 指定元素重复计数的列。 show_outside 显示不属于任何集合的元素，默认值为c(\"auto\", \"none\", \"always\")。 auto_scale 允许根据元素计数自动调整圆圈大小，默认值为FALSE。 save_name 保存交集数据与PDF文件名，默认值为\"venn_plot\"。 width 保存的PDF文件的宽度，默认值为9。 height 保存的PDF文件的高度，默认值为7。 save_path 保存PDF文件的路径，默认值为\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/venn_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制韦恩图 — venn_plot","text":"交集数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_bidir_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制双向柱状图 — Visualizing_bidir_plot","title":"绘制双向柱状图 — Visualizing_bidir_plot","text":"绘制双向柱状图","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_bidir_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制双向柱状图 — Visualizing_bidir_plot","text":"","code":"Visualizing_bidir_plot(   trait1_file = \"./LDSC/S_LDSC/xxx.results\",   trait2_file = \"./LDSC/S_LDSC/xxx.results\",   Pval_threshold = 0.05,   Pval_column = \"Enrichment_p\",   category_column = \"Category\",   trait1_name = \"XXX\",   trait2_name = \"XXX\",   color_trait1 = \"#5A9BD4\",   color_trait2 = \"#E6958A\",   y_axis_label = \"Category\",   y_axis_label_size = 10,   y_axis_font_size = 8,   x_axis_font_size = 8,   x_axis_label = expression(-log[10](pval)),   x_axis_label_size = 8,   x_axis_breaks = c(-12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12),   legend_title_size = 12,   legend_text_size = 10,   pdf_width = 10,   pdf_height = 5.5,   save_name = \"s_ldsc\",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_bidir_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制双向柱状图 — Visualizing_bidir_plot","text":"trait1_file 字符串，表示第一个性状的结果文件路径。默认为\"./LDSC/S_LDSC/xxx.results\"。 trait2_file 字符串，表示第二个性状的结果文件路径。默认为\"./LDSC/S_LDSC/xxx.results\"。 Pval_threshold 数值型，表示p值的阈值。函数将筛选出p值小于该阈值的类别，并仅保留这部分数据。默认为0.05。若设置为NULL或者1，则全部保留。 Pval_column 字符串，表示数据中用于存储p值的列名。默认为\"Enrichment_p\"。 category_column 字符串，表示数据中存储类别信息的列名（用于按类别排序）。默认为\"Category\"。 trait1_name 字符串，表示第一个性状的名称（例如疾病名称）。 trait2_name 字符串，表示第二个性状的名称（例如疾病名称）。 color_trait1 字符串，表示第一个性状的颜色。默认为\"#5A9BD4\"。 color_trait2 字符串，表示第二个性状的颜色。默认为\"#E6958A\"。 y_axis_label 字符串，表示y轴标签的内容。默认为\"Category\"。 y_axis_label_size 数值型，表示y轴标签字体的大小。默认为10。 y_axis_font_size 数值型，表示y轴字体的大小。默认为8。 x_axis_font_size 数值型，表示x轴字体的大小。默认为8。 x_axis_label 字符串或表达式，表示x轴标签的内容。默认为表达式(-log10)。 x_axis_label_size 数值型，表示x轴标签字体的大小。默认为8。 x_axis_breaks 数值型向量，表示x轴刻度的位置。默认为c(-12, -10, -8, -6, -4, -2, 0, 2, 4, 6, 8, 10, 12)。 legend_title_size 数值型，表示图例标题的字体大小。默认为12。 legend_text_size 数值型，表示图例标签的字体大小。默认为10。 pdf_width 数值型，表示保存PDF图形时图形的宽度。默认为10。 pdf_height 数值型，表示保存PDF图形时图形的高度。默认为5.5。 save_name 字符串，表示保存的PDF文件名。默认为\"s_ldsc\"。 save_path 字符串，表示保存文件的路径。默认为\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_bidir_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制双向柱状图 — Visualizing_bidir_plot","text":"返回合并结果。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_Manhattan.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制曼哈顿图 — Visualizing_Manhattan","title":"绘制曼哈顿图 — Visualizing_Manhattan","text":"Manhattan 图是一种广泛用于展示关联研究结果的散点图。然而，对于非专业用户而言，编写脚本和调整复杂图形的参数通常耗时且繁琐。此外，随着测量特征的不断增加，需要整合来自不同全基因组关联研究的结果。Visualizing_Manhattan函数可以将全基因组关联研究的 P 值结果以 QQ 图的形式展示，既包括传统的矩形模式，也包括新颖的圆形模式。在一个唯一的靶心样式图中，可以交互式地比较来自多个特征的关联结果，从而揭示信号之间的相似性和差异性。附加功能包括：突出显示信号、一组 SNP、染色体可视化和 SNP 周围的候选基因。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_Manhattan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制曼哈顿图 — Visualizing_Manhattan","text":"","code":"Visualizing_Manhattan(   Pmap,   col = c(\"#4197d8\", \"#f8c120\", \"#413496\", \"#495226\", \"#d60b6f\", \"#e66519\", \"#d581b7\",     \"#83d3ad\", \"#7c162c\", \"#26755d\"),   bin.size = 1e+06,   bin.breaks = NULL,   LOG10 = TRUE,   pch = 19,   type = \"p\",   band = 1,   H = 1.5,   ylim = NULL,   axis.cex = 1,   axis.lwd = 1.5,   lab.cex = 1.5,   lab.font = 2,   plot.type = c(\"m\", \"c\", \"q\", \"d\"),   multracks = FALSE,   multracks.xaxis = FALSE,   multraits = FALSE,   points.alpha = 100L,   r = 0.3,   cex = c(0.5, 1, 1),   outward = FALSE,   ylab = expression(-log[10](italic(p))),   ylab.pos = 3,   xticks.pos = 1,   mar = c(3, 6, 3, 3),   mar.between = 0,   threshold = NULL,   threshold.col = \"red\",   threshold.lwd = 1,   threshold.lty = 2,   amplify = TRUE,   signal.cex = 1.5,   signal.pch = 19,   signal.col = NULL,   signal.line = 2,   highlight = NULL,   highlight.cex = 1,   highlight.pch = 19,   highlight.type = \"p\",   highlight.col = \"red\",   highlight.text = NULL,   highlight.text.col = \"black\",   highlight.text.cex = 1,   highlight.text.font = 3,   chr.labels = NULL,   chr.border = FALSE,   chr.labels.angle = 0,   chr.den.col = \"black\",   chr.pos.max = FALSE,   cir.band = 1,   cir.chr = TRUE,   cir.chr.h = 1.5,   cir.axis = TRUE,   cir.axis.col = \"black\",   cir.axis.grid = TRUE,   conf.int = TRUE,   conf.int.col = NULL,   file.output = TRUE,   file.name = \"\",   file = c(\"jpg\", \"pdf\", \"tiff\", \"png\"),   dpi = 300,   height = NULL,   width = NULL,   main = NULL,   main.cex = 1.5,   main.font = 2,   legend.ncol = NULL,   legend.cex = 1,   legend.pos = c(\"left\", \"middle\", \"right\"),   box = FALSE,   verbose = TRUE )"},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_Manhattan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制曼哈顿图 — Visualizing_Manhattan","text":"Pmap 数据框，第一列为基因组标记的名称（如SNP)，第二列为染色体(CHR)，第三列为坐标位置(pos)，其余列为各特征的 P 值。 col 一个向量或矩阵，用于指定染色体的颜色。若为向量，则所有特征使用相同颜色；若为矩阵，则每行代表不同特征的颜色，缺失值可用 NA 替代。 bin.size 整数，标记密度图中每个 bin 的大小，以 bp 为单位。 bin.breaks 向量，用于设置密度图图例的断点，例如 seq(min, max, step)，范围外的标记数量将用最小值或最大值的颜色绘制。 LOG10 逻辑值，是否将 P 值转换为 log10(P 值) 规模。 pch 整数，点的形状，与  中的 \"pch\" 相同。 type 字符串，点的类型，可选 \"p\"（点）、\"l\"（交叉线）、\"h\"（垂直线）等，与  中的 \"type\" 相同。 band 数值，染色体之间的间距，默认值为 1，若为 0，则没有间距。 H 数值，每个圆的高度，代表一个特征，默认值为 1。 ylim 向量 (c(min, max)) 或列表，指定 y 轴的显示范围，可以对不同特征指定不同的 y 轴范围。 axis.cex 数值，控制 X/Y 轴刻度标签的大小。 axis.lwd 数值，控制 X/Y 轴线条的粗细。 lab.cex 数值，控制 X/Y 轴和染色体标签的大小。 lab.font 数值，控制所有轴标签的字体。 plot.type 字符串或向量，可选 \"d\"（SNP 密度图）、\"c\"（圆形 Manhattan 图）、\"m\"（传统 Manhattan 图）、\"q\"（Q-Q 图），指定要绘制的图类型。 multracks 逻辑值，是否将所有 Manhattan 图绘制在一个文件中，默认为 FALSE。 multracks.xaxis 逻辑值，是否将所有特征的 x 轴添加到图中，默认为 FALSE。 multraits 逻辑值，是否将所有特征绘制在同一轴上，并输出一个文件，默认为 FALSE。 points.alpha 数值，多个特征图中点的透明度，从 0（完全透明）到 255（不透明）。 r 数值，圆的半径（内部半径），默认值为 1。 cex 数值或向量，点的大小，与  中的 \"size\" 相同，向量的第一个数值控制圆形图中的点大小，第二个控制 Manhattan 图中的点大小，第三个控制 Q-Q 图中的点大小。 outward 逻辑值，是否将圆形 Manhattan 图中的所有点从内部向外部绘制，默认为 FALSE。 ylab 字符串，y 轴的标签。 ylab.pos 数值，y 轴标签与 y 轴的距离。 xticks.pos 数值，x 轴刻度标签与 x 轴的距离。 mar 向量，图形周围的白色空白区域，4 个值分别表示底部、左侧、顶部和右侧的空白。 mar.数值，多轨道 Manhattan 图中多个图形之间的距离。 threshold 数值、向量或列表，显著性阈值。例如，Bonferroni 调整方法：threshold=0.01/nrow(Pmap)，可以在图上添加多条显著性线；如果为列表，则每个特征可以设置不同的阈值，若为 0 或 NULL，则不添加阈值线。 threshold.col 字符串或向量，阈值线的颜色，也控制 Q-Q 图对角线的颜色。 threshold.lwd 数值或向量，阈值线的宽度，也控制 Q-Q 图对角线的粗细。 threshold.lty 数值或向量，阈值线的类型，也控制 Q-Q 图对角线的线型。 amplify 逻辑值，是否放大显著点，默认为 TRUE。若为 TRUE，则超出最小显著水平的点将被放大。 signal.cex 数值，若 amplify=TRUE，则设置显著点的大小。 signal.pch 数值，若 amplify=TRUE，则设置显著点的形状。 signal.col 字符串，若 amplify=TRUE，则设置显著点的颜色，若为 NULL，则不更改显著点的颜色。 signal.line 数值，显著 SNP 穿过圆形的线的粗细。 highlight 向量或列表，需要突出显示的 SNP 名称，单特征用向量，多特征用列表。 highlight.cex 向量或列表，需要突出显示的 SNP 点的大小。 highlight.pch 向量或列表，需要突出显示的 SNP 点的形状。 highlight.type 向量或列表，需要突出显示的 SNP 点的类型。 highlight.col 向量或列表，需要突出显示的 SNP 点的颜色。 highlight.text 向量或列表，添加到突出显示的 SNP 周围的文本。 highlight.text.col 向量或列表，添加文本的颜色。 highlight.text.cex 数值，添加文本的大小。 highlight.text.font 文本字体，应用于突出显示的 SNP。 chr.labels 向量，密度图和 Manhattan 图中染色体的标签。 chr.border 逻辑值，是否在染色体之间绘制虚线。 chr.labels.angle 数值，旋转 Manhattan 图中 x 轴刻度标签的角度（-90 < chr.labels.angle < 90）。 chr.den.col 字符串、向量或 NULL，SNP 密度的颜色。如果长度大于 1，表示在圆形上绘制的 SNP 密度条颜色；若为 NULL，则密度条不会附加到 Manhattan 图的底部。 chr.pos.max 逻辑值，染色体的物理位置是否包含染色体的最大长度。 cir.band 数值，圆形之间的间距，默认值为 1。 cir.chr 逻辑值，是否在圆形外缘绘制表示染色体的边界，默认值为 TRUE。 cir.chr.h 数值，边界的宽度，如果 cir.chr=FALSE，则此参数无效。 cir.axis 逻辑值，是否为每个圆形添加轴线。 cir.axis.col 字符串，圆形轴线的颜色。 cir.axis.grid 逻辑值，是否在圆形上添加轴网格线。 conf.int 逻辑值，是否在 Q-Q 图上绘制置信区间。 conf.int.col 字符串或向量，Q-Q 图置信区间的颜色。 file.output 逻辑值，是否输出图形结果。 file.name 字符串或向量，输出文件的名称。 file 字符串，选择不同的图形输出格式，支持 \"jpg\"、\"pdf\"、\"tiff\" 和 \"png\"。 \"png\" 格式具有透明背景。 dpi 数值，'.jpg'、'.pdf' 和 '.tiff' 文件的分辨率，默认值为 300。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_Manhattan.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"绘制曼哈顿图 — Visualizing_Manhattan","text":"具体细节，详见：https://github.com/YinLiLin/CMplot。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_Manhattan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"绘制曼哈顿图 — Visualizing_Manhattan","text":"","code":"load(system.file(\"data/pig60K.Rdata\", package=\"MRsoft\"))  Visualizing_Manhattan(pig60K,                        plot.type=\"m\",                        LOG10=TRUE,                       ylim=NULL,                        threshold=c(1e-6,1e-4),                       threshold.lty=c(1,2),                       threshold.lwd=c(1,1),                        threshold.col=c(\"black\",\"grey\"),                        amplify=TRUE,                       bin.size=1e6,                       chr.den.col=c(\"darkgreen\", \"yellow\", \"red\"),                       signal.col=c(\"red\",\"green\"),                       signal.cex=c(1.5,1.5),                       signal.pch=c(19,19),                       file=\"jpg\",                       file.name=\"\",                       dpi=300,                       file.output=TRUE,                       verbose=TRUE,                       width=14,                       height=6) #>  Rectangular Manhattan plotting trait1. #>  Rectangular Manhattan plotting trait2. #>  Rectangular Manhattan plotting trait3. #>  Plots are stored in: C:/Users/19662/Desktop/QTLMR/docs/reference"},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_MR_forest.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制MR分析森林图 — Visualizing_MR_forest","title":"绘制MR分析森林图 — Visualizing_MR_forest","text":"绘制MR分析森林图","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_MR_forest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制MR分析森林图 — Visualizing_MR_forest","text":"","code":"Visualizing_MR_forest(   res,   fdr_col = \"fdr\",   ci_col = \"#000000\",   ci_fill = \"#000000\",   ci_lwd = 1,   ci_sizes = 0.6,   xlim = c(0, 3.5),   ticks_at = c(0, 0.5, 1, 2, 3, 3.5),   space_padding = 22,   arrange_OR = FALSE,   save_plot = FALSE,   width = 8,   height = 5,   plot_pdf = \"forest_plot\",   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_MR_forest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制MR分析森林图 — Visualizing_MR_forest","text":"res mr或xQTL_mr分析结果。 fdr_col 经过多重检验矫正后的P值列名，默认\"fdr\"（没有该列，不影响绘图）。 ci_col 置信区间线的颜色，默认为\"#000000\"（黑色）。 ci_fill 置信区间填充的颜色，默认为\"#000000\"（黑色）。 ci_lwd 置信区间线的粗细，默认为1。 ci_sizes 置信区间点大小，默认为0.6。 xlim x轴的范围，默认为c(0, 3.5)。 ticks_at x轴上刻度标签的位置，默认为c(0, 0.5, 1, 2, 3, 3.5)。 space_padding 用于生成空格的值，默认为22。 arrange_OR 是否对森林图的OR值进行降序排序，默认为FALSE。 save_plot 是否保存图形为文件，默认为FALSE。 width 图形保存时的宽度，默认为8。 height 图形保存时的高度，默认为5。 plot_pdf 图形保存的文件名，默认为\"forest_plot\"。 save_path 保存图形的文件夹路径，默认为当前工作目录下的\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/Visualizing_MR_forest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制MR分析森林图 — Visualizing_MR_forest","text":"无直接返回值","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_cis_dat.html","id":null,"dir":"Reference","previous_headings":"","what":"提取原始本地xQTL数据的顺式区域数据 — xQTL_cis_dat","title":"提取原始本地xQTL数据的顺式区域数据 — xQTL_cis_dat","text":"提顺式区域数据，并转换成列名为SNP、CHR、BP、effect_allele、other_allele、eaf、beta、se、pval格式数据","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_cis_dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"提取原始本地xQTL数据的顺式区域数据 — xQTL_cis_dat","text":"","code":"xQTL_cis_dat(   GWASfile = \" \",   Ensemblid = \" \",   snp_col = \"SNP\",   beta_col = \"beta\",   se_col = \"se\",   eaf_col = \"eaf\",   effect_allele_col = \"effect_allele\",   other_allele_col = \"other_allele\",   pval_col = \"pval\",   chr_col = \"CHR\",   pos_col = \"BP\",   samplesize,   build = 38,   cis_wind_kb = 1000,   save_path = \"./\",   save_name = \" \" )"},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_cis_dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"提取原始本地xQTL数据的顺式区域数据 — xQTL_cis_dat","text":"GWASfile pQTL、eQTL或mQTL等原始数据文件路径。 Ensemblid xQTL数据基因的Ensemblid，可使用Gene_start_end_info()函数查询基因信息获取。 snp_col 必填，SNP列的名称。 beta_col 必填，Beta值列的名称。 se_col 必填，标准误列的名称。 eaf_col 必填，效应等位基因频率列的名称。 effect_allele_col 必填，效应等位基因列的名称。 other_allele_col 必填，次要等位基因列的名称。 pval_col 必填，P值列的名称。 chr_col 必填，染色体列的名称。 pos_col 必填，坐标列的名称。 samplesize 必填，数值，指定GWAS数据的总样本量。 build 37或38，人类参考基因组版本，默认38。 cis_wind_kb 指定顺式pQTL的上下游范围，默认1000kb，即1MB。 save_path 顺式xQTL数据的保存路径，默认为当前文件夹\"./\"。 save_name 保存的文件名，建议设置为基因名。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_forest.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制xQTL森林图（Forest Plot） — xQTL_forest","title":"绘制xQTL森林图（Forest Plot） — xQTL_forest","text":"绘制xQTL森林图（Forest Plot）","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_forest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制xQTL森林图（Forest Plot） — xQTL_forest","text":"","code":"xQTL_forest(   res,   pvalsig = NULL,   ci_col = \"#000000\",   ci_fill = \"#000000\",   ci_lwd = 1,   xlim = c(0, 3.5),   ticks_at = c(0, 0.5, 1, 2, 3, 3.5),   arrange_OR = TRUE,   arrange_expnm = FALSE,   save_plot = FALSE,   plot_pdf = \"forest_plot\",   width = 8,   height = 5,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_forest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制xQTL森林图（Forest Plot） — xQTL_forest","text":"res mr或xQTL_mr分析结果。 pvalsig 用于筛选显著结果的参数，默认值为NULL，若为\"pval\"或\"fdr\"则按照对应的p值或FDR值<0.05筛选。 ci_col 置信区间线的颜色，默认为\"#000000\"（黑色）。 ci_fill 置信区间填充的颜色，默认为\"#000000\"（黑色）。 ci_lwd 置信区间线的粗细，默认为1。 xlim x轴的范围，默认为c(0, 3.5)。 ticks_at x轴上刻度标签的位置，默认为c(0, 0.5, 1, 2, 3, 3.5)。 arrange_OR 是否对森林图的OR值进行降序排序，默认为TRUE。 arrange_expnm 是否对森林图的基因名称安装首字母进行排序，默认为FALSE（若需执行，设置arrange_OR = FALSE，arrange_expnm =TRUE）。 save_plot 是否保存图形为文件，默认为FALSE。 plot_pdf 图形保存的文件名，默认为\"forest_plot\"。 width 图形保存时的宽度，默认为8。 height 图形保存时的高度，默认为5。 save_path 保存图形的文件夹路径，默认为当前工作目录下的\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_forest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制xQTL森林图（Forest Plot） — xQTL_forest","text":"无直接返回值，但会生成并（如果save_plot为TRUE）保存一个森林图","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_mr.html","id":null,"dir":"Reference","previous_headings":"","what":"xQTL数据进行MR分析 — xQTL_mr","title":"xQTL数据进行MR分析 — xQTL_mr","text":"此函数只使用\"mr_wald_ratio\"或\"mr_ivw\"分析。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_mr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"xQTL数据进行MR分析 — xQTL_mr","text":"","code":"xQTL_mr(dat, FDR_method = \"fdr\", PVE = TRUE)"},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_mr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"xQTL数据进行MR分析 — xQTL_mr","text":"dat harmonise_data后的dat数据。 FDR_method FDR矫正方法，默认\"fdr\",其它方法详见p.adjust函数的method参数，若填NULL则不进行FDR矫正。 PVE TRUE或FALSE，是否计算遗传解释度，默认为TRUE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_mr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"xQTL数据进行MR分析 — xQTL_mr","text":"data","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_volcano_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"绘制xQTL孟德尔随机化结果火山图 — xQTL_volcano_plot","title":"绘制xQTL孟德尔随机化结果火山图 — xQTL_volcano_plot","text":"此函数只需要xQTL_mr计算PVE。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_volcano_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"绘制xQTL孟德尔随机化结果火山图 — xQTL_volcano_plot","text":"","code":"xQTL_volcano_plot(   dat,   breaks = c(0.1, 0.2, 0.3, 0.4, 0.5),   scale_color = c(\"green\", \"grey\", \"red\"),   FDR_method = \"fdr\",   save_plot = TRUE,   pdf_name = \"volcano_plot\",   width = 6,   height = 5,   save_path = \"./\" )"},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_volcano_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"绘制xQTL孟德尔随机化结果火山图 — xQTL_volcano_plot","text":"dat xQTL分析后的结果数据。 breaks PVE刻度大小。 scale_color 火山图气泡颜色设置，默认c(\"green\", \"grey\",\"red\")。 FDR_method FDR矫正方法，默认\"fdr\",其它方法详见p.adjust函数的method参数。 save_plot TRUE或FALSE，是否保存火山图，默认为TRUE。 pdf_name 保存的pdf图形文件名，默认plot。 width 图形宽度。 height 图形高度。 save_path 图形文件保存路径，默认\"./\"。","code":""},{"path":"https://hortoner.github.io/QTLMR/reference/xQTL_volcano_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"绘制xQTL孟德尔随机化结果火山图 — xQTL_volcano_plot","text":"fdr矫正结果","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v22","dir":"Changelog","previous_headings":"","what":"QTLMR v2.2","title":"QTLMR v2.2","text":"(更新日期: 2025-2-22) MiXeR_run一键式进行MiXeR分析； FM_summary()简化的贝叶斯精细映射方法（FM-summary）； GCTA_fastBAT()基于GCTA_fastBAT的gene-based关联分析研究； GNOVA_run()使用GNOVA进行遗传协方差分析； LCV_run()进行潜在因果变量分析； PWCOCO_Coloc_dat()PWCOCO与Coloc分析基因组区域数据提取； PWCOCO_run()使用PWCOCO进行成对条件与共定位分析； TWAS_FOCUS_Multi_test()循环多种组织FOCUS精细定位分析； HDL_L()使用HDL方法进行局部遗传相关性分析。 CPASSOC_meta_gwas() 根据PMID: 28980259文献，完善对SNP进行成对LD修剪，默认过滤Z-scores绝对值大于1.96的SNP。 3.剔除FUSION函数绘制曼哈顿图参数。 4.修复FUCOS创建Python环境并更正TWAS_FOCUS_test()函数的ref_ld及locations参数。 5.其它函数优化修复。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v21","dir":"Changelog","previous_headings":"","what":"QTLMR v2.1","title":"QTLMR v2.1","text":"(更新日期: 2024-12-15) LAVA_sample_overlap()创建 LAVA 分析输入的sample overlap文件； LAVA_run()使用 LAVA 包对所有基因组位点执行双变量遗传相关性分析； LAVA_bivarplot()绘制双变量LAVA分析结果的散点图。 SUPERGNOVA_py_install() 配置SUPERGNOVA软件环境； SUPERGNOVA_format_data() 格式转换成SUPERGNOVA分析输入格式数据； SUPERGNOVA_run() 使用 SUPERGNOVA 进行局部遗传相关性分析。 Baidu_py_install() 配置百度网盘python环境； Baidu_download() 使用百度网盘下载文件。 4.数据格式转换与清洗函数优化修复。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v19","dir":"Changelog","previous_headings":"","what":"QTLMR v1.9","title":"QTLMR v1.9","text":"(更新日期: 2024-11-08) MiXeR_install() 配置MiXeR软件环境； MiXeR_format_dat() MiXeR分析输入数据格式转换； MiXeR_Univariate() MiXeR单变量分析； MiXeR_Univariate_visualize() MiXeR单变量分析可视化； MiXeR_Bivariate() MiXeR双变量跨性状分析； MiXeR_Bivariate_visualize() MiXeR双变量跨性状分析可视化。 cond_conjFDR() cond/conjFDR分析。 HDL_h2() 使用HDL包基于SNP的遗传力的高精度似然推断; HDL_rg() 使用HDL进行高精度似然推断遗传相关性分析; HDL_rg_parallel() 使用HDL包多核进行遗传相关性的高精度似然推断。 4.增加芬兰R12数据转换功能； 5.其它函数优化修复。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v18","dir":"Changelog","previous_headings":"","what":"QTLMR v1.8","title":"QTLMR v1.8","text":"(更新日期: 2024-10-2) 支持Linux服务器使用QTLMR包","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v17","dir":"Changelog","previous_headings":"","what":"QTLMR v1.7","title":"QTLMR v1.7","text":"(更新日期: 2024-09-17) GSMR2_QTLMR() 基于广义汇总数据的孟德尔随机化分析；详见：https://www.nature.com/articles/s43856-024-00473-3、https://yanglab.westlake.edu.cn/software/gsmr/与https://github.com/jianyanglab/gsmr2。 首先利用JTI_predixcan_test()或JTI_SPrediXcan_test()函数进行TWAS分析，获得阳性结果的基因。再利于MR_JTI_Beta()函数计算beta值及95% CI。软件官网：https://github.com/gamazonlab/MR-JTI?tab=readme-ov-file。参考数据下载地址：https://zenodo.org/records/3842289。 Visualizing_MR_forest()实现一键式绘制孟德尔随机化结果森林图，输入数据框格式为mr()或GSMR2_QTLMR()输出结果格式，其他数据绘制森林图可根据该格式修改； Visualizing_Manhattan()绘制曼哈顿图，为CMplot包的汉化版，详细教程可参考帮助文档或官网：https://github.com/YinLiLin/CMplot/tree/master。 clump_LD_R2()获取连锁的SNP； data_info_cytoBand()获取cytoBand汇总信息数据。 HESS_estimate_correlation()官方hess软件无全局遗传相关性p值计算；本版本对hess软件底层代码进行优化，增加全局遗传相关性p值计算。 6.其它函数优化修复。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v16","dir":"Changelog","previous_headings":"","what":"QTLMR v1.6","title":"QTLMR v1.6","text":"(更新日期: 2024-08-25) LDSC_py_ph() 使用ldsc软件进行分区遗传力计算； LDSC_py_SEG()使用ldsc软件进行组织或细胞类型特异性分析。 HESS_install() 配置HESS软件环境； HESS_format_data()将TwosampleMR格式转换成HESS分析输入格式数据； HESS_estimate_heritability()使用HESS软件计算局部SNP遗传力及标准误差； HESS_estimate_correlation()使用HESS软件计算性状遗传协方差和相关性(ρ-HESS)； HESS_estimate_lambdagc() 使用HESS软件计算基因组控制因子； HESS_estimate_phenocor() 使用HESS软件计算性状表型的相关性； HESS_Visualizing_estimates() 使用HESS软件绘制SNP遗传度或协方差的曼哈顿图； HESS_Contrast_polygenicity() 使用HESS软件绘制性状之间多基因性对比度的图； HESS_putative_causality() 使用HESS软件推断性状特征之间因果关系并绘图。 MTAG_install() 配置MTAG软件环境； MTAG_cross_gwas() 使用MTAG进行跨性状表型meta分析； META_CPASSOC_cross_gwas() 使用cpassoc跨性状关联分析。 PLACO_analysis() 使用PLACO进行复合零假设下的多效性分析。 5.其它函数优化修复。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v15","dir":"Changelog","previous_headings":"","what":"QTLMR v1.5","title":"QTLMR v1.5","text":"(更新日期: 2024-07-27) available_outcomes_ieu() IEU Open GWAS数据库表型汇总表； data_info_GTEx_V8_GENE()GTEx_V8基因信息汇总数据； Gene_start_end_info_modified()从内置数据中直接获取不同版本Ensembl id与Gene汇总信息数据； coloc_GWAS()对共定位函数进行优化，可自由选择是否locuscomparer作图，返回结果进行优化处理，方便直接保存使用； coloc_stack_assoc_plot()优化绘图时，可选择性只显示最显著的topSNP； format_dat()数据格式转换与清洗，功能类似TwoSampleMR::format_data()函数，可自动保存标准TwosampleMR、SMR、METAL文件。 具体可查看网站：https://qtlmr.pages.dev/articles/。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v14","dir":"Changelog","previous_headings":"","what":"QTLMR v1.4","title":"QTLMR v1.4","text":"(更新日期: 2024-07-20) 1.1 增加”MAGMA软件分析”功能： MAGMA_gene_based()函数进行gene-based & gene-set-based关联分析； MAGMA_Tissue_specific()进行交叉组织特异性分析； MAGMA_genes_Manhattanplot()对MAGMA软件gene_based分析结果的基因注释及曼哈顿图绘制； MAGMA_gsa_barplot()用于组织特异性和途径富集分析结果图形可视化。 （详细请见 “./QTLMR test/版本升级文件/1.4版本” 文件夹下的示例代码） 1.2 完善”使用UTMOST软件进行跨组织联合TWAS分析”功能： TWAS_UTMOST_cross_tissue_test()函数可将TWAS_UTMOST_single_tissue_test()结果进行跨组织联合分析，依赖的数据下载地址：https://zhaocenter.org/UTMOST。 1.3 增加”数据转换与清洗”功能： format_dat()函数可将读入至R环境变量中的数据转换成标准TwosampleMR、SMR、METAL文件。 1.4 增加”提取原始本地xQTL数据的顺式区域数据”功能： xQTL_cis_dat()函数可将原始的xQTL数据，根据基因编码的起始与终止位置的上下游区域范围内的SNP提取出来，以便进一步使用coloc_GWAS()进行后续的共定位分析，或使用SMR_format_BESD()函数转换成SMR分析所需的BESD二进制数据文件进行SMR分析，完善非R包内置xQTL数据的清洗与转换功能。 1.5 增加”韦恩图绘制”功能： venn_plot()函数绘制韦恩图，示例数据（详细请见 “./QTLMR test/版本升级文件/1.4版本” venn文件夹）。 2.优化R包帮助页面。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v13","dir":"Changelog","previous_headings":"","what":"QTLMR v1.3","title":"QTLMR v1.3","text":"(更新日期: 2024-06-29) 增加”获取传统药靶基因工具变量”功能； get_Drugs_gene_IVs()函数可从基因靶向的Twosample格式完整GWAS数据文件中提取指定靶基因的工具变量；或指定IEU Open GWAS数据库的id号提取数据，以此为暴露数据进行药靶MR分析。（详细请见 “./QTLMR test/版本升级文件/1.3版本” 文件夹下的示例代码） data_info_finngen()函数同步更新汇总信息数据至R11，format_data_FinnGen()同时支持R11数据清洗。","code":""},{"path":"https://hortoner.github.io/QTLMR/news/index.html","id":"qtlmr-v12","dir":"Changelog","previous_headings":"","what":"QTLMR v1.2","title":"QTLMR v1.2","text":"(更新日期: 2024-06-14) 1.1 TWAS_FOCUS_install()函数配置FOCUS环境需要科学上网，网络不稳定，容易配置失败；建议本地安装，将“./QTLMR test/版本升级文件/1.2版本/FOCUS环境配置/FOCUS.zip”中的FOCUS.zip文件，直接解压到miniconda3安装路径的 “./miniconda3/envs” 文件下； 1.2 TWAS_FOCUS_format_data()函数将GWAS数据转换成FOCUS输入文件； 1.3 TWAS_FOCUS_import() 因FOCUS不能直接使用FUSION的权重数据文件，需要根据FUSION的权重数据文件转换成FOCUS软件识别的.db格式权重数据，此步耗时比较长； 1.4 TWAS_FOCUS_test() 进行TWAS的基因-性状关联信号精细定位分析，ref_ld_dir的输入参数为./QTLMR test/inputdata/LDREF.zip中DREF.zip文件解压后的文件夹路径。此步耗时较长； 详细请见 “./QTLMR test/版本升级文件/1.2版本” 文件夹下的示例代码。 TWAS_fusion_assoc_test() TWAS_fusion_conditonal_test() TWAS_fusion_Multi_test() TWAS_UTMOST_single_tissue_test() LDSC_py_rg() LDSC_py_h2() 分别增加了test_help、opt_arguments参数，类似test_help的参数能查看原始相应软件函数的帮助文档，opt_arguments可添加传递原始软件中R语言函数没有的参数，以便能够完全使用该软件的所有参数功能； format_data_Catalog()重新构建函数参数，将GWAS Catalog数据库.gz或.tsv文件转换为标准TwosampleMR、SMR、METAL文件。","code":""}]
